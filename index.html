<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="robots" content="noindex, nofollow">
<title>Mission Control — Dopamine Digital</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap');
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
:root{
  --bg:#fff;--bg-warm:#faf9f7;--bg-sidebar:#f5f4f1;--bg-card:#fff;--bg-hover:#f0efec;
  --border:#e8e6e1;--border-light:#f0eeeb;
  --accent:#e05d2a;--accent-light:#fff3ed;--accent-dim:rgba(224,93,42,0.08);
  --green:#2d9f4e;--green-light:#ecf8ef;
  --blue:#3b7dd8;--blue-light:#edf3fc;
  --purple:#7c5cbf;--purple-light:#f3effb;
  --amber:#c78b1a;--amber-light:#fef7e8;
  --red:#d14343;--red-light:#fdeaea;
  --gray:#8c8a85;--gray-light:#f0efec;
  --text:#1a1a1a;--text-secondary:#5c5b57;--text-muted:#9b9990;
  --radius:8px;--radius-sm:6px;
  --shadow-sm:0 1px 3px rgba(0,0,0,0.04);--shadow:0 2px 8px rgba(0,0,0,0.06);--shadow-lg:0 8px 32px rgba(0,0,0,0.12);
}
html{font-size:13.5px}
body{font-family:'Inter',-apple-system,sans-serif;background:var(--bg-warm);color:var(--text);height:100vh;overflow:hidden;display:flex;flex-direction:column}
/* AUTH GATE */
.auth-gate{position:fixed;inset:0;z-index:9999;background:var(--bg-warm);display:flex;align-items:center;justify-content:center}
.auth-box{text-align:center;max-width:320px;width:90%}
.auth-logo{font-size:1.5rem;font-weight:800;color:var(--accent);margin-bottom:.5rem;letter-spacing:-.02em}
.auth-sub{font-size:.55rem;color:var(--text-muted);margin-bottom:1.5rem}
.auth-input{width:100%;padding:.55rem .7rem;font-size:.65rem;font-family:'Inter',sans-serif;border:1px solid var(--border);border-radius:8px;background:var(--bg);outline:none;text-align:center;letter-spacing:.05em;transition:border-color .2s}
.auth-input:focus{border-color:var(--accent)}
.auth-input.error{border-color:var(--red);animation:authShake .4s ease}
.auth-btn{width:100%;margin-top:.5rem;padding:.5rem;font-size:.55rem;font-weight:700;font-family:'Inter',sans-serif;background:var(--accent);color:#fff;border:none;border-radius:8px;cursor:pointer;transition:opacity .2s}
.auth-btn:hover{opacity:.9}
.auth-err{font-size:.45rem;color:var(--red);margin-top:.4rem;min-height:1rem}
.auth-remember{display:flex;align-items:center;justify-content:center;gap:.3rem;margin-top:.6rem;font-size:.42rem;color:var(--text-muted);cursor:pointer}
.auth-remember input{accent-color:var(--accent)}
@keyframes authShake{0%,100%{transform:translateX(0)}25%{transform:translateX(-6px)}75%{transform:translateX(6px)}}

/* HEADER */
.header{display:flex;align-items:center;justify-content:space-between;padding:0 1.5rem;height:50px;min-height:50px;background:var(--bg);border-bottom:1px solid var(--border)}
.header-left{display:flex;align-items:center;gap:.75rem}
.header-dot{width:10px;height:10px;border-radius:50%;background:var(--accent)}
.header-title{font-weight:700;font-size:1rem;letter-spacing:-.02em}
.header-badge{font-size:.72rem;font-weight:500;color:var(--text-secondary);background:var(--bg-sidebar);padding:3px 10px;border-radius:20px;border:1px solid var(--border)}
.header-right{display:flex;align-items:center;gap:1rem}
.clock{font-family:'JetBrains Mono',monospace;font-size:1rem;font-weight:600}
.clock-date{font-size:.58rem;font-weight:500;color:var(--text-muted);text-transform:uppercase;letter-spacing:.04em}
.online-badge{display:flex;align-items:center;gap:5px;font-size:.68rem;font-weight:600;color:var(--green);background:var(--green-light);padding:3px 10px;border-radius:20px}
.online-dot{width:6px;height:6px;border-radius:50%;background:var(--green);animation:pulse 2.5s ease-in-out infinite}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.4}}
.sc-wrap{display:flex;align-items:center;gap:8px;cursor:pointer;user-select:none}
.sc-label{font-size:.6rem;font-weight:600;color:var(--text-muted);letter-spacing:.03em;transition:color .2s}
.sc-wrap.active .sc-label{color:var(--accent)}
.sc-track{position:relative;width:34px;height:18px;border-radius:10px;background:var(--border);transition:background .25s;flex-shrink:0}
.sc-track::after{content:'';position:absolute;top:2px;left:2px;width:14px;height:14px;border-radius:50%;background:#fff;box-shadow:0 1px 3px rgba(0,0,0,.2);transition:transform .25s}
.sc-wrap.active .sc-track{background:var(--accent)}
.sc-wrap.active .sc-track::after{transform:translateX(16px)}

/* TAB BAR */
.tab-bar{display:flex;gap:0;border-bottom:1px solid var(--border);background:var(--bg);padding:0 1.5rem}
.tab-btn{padding:.55rem 1.1rem;font-size:.76rem;font-weight:500;color:var(--text-muted);border:none;background:none;cursor:pointer;border-bottom:2px solid transparent;transition:all .15s;font-family:inherit;display:flex;align-items:center;gap:.4rem}
.tab-btn.active{color:var(--accent);border-bottom-color:var(--accent);font-weight:600}
.tab-btn:hover:not(.active){color:var(--text-secondary)}
.tab-content{display:none;flex:1;overflow:hidden}
.tab-content.active{display:flex}

/* TAB 1: MISSION CONTROL LAYOUT */
.mc-layout{display:flex;flex:1;overflow:hidden;width:100%}
.sidebar-left{width:250px;min-width:250px;background:var(--bg);border-right:1px solid var(--border);display:flex;flex-direction:column;overflow:hidden}
.sidebar-header{display:flex;align-items:center;justify-content:space-between;padding:.85rem 1rem .5rem}
.sidebar-title{font-size:.68rem;font-weight:600;text-transform:uppercase;letter-spacing:.08em;color:var(--text-muted)}
.sidebar-count{font-size:.72rem;font-weight:600;color:var(--text-secondary)}
.agent-list{flex:1;overflow-y:auto;padding:0 .5rem;scrollbar-width:thin;scrollbar-color:var(--border) transparent}
.agent-list::-webkit-scrollbar{width:4px}.agent-list::-webkit-scrollbar-thumb{background:var(--border);border-radius:2px}
.agent-item{display:flex;align-items:center;gap:.55rem;padding:.4rem .5rem;border-radius:var(--radius-sm);cursor:pointer;transition:background .15s;margin-bottom:1px}
.agent-item:hover{background:var(--bg-hover)}
.agent-avatar{width:28px;height:28px;border-radius:6px;display:flex;align-items:center;justify-content:center;font-size:.8rem;flex-shrink:0}
.agent-info{flex:1;min-width:0}
.agent-name-row{display:flex;align-items:center;gap:.3rem}
.agent-name{font-size:.78rem;font-weight:600;white-space:nowrap}
.agent-type-badge{font-size:.48rem;font-weight:700;padding:1px 4px;border-radius:3px;letter-spacing:.04em;flex-shrink:0;cursor:help;position:relative}
.agent-type-badge.lead{background:var(--accent);color:#fff}
.agent-type-badge.spc{background:var(--green);color:#fff}
.agent-type-badge.int{background:var(--blue);color:#fff}
.agent-type-badge::after{content:attr(data-tip);position:absolute;bottom:120%;left:50%;transform:translateX(-50%);background:var(--text);color:#fff;font-size:.6rem;font-weight:500;padding:3px 7px;border-radius:4px;white-space:nowrap;pointer-events:none;opacity:0;transition:opacity .15s;z-index:100}
.agent-type-badge:hover::after{opacity:1}
.agent-role{font-size:.66rem;color:var(--text-muted);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.agent-status{display:flex;align-items:center;gap:4px;flex-shrink:0;font-size:.58rem;font-weight:500}
.agent-status-dot{width:6px;height:6px;border-radius:50%}
.agent-status.live .agent-status-dot{background:var(--green)}.agent-status.live{color:var(--green)}
.agent-status.ready .agent-status-dot{background:var(--blue)}.agent-status.ready{color:var(--blue)}

/* BUILD PROGRESS */
.build-section{border-top:1px solid var(--border);padding:.65rem}
.build-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:.5rem}
.build-title{font-size:.62rem;font-weight:600;text-transform:uppercase;letter-spacing:.08em;color:var(--text-muted)}
.build-count{font-family:'JetBrains Mono',monospace;font-size:.68rem;font-weight:600;color:var(--accent)}
.build-bar-track{width:100%;height:5px;background:var(--bg-hover);border-radius:3px;overflow:hidden;margin-bottom:.5rem}
.build-bar-fill{height:100%;border-radius:3px;transition:width 1s cubic-bezier(.22,1,.36,1)}
.build-legend{display:flex;gap:.6rem;flex-wrap:wrap}
.build-legend-item{display:flex;align-items:center;gap:4px;font-size:.62rem;color:var(--text-secondary)}
.build-legend-dot{width:5px;height:5px;border-radius:50%}
.build-agents-grid{display:grid;grid-template-columns:1fr 1fr;gap:2px;margin-top:.4rem}
.build-agent-pill{display:flex;align-items:center;gap:3px;padding:2px 5px;border-radius:4px;font-size:.6rem;font-weight:500;cursor:pointer;transition:background .15s}
.build-agent-pill:hover{background:var(--bg-hover)}
.build-agent-pill .pill-dot{width:5px;height:5px;border-radius:50%;flex-shrink:0}
.build-agent-pill.live .pill-dot{background:var(--green)}.build-agent-pill.live{color:var(--green)}
.build-agent-pill.built .pill-dot{background:var(--blue)}.build-agent-pill.built{color:var(--blue)}

/* KANBAN */
.kanban-area{flex:1;display:flex;flex-direction:column;overflow:hidden;background:var(--bg-warm)}
.kanban-header{display:flex;align-items:center;gap:.5rem;padding:.7rem 1rem}
.kanban-dot{width:8px;height:8px;border-radius:50%;background:var(--accent)}
.kanban-title{font-size:.72rem;font-weight:600;text-transform:uppercase;letter-spacing:.06em;color:var(--text-secondary)}
.kanban-board{flex:1;display:flex;gap:0;overflow-x:auto;overflow-y:hidden;padding:0 .6rem .6rem}
.kanban-column{flex:1;min-width:175px;display:flex;flex-direction:column;overflow:hidden;margin:0 3px;border-radius:var(--radius);padding:0 0 .4rem}
.kanban-column[data-col="inbox"]{background:linear-gradient(180deg,#f7f6f3 0%,#efeee9 100%);box-shadow:inset 0 2px 4px rgba(0,0,0,.04),inset 0 -1px 0 rgba(255,255,255,.6)}
.kanban-column[data-col="assigned"]{background:linear-gradient(180deg,#edf3fc 0%,#e2ecf8 100%);box-shadow:inset 0 2px 4px rgba(59,125,216,.06),inset 0 -1px 0 rgba(255,255,255,.6)}
.kanban-column[data-col="in-progress"]{background:linear-gradient(180deg,#fff3ed 0%,#ffe8d9 100%);box-shadow:inset 0 2px 4px rgba(224,93,42,.06),inset 0 -1px 0 rgba(255,255,255,.6)}
.kanban-column[data-col="review"]{background:linear-gradient(180deg,#f3effb 0%,#ebe4f7 100%);box-shadow:inset 0 2px 4px rgba(124,92,191,.06),inset 0 -1px 0 rgba(255,255,255,.6)}
.kanban-column[data-col="done"]{background:linear-gradient(180deg,#ecf8ef 0%,#e0f2e4 100%);box-shadow:inset 0 2px 4px rgba(45,159,78,.06),inset 0 -1px 0 rgba(255,255,255,.6)}
.kanban-col-header{display:flex;align-items:center;justify-content:space-between;padding:.45rem .5rem;flex-shrink:0}
.kanban-col-title{display:flex;align-items:center;gap:.4rem;font-size:.7rem;font-weight:600;text-transform:uppercase;letter-spacing:.04em;color:var(--text-secondary)}
.kanban-col-dot{width:7px;height:7px;border-radius:50%}
.kanban-col-count{font-size:.7rem;font-weight:500;color:var(--text-muted)}
.kanban-col-cards{flex:1;overflow-y:auto;padding:0 .35rem .4rem;display:flex;flex-direction:column;gap:5px;scrollbar-width:thin;scrollbar-color:var(--border) transparent}
.kanban-card{background:var(--bg-card);border:1px solid var(--border-light);border-radius:var(--radius);padding:.75rem .8rem;transition:all .15s;cursor:pointer;box-shadow:0 1px 3px rgba(0,0,0,.06),0 1px 2px rgba(0,0,0,.04);min-height:150px}
.kanban-card:hover{border-color:var(--border);box-shadow:0 4px 12px rgba(0,0,0,.1);transform:translateY(-1px)}
.kanban-card-title{font-size:.8rem;font-weight:600;line-height:1.3;margin-bottom:.3rem}
.kanban-card-desc{font-size:.68rem;color:var(--text-muted);line-height:1.45;margin-bottom:.4rem}
.kanban-card-insight{font-size:.64rem;color:var(--text-secondary);line-height:1.45;margin-bottom:.4rem;padding:.4rem .5rem;background:var(--bg-warm);border-radius:5px;border-left:2px solid var(--border)}
.kanban-card-footer{display:flex;align-items:center;justify-content:space-between}
.kanban-card-agent{display:flex;align-items:center;gap:4px}
.kanban-card-avatar{width:15px;height:15px;border-radius:3px;display:flex;align-items:center;justify-content:center;font-size:.45rem}
.kanban-card-agent-name{font-size:.66rem;font-weight:500;color:var(--text-secondary)}
.kanban-card-time{font-size:.6rem;color:var(--text-muted)}
.kanban-card-tags{display:flex;gap:3px;margin-bottom:.3rem;flex-wrap:wrap}
.kanban-tag{font-size:.56rem;font-weight:500;padding:1px 5px;border-radius:3px}

/* RIGHT SIDEBAR */
.sidebar-right{width:280px;min-width:280px;background:var(--bg);border-left:1px solid var(--border);display:flex;flex-direction:column;overflow:hidden}
.feed-header{padding:.7rem .85rem 0}
.feed-title{font-size:.68rem;font-weight:600;text-transform:uppercase;letter-spacing:.08em;color:var(--text-muted);margin-bottom:.5rem}
.feed-tabs{display:flex;gap:3px;margin-bottom:.4rem}
.feed-tab{font-size:.7rem;font-weight:500;padding:3px 10px;border-radius:20px;cursor:pointer;transition:all .15s;border:none;background:transparent;color:var(--text-muted);font-family:inherit}
.feed-tab.active{background:var(--accent);color:#fff}
.feed-tab:not(.active):hover{background:var(--bg-hover);color:var(--text-secondary)}
.feed-agent-chips{display:flex;gap:3px;padding:0 .85rem .5rem;flex-wrap:wrap;border-bottom:1px solid var(--border)}
.agent-chip{display:flex;align-items:center;gap:3px;font-size:.6rem;font-weight:500;padding:2px 7px;border-radius:4px;cursor:pointer;border:1px solid var(--border);background:var(--bg);color:var(--text-secondary);transition:all .15s;font-family:inherit}
.agent-chip.active{background:var(--accent-light);border-color:var(--accent);color:var(--accent)}
.agent-chip:hover:not(.active){background:var(--bg-hover)}
.agent-chip-dot{width:4px;height:4px;border-radius:50%}
.activity-list{flex:1;overflow-y:auto;padding:.4rem .65rem;display:flex;flex-direction:column;scrollbar-width:thin;scrollbar-color:var(--border) transparent}
.activity-entry{padding:.5rem .4rem;border-bottom:1px solid var(--border-light);transition:background .15s;cursor:pointer}
.activity-entry:hover{background:var(--bg-hover);border-radius:var(--radius-sm)}
.activity-entry:last-child{border-bottom:none}
.activity-entry-main{display:flex;align-items:flex-start;gap:.4rem}
.activity-dot{width:6px;height:6px;border-radius:50%;margin-top:4px;flex-shrink:0}
.activity-content{flex:1;min-width:0}
.activity-text{font-size:.74rem;line-height:1.4}
.activity-agent{font-weight:600}
.activity-task-name{color:var(--text-secondary)}
.activity-meta{display:flex;align-items:center;justify-content:space-between;margin-top:2px}
.activity-time{font-size:.6rem;color:var(--text-muted)}
.activity-link{font-size:.6rem;font-weight:500;color:var(--accent);cursor:pointer;text-decoration:none}
.activity-link:hover{text-decoration:underline}
.health-section{border-top:1px solid var(--border);padding:.55rem .65rem}
.health-title{font-size:.6rem;font-weight:600;text-transform:uppercase;letter-spacing:.08em;color:var(--text-muted);margin-bottom:.35rem}
.health-grid{display:grid;grid-template-columns:1fr 1fr;gap:2px}
.health-item{display:flex;align-items:center;gap:4px;padding:2px 4px;border-radius:4px;font-size:.66rem;color:var(--text-secondary);cursor:pointer;transition:background .15s}
.health-item:hover{background:var(--bg-hover)}
.health-dot{width:5px;height:5px;border-radius:50%}
.health-dot.ok{background:var(--green)}.health-dot.warn{background:var(--amber)}

/* MODAL */
.modal-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.3);z-index:1000;justify-content:center;align-items:center;backdrop-filter:blur(2px)}
.modal-overlay.active{display:flex}
.modal{background:var(--bg);border-radius:12px;box-shadow:var(--shadow-lg);width:520px;max-width:90vw;max-height:80vh;overflow:hidden;animation:modal-in .2s ease-out}
@keyframes modal-in{from{opacity:0;transform:scale(.96) translateY(8px)}to{opacity:1;transform:scale(1) translateY(0)}}
.modal-header{display:flex;align-items:center;justify-content:space-between;padding:.85rem 1.1rem;border-bottom:1px solid var(--border)}
.modal-title{font-size:.92rem;font-weight:700}
.modal-close{width:26px;height:26px;border-radius:6px;border:none;background:var(--bg-hover);color:var(--text-muted);font-size:1rem;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .15s}
.modal-close:hover{background:var(--border);color:var(--text)}
.modal-body{padding:1.1rem;overflow-y:auto;max-height:60vh}
.modal-row{display:flex;align-items:flex-start;gap:.5rem;padding:.45rem 0;border-bottom:1px solid var(--border-light)}
.modal-row:last-child{border-bottom:none}
.modal-label{font-size:.7rem;font-weight:600;color:var(--text-muted);min-width:85px;text-transform:uppercase;letter-spacing:.04em}
.modal-value{font-size:.78rem;color:var(--text);line-height:1.5}
.modal-badge{font-size:.63rem;font-weight:600;padding:2px 8px;border-radius:4px}
.modal-badge.live{background:var(--green-light);color:var(--green)}
.modal-badge.built{background:var(--blue-light);color:var(--blue)}
.modal-file{font-family:'JetBrains Mono',monospace;font-size:.68rem;background:var(--bg-warm);padding:5px 9px;border-radius:4px;color:var(--text-secondary);word-break:break-all}

/* TABS 2-4: SCROLLABLE CONTENT */
.tab-scroll{flex:1;overflow-y:auto;padding:1.1rem 1.5rem;width:100%}
.section-heading{font-size:.68rem;font-weight:600;text-transform:uppercase;letter-spacing:.08em;color:var(--text-muted);margin:1.25rem 0 .65rem;display:flex;align-items:center;gap:.5rem}
.section-heading:first-child{margin-top:0}
.section-dot{width:7px;height:7px;border-radius:50%}
.metric-cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(155px,1fr));gap:.65rem;margin-bottom:1rem}
.metric-card{background:var(--bg);border:1px solid var(--border);border-radius:var(--radius);padding:.85rem;box-shadow:var(--shadow-sm)}
.metric-value{font-size:1.4rem;font-weight:700;font-family:'JetBrains Mono',monospace;line-height:1}
.metric-label{font-size:.64rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:.04em;margin-top:3px}
.metric-sub{font-size:.62rem;color:var(--text-secondary);margin-top:2px}

/* CLIENT CARDS (flat, no toggle) */
.client-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(380px,1fr));gap:.75rem}
.client-card{background:var(--bg);border:1px solid var(--border);border-radius:var(--radius);padding:.85rem;box-shadow:var(--shadow-sm);display:flex;flex-direction:column;gap:.55rem}
.client-card:hover{box-shadow:var(--shadow)}
.client-card-top{display:flex;align-items:center;gap:.6rem}
.client-avatar{width:36px;height:36px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:.75rem;font-weight:700;color:#fff;flex-shrink:0}
.client-meta{flex:1;min-width:0}
.client-meta h3{font-size:.85rem;font-weight:600;margin-bottom:1px}
.client-meta-links{display:flex;gap:.5rem;flex-wrap:wrap}
.client-meta-link{font-size:.6rem;color:var(--accent);text-decoration:none;font-weight:500}
.client-meta-link:hover{text-decoration:underline}
.client-contract{text-align:right;flex-shrink:0}
.client-days{font-size:1.1rem;font-weight:700;font-family:'JetBrains Mono',monospace;line-height:1}
.client-days-label{font-size:.54rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:.03em}
.client-kpis{display:grid;grid-template-columns:1fr 1fr 1fr;gap:.4rem}
.client-kpi{text-align:center;padding:.35rem;background:var(--bg-warm);border-radius:var(--radius-sm)}
.client-kpi-val{font-size:.95rem;font-weight:700;font-family:'JetBrains Mono',monospace;line-height:1.2}
.client-kpi-label{font-size:.55rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:.03em}
.client-kpi-bar{height:3px;background:var(--bg-hover);border-radius:2px;margin-top:3px;overflow:hidden}
.client-kpi-bar-fill{height:100%;border-radius:2px}
.client-campaigns{display:grid;grid-template-columns:1fr 1fr;gap:.35rem}
.client-camp{padding:.35rem .45rem;background:var(--bg-warm);border-radius:var(--radius-sm);font-size:.66rem}
.client-camp-name{font-weight:600;color:var(--text-secondary);margin-bottom:2px;display:flex;align-items:center;justify-content:space-between}
.client-camp-stats{display:flex;gap:.5rem;color:var(--text-muted)}
.client-camp-stat{display:flex;align-items:center;gap:2px}
.client-alerts-row{display:flex;flex-wrap:wrap;gap:.25rem}
.client-alert-chip{font-size:.58rem;font-weight:500;padding:2px 7px;border-radius:10px;background:var(--amber-light);color:var(--amber)}

/* CAMPAIGN TABLES */
.camp-table{width:100%;border-collapse:collapse;font-size:.7rem;margin-top:.5rem}
.camp-table th{text-align:left;padding:.4rem .5rem;font-weight:600;color:var(--text-muted);text-transform:uppercase;letter-spacing:.04em;font-size:.58rem;border-bottom:1px solid var(--border)}
.camp-table td{padding:.4rem .5rem;border-bottom:1px solid var(--border-light)}
.camp-table tr:hover td{background:var(--bg-hover)}
.status-badge{font-size:.56rem;font-weight:600;padding:1px 7px;border-radius:10px;white-space:nowrap}
.status-badge.healthy{background:var(--green-light);color:var(--green)}
.status-badge.watch{background:var(--amber-light);color:var(--amber)}
.status-badge.warning{background:var(--red-light);color:var(--red)}
.status-badge.low{background:var(--gray-light);color:var(--gray)}

/* DD PIPELINE */
.pipeline-stages{display:flex;gap:.5rem;margin-bottom:1rem}
.pipeline-stage{flex:1;background:var(--bg);border:1px solid var(--border);border-radius:var(--radius);padding:.75rem;text-align:center;box-shadow:var(--shadow-sm);cursor:pointer;transition:all .15s}
.pipeline-stage:hover{box-shadow:var(--shadow);transform:translateY(-1px)}
.pipeline-stage-count{font-size:1.6rem;font-weight:800;font-family:'JetBrains Mono',monospace;line-height:1}
.pipeline-stage-name{font-size:.64rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:.03em;margin-top:3px}
.lead-row{display:flex;align-items:center;gap:.75rem;padding:.55rem .7rem;background:var(--bg);border:1px solid var(--border-light);border-radius:var(--radius-sm);margin-bottom:.4rem;cursor:pointer;transition:all .15s}
.lead-row:hover{border-color:var(--border);box-shadow:var(--shadow)}
.lead-avatar{width:32px;height:32px;border-radius:50%;background:var(--accent-dim);display:flex;align-items:center;justify-content:center;font-size:.68rem;font-weight:600;color:var(--accent)}
.lead-info{flex:1}
.lead-name{font-size:.78rem;font-weight:600}
.lead-company{font-size:.66rem;color:var(--text-muted)}
.lead-stage-tag{font-size:.58rem;font-weight:600;padding:2px 8px;border-radius:10px}
.lead-value{font-size:.82rem;font-weight:700;font-family:'JetBrains Mono',monospace}
.insight-card{display:flex;align-items:flex-start;gap:.6rem;padding:.6rem .75rem;background:var(--bg);border:1px solid var(--border-light);border-radius:var(--radius-sm);margin-bottom:.4rem}
.insight-icon{font-size:1rem;flex-shrink:0;margin-top:1px}
.insight-text{font-size:.74rem;color:var(--text);line-height:1.45}

/* DD PIPELINE KANBAN */
.dd-kanban{display:flex;gap:6px;overflow-x:auto;padding:.5rem 0;min-height:260px;margin-bottom:1rem}
.dd-kanban-col{flex:1;min-width:145px;border-radius:var(--radius);padding:0 0 .4rem;display:flex;flex-direction:column;overflow:hidden}
.dd-kanban-col[data-stage="joey-podcast"]{background:linear-gradient(180deg,#f7f6f3 0%,#efeee9 100%);box-shadow:inset 0 2px 4px rgba(0,0,0,.04),inset 0 -1px 0 rgba(255,255,255,.6)}
.dd-kanban-col[data-stage="jordan-podcast"]{background:linear-gradient(180deg,#eeecfc 0%,#e4e0f8 100%);box-shadow:inset 0 2px 4px rgba(95,85,238,.06),inset 0 -1px 0 rgba(255,255,255,.6)}
.dd-kanban-col[data-stage="youtube-lead"]{background:linear-gradient(180deg,#fff3ed 0%,#ffe8d9 100%);box-shadow:inset 0 2px 4px rgba(255,120,0,.06),inset 0 -1px 0 rgba(255,255,255,.6)}
.dd-kanban-col[data-stage="warm-lead"]{background:linear-gradient(180deg,#fffde8 0%,#fef7c8 100%);box-shadow:inset 0 2px 4px rgba(249,217,0,.06),inset 0 -1px 0 rgba(255,255,255,.6)}
.dd-kanban-col[data-stage="strategy-call"]{background:linear-gradient(180deg,#edf6fc 0%,#deeef8 100%);box-shadow:inset 0 2px 4px rgba(4,169,244,.06),inset 0 -1px 0 rgba(255,255,255,.6)}
.dd-kanban-col[data-stage="growth-plan"]{background:linear-gradient(180deg,#f3effb 0%,#ebe4f7 100%);box-shadow:inset 0 2px 4px rgba(168,117,255,.06),inset 0 -1px 0 rgba(255,255,255,.6)}
.dd-kanban-col-header{display:flex;align-items:center;justify-content:space-between;padding:.45rem .5rem;flex-shrink:0}
.dd-kanban-col-title{display:flex;align-items:center;gap:.35rem;font-size:.64rem;font-weight:600;text-transform:uppercase;letter-spacing:.04em;color:var(--text-secondary)}
.dd-kanban-col-count{font-size:.64rem;font-weight:500;color:var(--text-muted)}
.dd-kanban-cards{flex:1;overflow-y:auto;padding:0 .3rem .3rem;display:flex;flex-direction:column;gap:4px;scrollbar-width:thin;scrollbar-color:var(--border) transparent}
.dd-lead-card{background:var(--bg-card);border:1px solid var(--border-light);border-radius:var(--radius-sm);padding:.5rem .55rem;cursor:pointer;box-shadow:0 1px 2px rgba(0,0,0,.05);transition:all .15s;text-decoration:none;color:inherit;display:block}
.dd-lead-card:hover{border-color:var(--border);box-shadow:0 3px 10px rgba(0,0,0,.1);transform:translateY(-1px)}
.dd-lead-card-name{font-size:.7rem;font-weight:600;line-height:1.25;margin-bottom:2px}
.dd-lead-card-company{font-size:.58rem;color:var(--text-muted);margin-bottom:.25rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.dd-lead-card-footer{display:flex;align-items:center;justify-content:space-between}
.dd-lead-card-source{font-size:.52rem;font-weight:500;padding:1px 5px;border-radius:3px;background:var(--bg-warm);color:var(--text-secondary)}
.dd-lead-card-value{font-size:.64rem;font-weight:700;font-family:'JetBrains Mono',monospace}
.dd-lead-card-priority{font-size:.46rem;font-weight:700;padding:1px 4px;border-radius:3px;background:var(--red-light);color:var(--red);margin-left:3px}

/* YOUTUBE — TRENDING + IDEAS + PIPELINE */
.yt-metrics{display:grid;grid-template-columns:repeat(4,1fr);gap:.65rem;margin-bottom:1rem}
.yt-kanban{display:flex;gap:.65rem;min-height:350px}
.yt-column{flex:1;min-width:180px}
.yt-col-header{display:flex;align-items:center;justify-content:space-between;padding:.45rem .5rem;margin-bottom:.35rem}
.yt-col-title{display:flex;align-items:center;gap:.4rem;font-size:.7rem;font-weight:600;text-transform:uppercase;letter-spacing:.04em;color:var(--text-secondary)}
.yt-card{background:var(--bg);border:1px solid var(--border-light);border-radius:var(--radius);padding:.6rem .65rem;margin-bottom:.4rem;cursor:pointer;box-shadow:var(--shadow-sm);transition:all .15s}
.yt-card:hover{border-color:var(--border);box-shadow:var(--shadow);transform:translateY(-1px)}
.yt-card-title{font-size:.76rem;font-weight:600;line-height:1.3;margin-bottom:.3rem}
.yt-card-tag{font-size:.54rem;font-weight:600;padding:1px 6px;border-radius:3px;display:inline-block;margin-bottom:.3rem}
.yt-card-meta{font-size:.62rem;color:var(--text-muted);display:flex;justify-content:space-between}
.yt-trending-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(270px,1fr));gap:.7rem;margin-bottom:1rem}
.yt-trending-card{background:var(--bg);border:1px solid var(--border);border-radius:var(--radius);overflow:hidden;box-shadow:var(--shadow-sm);transition:all .15s;text-decoration:none;color:inherit;display:block}
.yt-trending-card:hover{box-shadow:var(--shadow);transform:translateY(-2px)}
.yt-trending-thumb{position:relative;width:100%;aspect-ratio:16/9;overflow:hidden;display:flex;align-items:center;justify-content:center}
.yt-trending-thumb img{width:100%;height:100%;object-fit:cover}
.yt-trending-thumb .thumb-gradient{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-size:1.4rem;color:rgba(255,255,255,.6)}
.yt-trending-duration{position:absolute;bottom:4px;right:4px;background:rgba(0,0,0,.85);color:#fff;font-size:.54rem;font-weight:600;padding:1px 5px;border-radius:3px}
.yt-trending-outlier{position:absolute;top:6px;left:6px;background:var(--red);color:#fff;font-size:.48rem;font-weight:700;padding:2px 6px;border-radius:3px;text-transform:uppercase;letter-spacing:.02em}
.yt-trending-body{padding:.5rem .6rem}
.yt-trending-title{font-size:.72rem;font-weight:600;line-height:1.3;margin-bottom:.2rem;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
.yt-trending-channel{font-size:.6rem;color:var(--text-muted);margin-bottom:.2rem;display:flex;align-items:center;gap:.3rem}
.yt-trending-channel-dot{width:4px;height:4px;border-radius:50%;background:var(--red)}
.yt-trending-stats{display:flex;gap:.6rem;font-size:.56rem;color:var(--text-muted)}
.yt-toolbar{display:flex;align-items:center;gap:.4rem;margin-left:auto}
.yt-toolbar-btn{display:inline-flex;align-items:center;gap:.25rem;padding:3px 10px;border-radius:6px;border:1px solid var(--border);background:var(--bg);font-size:.54rem;font-weight:600;color:var(--text-muted);cursor:pointer;transition:all .15s;line-height:1}
.yt-toolbar-btn:hover{border-color:var(--red);color:var(--red);background:var(--red-light)}
.yt-toolbar-btn.spinning svg{animation:ytSpin .6s linear infinite}
.yt-toolbar-btn.active{border-color:var(--amber);background:var(--amber-light);color:var(--amber)}
.yt-toolbar-btn.active:hover{border-color:var(--amber);color:var(--amber)}
@keyframes ytSpin{to{transform:rotate(360deg)}}
.yt-save-btn{position:absolute;top:6px;right:6px;width:28px;height:28px;border-radius:50%;background:rgba(0,0,0,.55);border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .15s;z-index:2;opacity:0}
.yt-trending-card:hover .yt-save-btn,.yt-save-btn.saved{opacity:1}
.yt-save-btn:hover{background:rgba(0,0,0,.8);transform:scale(1.1)}
.yt-save-btn.saved{background:var(--amber)}
.yt-save-btn svg{width:14px;height:14px;fill:none;stroke:#fff;stroke-width:2}
.yt-save-btn.saved svg{fill:#fff}
.yt-toast{position:fixed;bottom:2rem;left:50%;transform:translateX(-50%) translateY(80px);background:var(--text);color:var(--bg);padding:.5rem 1.2rem;border-radius:8px;font-size:.68rem;font-weight:600;opacity:0;transition:all .3s ease;z-index:9999;pointer-events:none;white-space:nowrap}
.yt-toast.show{transform:translateX(-50%) translateY(0);opacity:1}
.yt-ideas-table{width:100%;border-collapse:separate;border-spacing:0;margin-bottom:1rem;background:var(--bg);border:1px solid var(--border);border-radius:var(--radius);overflow:hidden;box-shadow:var(--shadow-sm)}
.yt-ideas-table th{font-size:.56rem;font-weight:600;color:var(--text-muted);text-transform:uppercase;letter-spacing:.04em;padding:.45rem .6rem;text-align:left;background:var(--bg-sidebar);border-bottom:1px solid var(--border)}
.yt-ideas-table th:first-child{width:50px;text-align:center}
.yt-ideas-table td{font-size:.68rem;padding:.4rem .6rem;border-bottom:1px solid var(--border-light);vertical-align:middle}
.yt-ideas-table tr:last-child td{border-bottom:none}
.yt-ideas-table tr:hover{background:var(--bg-hover)}
.yt-ideas-table .idea-score{display:inline-block;font-size:.56rem;font-weight:700;padding:2px 7px;border-radius:4px;text-align:center;min-width:36px}
.yt-ideas-table .idea-kw{font-weight:600;color:var(--text)}
.yt-ideas-table .idea-desc{font-size:.58rem;color:var(--text-muted);max-width:320px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.yt-ideas-table .idea-vol{font-family:'JetBrains Mono',monospace;font-size:.6rem;font-weight:500}
.yt-ideas-table .idea-comp{font-size:.56rem;font-weight:500;padding:1px 6px;border-radius:3px}
.yt-ideas-table .idea-comp.low{background:var(--green-light);color:var(--green)}
.yt-ideas-table .idea-comp.medium{background:var(--amber-light);color:var(--amber)}
.yt-ideas-table .idea-comp.high{background:var(--red-light);color:var(--red)}

/* SLACK MESSAGES (right side of client pipeline) */
.slack-feed{background:var(--bg);border:1px solid var(--border);border-radius:var(--radius);overflow:hidden}
.slack-header{padding:.6rem .8rem;border-bottom:1px solid var(--border);font-size:.68rem;font-weight:600;text-transform:uppercase;letter-spacing:.06em;color:var(--text-muted)}
.slack-msg{padding:.55rem .8rem;border-bottom:1px solid var(--border-light);transition:background .15s}
.slack-msg:hover{background:var(--bg-hover)}
.slack-msg:last-child{border-bottom:none}
.slack-msg-top{display:flex;align-items:center;gap:.4rem;margin-bottom:.2rem}
.slack-msg-avatar{width:22px;height:22px;border-radius:5px;display:flex;align-items:center;justify-content:center;font-size:.55rem;font-weight:600;color:#fff}
.slack-msg-name{font-size:.72rem;font-weight:600}
.slack-msg-channel{font-size:.6rem;font-family:'JetBrains Mono',monospace;color:var(--text-muted)}
.slack-msg-text{font-size:.7rem;color:var(--text-secondary);line-height:1.4;margin-bottom:.25rem;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
.slack-msg-bottom{display:flex;align-items:center;justify-content:space-between}
.slack-msg-time{font-size:.58rem;color:var(--text-muted)}
.slack-msg-link{font-size:.58rem;font-weight:500;color:var(--accent);text-decoration:none}
.slack-msg-link:hover{text-decoration:underline}

/* CLIENT TAB — summary + sub-tabs + detail views */
.client-summary{display:grid;grid-template-columns:repeat(auto-fit,minmax(130px,1fr));gap:.6rem;margin-bottom:1rem}
.client-summary-card{background:var(--bg);border:1px solid var(--border);border-radius:var(--radius);padding:.7rem;text-align:center;box-shadow:var(--shadow-sm)}
.client-summary-val{font-size:1.3rem;font-weight:700;font-family:'JetBrains Mono',monospace;line-height:1}
.client-summary-label{font-size:.6rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:.04em;margin-top:3px}
.client-summary-sub{font-size:.58rem;color:var(--text-secondary);margin-top:2px}
.client-tabs{display:flex;gap:0;border-bottom:none;margin-bottom:0;flex-wrap:nowrap;overflow-x:auto;background:var(--bg-sidebar);border-radius:var(--radius) var(--radius) 0 0;border:1px solid var(--border);border-bottom:none}
.client-tab{display:flex;align-items:center;gap:.3rem;padding:.4rem .55rem;font-size:.62rem;font-weight:500;color:var(--text-muted);border:none;background:none;cursor:pointer;border-right:1px solid var(--border-light);transition:all .15s;font-family:inherit;white-space:nowrap;flex-shrink:0;position:relative}
.client-tab:last-child{border-right:none}
.client-tab:hover:not(.active){color:var(--text-secondary);background:var(--bg-hover)}
.client-tab.active{color:var(--text);font-weight:600;background:var(--bg);box-shadow:0 1px 0 var(--bg)}
.client-tab.active::after{content:'';position:absolute;bottom:-1px;left:0;right:0;height:2px;background:var(--accent)}
.client-tab-avatar{width:18px;height:18px;border-radius:4px;display:flex;align-items:center;justify-content:center;font-size:.46rem;font-weight:700;color:#fff;flex-shrink:0}
.client-tab-alert{width:5px;height:5px;border-radius:50%;background:var(--red);flex-shrink:0}
.client-view{display:none;border:1px solid var(--border);border-top:none;border-radius:0 0 var(--radius) var(--radius);padding:.75rem;background:var(--bg)}
.client-view.active{display:block}
.client-detail-header{display:flex;align-items:center;gap:1rem;margin-bottom:1rem;padding:.75rem 1rem;background:var(--bg);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow-sm)}
.client-detail-avatar{width:44px;height:44px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:.9rem;font-weight:700;color:#fff;flex-shrink:0}
.client-detail-info{flex:1}
.client-detail-name{font-size:1rem;font-weight:700}
.client-detail-services{font-size:.7rem;color:var(--text-muted);margin-top:1px}
.client-detail-links{display:flex;gap:.4rem;flex-wrap:wrap;margin-top:.35rem}
.client-detail-link{font-size:.62rem;color:var(--accent);text-decoration:none;font-weight:500;padding:2px 8px;border-radius:4px;border:1px solid var(--accent);transition:all .15s}
.client-detail-link:hover{background:var(--accent);color:#fff}
.client-detail-contract{text-align:right;flex-shrink:0}
.client-detail-days{font-size:1.5rem;font-weight:800;font-family:'JetBrains Mono',monospace;line-height:1}
.client-detail-days-label{font-size:.58rem;color:var(--text-muted);text-transform:uppercase}
.client-detail-target{font-size:.7rem;font-weight:600;color:var(--text-secondary);margin-top:3px}
.client-section-title{font-size:.68rem;font-weight:600;text-transform:uppercase;letter-spacing:.06em;color:var(--text-muted);margin:1rem 0 .5rem;display:flex;align-items:center;gap:.5rem}
.client-section-title .count-badge{font-size:.6rem;font-weight:600;padding:1px 7px;border-radius:10px;background:var(--accent-dim);color:var(--accent)}
.client-pipeline-stages{display:flex;gap:.5rem;flex-wrap:wrap;margin-bottom:.75rem}
.client-pipeline-stage{background:var(--bg);border:1px solid var(--border);border-radius:var(--radius);padding:.5rem .75rem;text-align:center;min-width:100px;box-shadow:var(--shadow-sm);cursor:pointer;transition:all .15s}
.client-pipeline-stage:hover{box-shadow:var(--shadow);transform:translateY(-1px)}
.client-pipeline-stage-count{font-size:1.2rem;font-weight:700;font-family:'JetBrains Mono',monospace;line-height:1}
.client-pipeline-stage-name{font-size:.58rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:.03em;margin-top:2px;white-space:nowrap}
.client-guests-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(290px,1fr));gap:.35rem}
.client-guest-row{display:flex;align-items:center;gap:.5rem;padding:.4rem .55rem;background:var(--bg);border:1px solid var(--border-light);border-radius:var(--radius-sm);transition:all .15s;text-decoration:none;color:inherit}
.client-guest-row:hover{border-color:var(--border);box-shadow:var(--shadow)}
.client-guest-name{font-size:.72rem;font-weight:600;flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.client-guest-status{font-size:.54rem;font-weight:600;padding:1px 7px;border-radius:10px;white-space:nowrap;flex-shrink:0}
.client-two-col{display:grid;grid-template-columns:1fr 1fr;gap:1rem}
.client-outreach-panel{background:var(--bg);border:1px solid var(--border);border-radius:var(--radius);padding:.65rem .75rem;box-shadow:var(--shadow-sm)}
.client-outreach-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:.5rem}
.client-outreach-title{font-size:.68rem;font-weight:600;text-transform:uppercase;letter-spacing:.06em;color:var(--text-muted);display:flex;align-items:center;gap:.35rem}
.client-outreach-title .platform-dot{width:6px;height:6px;border-radius:50%}
.client-outreach-totals{display:grid;grid-template-columns:repeat(auto-fit,minmax(70px,1fr));gap:.35rem;margin-bottom:.5rem}
.client-outreach-stat{text-align:center;padding:.3rem;background:var(--bg-warm);border-radius:var(--radius-sm)}
.client-outreach-stat-val{font-size:.9rem;font-weight:700;font-family:'JetBrains Mono',monospace;line-height:1}
.client-outreach-stat-label{font-size:.5rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:.03em;margin-top:2px}
.client-camp-row{display:flex;align-items:center;gap:.4rem;padding:.3rem .4rem;border-bottom:1px solid var(--border-light);font-size:.66rem}
.client-camp-row:last-child{border-bottom:none}
.client-camp-name-text{flex:1;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.client-camp-status-dot{width:5px;height:5px;border-radius:50%;flex-shrink:0}
.client-camp-status-dot.active{background:var(--green)}.client-camp-status-dot.paused{background:var(--amber)}
.client-camp-metric{font-size:.6rem;color:var(--text-muted);font-family:'JetBrains Mono',monospace;flex-shrink:0}
.client-calls-list{display:flex;flex-direction:column;gap:3px}
.client-call-row{display:flex;align-items:center;gap:.4rem;padding:.3rem .4rem;background:var(--bg);border:1px solid var(--border-light);border-radius:var(--radius-sm);font-size:.66rem}
.client-call-name{flex:1;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.client-call-type{font-size:.52rem;font-weight:600;padding:1px 5px;border-radius:3px;flex-shrink:0}
.client-call-date{font-size:.58rem;color:var(--text-muted);flex-shrink:0}
@media(max-width:900px){.client-two-col,.client-guests-grid{grid-template-columns:1fr}}

/* HOME DASHBOARD */
.hd-scroll{flex:1;overflow-y:auto;padding:1.5rem 2rem;background:linear-gradient(160deg,#faf9f7 0%,#f3f1ec 40%,#faf9f7 100%)}
.hd-hero{display:grid;grid-template-columns:repeat(4,1fr);gap:.75rem;margin-bottom:1.25rem}
.hd-hero-card{background:var(--bg);border:1px solid var(--border);border-radius:10px;padding:1rem 1.1rem;box-shadow:var(--shadow-sm);position:relative;overflow:hidden;transition:transform .15s,box-shadow .15s}
.hd-hero-card:hover{transform:translateY(-2px);box-shadow:0 4px 16px rgba(0,0,0,.08)}
.hd-hero-card::before{content:'';position:absolute;left:0;top:0;bottom:0;width:4px;border-radius:10px 0 0 10px}
.hd-hero-card::after{content:'';position:absolute;right:-10px;bottom:-10px;width:70px;height:70px;border-radius:50%;filter:blur(35px);opacity:.07;pointer-events:none}
.hd-hero-card.accent::before{background:linear-gradient(180deg,var(--accent),#ff8a50)}.hd-hero-card.accent::after{background:var(--accent)}
.hd-hero-card.blue::before{background:linear-gradient(180deg,var(--blue),#64b5f6)}.hd-hero-card.blue::after{background:var(--blue)}
.hd-hero-card.green::before{background:linear-gradient(180deg,var(--green),#66bb6a)}.hd-hero-card.green::after{background:var(--green)}
.hd-hero-card.purple::before{background:linear-gradient(180deg,var(--purple),#9575cd)}.hd-hero-card.purple::after{background:var(--purple)}
.hd-hero-num{font-size:1.8rem;font-weight:800;font-family:'JetBrains Mono',monospace;line-height:1;letter-spacing:-.02em}
.hd-hero-label{font-size:.58rem;font-weight:600;text-transform:uppercase;letter-spacing:.06em;color:var(--text-muted);margin-top:6px}
.hd-hero-sub{font-size:.54rem;color:var(--text-muted);margin-top:4px;display:flex;align-items:center;gap:4px}
.hd-alerts{display:flex;flex-direction:column;gap:.4rem;margin-bottom:1.25rem}
.hd-alert{display:flex;align-items:center;gap:.6rem;padding:.55rem .85rem;border-radius:8px;font-size:.68rem;font-weight:500;border-left:3px solid;backdrop-filter:blur(4px)}
.hd-alert.danger{background:linear-gradient(90deg,#fdeaea 0%,#fff5f5 100%);border-color:var(--red);color:#b71c1c}
.hd-alert.warn{background:linear-gradient(90deg,#fef7e8 0%,#fffbf0 100%);border-color:var(--amber);color:#7a5c00}
.hd-alert-icon{font-size:.82rem;flex-shrink:0}
.hd-pipeline{background:var(--bg);border:1px solid var(--border);border-radius:10px;padding:.85rem 1rem;box-shadow:var(--shadow-sm);margin-bottom:1.25rem}
.hd-pipeline-header{display:flex;justify-content:space-between;align-items:baseline;margin-bottom:.55rem}
.hd-pipeline-title{font-size:.62rem;font-weight:700;text-transform:uppercase;letter-spacing:.06em;color:var(--text-muted)}
.hd-pipeline-total{font-size:.76rem;font-weight:700;font-family:'JetBrains Mono',monospace;color:var(--text)}
.hd-pipeline-bar{display:flex;height:36px;border-radius:8px;overflow:hidden;box-shadow:inset 0 1px 3px rgba(0,0,0,.06);margin-bottom:.5rem}
.hd-pipeline-seg{display:flex;align-items:center;justify-content:center;font-size:.58rem;font-weight:700;color:#fff;cursor:default;position:relative;border-right:2px solid rgba(255,255,255,.3);transition:filter .15s}
.hd-pipeline-seg:last-child{border-right:none}
.hd-pipeline-seg:hover{filter:brightness(1.12)}
.hd-pipeline-seg span{text-shadow:0 1px 3px rgba(0,0,0,.25);pointer-events:none}
.hd-pipeline-legend{display:flex;flex-wrap:wrap;gap:.3rem .7rem}
.hd-pipeline-legend-item{display:flex;align-items:center;gap:.25rem;font-size:.54rem;color:var(--text-secondary);font-weight:500}
.hd-pipeline-legend-dot{width:8px;height:8px;border-radius:2px;flex-shrink:0}
.hd-clients{display:grid;grid-template-columns:repeat(5,1fr);gap:.65rem;margin-bottom:1.25rem}
.hd-client{background:var(--bg);border:1px solid var(--border);border-radius:10px;padding:.75rem .8rem;box-shadow:var(--shadow-sm);transition:transform .15s,box-shadow .15s;position:relative;overflow:hidden}
.hd-client:hover{transform:translateY(-2px);box-shadow:0 4px 16px rgba(0,0,0,.08)}
.hd-client-top{display:flex;align-items:center;gap:.45rem;margin-bottom:.5rem}
.hd-client-avatar{width:30px;height:30px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.52rem;font-weight:700;color:#fff;flex-shrink:0;box-shadow:0 2px 6px rgba(0,0,0,.12)}
.hd-client-name{font-size:.74rem;font-weight:700;line-height:1.15}
.hd-client-svc{font-size:.48rem;color:var(--text-muted);margin-top:1px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:120px}
.hd-client-stats{display:grid;grid-template-columns:1fr 1fr;gap:3px .4rem;margin-bottom:.45rem}
.hd-client-stat{font-size:.54rem;color:var(--text-muted)}
.hd-client-stat strong{font-weight:700;color:var(--text);font-family:'JetBrains Mono',monospace;font-size:.6rem}
.hd-client-contract-label{font-size:.48rem;color:var(--text-muted);display:flex;justify-content:space-between;margin-bottom:3px;font-weight:500}
.hd-progress{height:4px;background:var(--bg-sidebar);border-radius:3px;overflow:hidden}
.hd-progress-fill{height:100%;border-radius:3px;transition:width .6s ease}
.hd-client-expired{position:absolute;top:0;right:0;font-size:.44rem;font-weight:700;padding:3px 8px;border-radius:0 10px 0 6px;background:var(--red);color:#fff;text-transform:uppercase;letter-spacing:.04em}
.hd-cols{display:grid;grid-template-columns:1fr 1fr;gap:.75rem;margin-bottom:1.25rem}
.hd-section{background:var(--bg);border:1px solid var(--border);border-radius:10px;padding:.85rem .9rem;box-shadow:var(--shadow-sm)}
.hd-section-title{font-size:.6rem;font-weight:700;text-transform:uppercase;letter-spacing:.06em;color:var(--text-muted);margin-bottom:.55rem;display:flex;align-items:center;gap:.35rem}
.hd-section-title::before{content:'';width:7px;height:7px;border-radius:50%;flex-shrink:0;background:var(--dot-color,var(--accent))}
.hd-lead{display:flex;align-items:center;gap:.5rem;padding:.4rem .3rem;border-bottom:1px solid var(--border-light);transition:background .1s}
.hd-lead:last-child{border-bottom:none}
.hd-lead:hover{background:var(--bg-hover);border-radius:6px}
.hd-lead-avatar{width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.5rem;font-weight:700;color:#fff;flex-shrink:0}
.hd-lead-info{flex:1;min-width:0}
.hd-lead-name{font-size:.68rem;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.hd-lead-name a{color:inherit;text-decoration:none}
.hd-lead-name a:hover{color:var(--accent)}
.hd-lead-company{font-size:.5rem;color:var(--text-muted)}
.hd-lead-badge{font-size:.48rem;font-weight:700;padding:2px 8px;border-radius:10px;flex-shrink:0;white-space:nowrap;letter-spacing:.02em}
.hd-agents{display:grid;grid-template-columns:repeat(3,1fr);gap:.3rem}
.hd-agent{display:flex;align-items:center;gap:.3rem;padding:.35rem .4rem;border-radius:7px;font-size:.6rem;border:1px solid var(--border-light);transition:all .15s;background:var(--bg)}
.hd-agent:hover{border-color:var(--border);box-shadow:var(--shadow-sm);transform:translateY(-1px)}
.hd-agent-dot{width:7px;height:7px;border-radius:50%;flex-shrink:0}
@keyframes livePulse{0%,100%{box-shadow:0 0 0 0 rgba(45,159,78,.4)}70%{box-shadow:0 0 0 4px rgba(45,159,78,0)}}
.hd-agent-dot.live{animation:livePulse 2s ease-in-out infinite}
.hd-agent-name{font-weight:600;flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.hd-agent-label{font-size:.42rem;font-weight:700;padding:1px 5px;border-radius:3px;text-transform:uppercase;letter-spacing:.03em;flex-shrink:0}
.hd-links{display:flex;flex-wrap:wrap;gap:.35rem;padding-bottom:.5rem}
.hd-link{font-size:.58rem;padding:.35rem .65rem;background:var(--bg);border:1px solid var(--border);border-radius:7px;text-decoration:none;color:var(--text-secondary);font-weight:500;transition:all .15s;display:flex;align-items:center;gap:.25rem}
.hd-link:hover{border-color:var(--accent);color:var(--accent);transform:translateY(-1px);box-shadow:var(--shadow-sm)}
.hd-section-label{font-size:.62rem;font-weight:700;text-transform:uppercase;letter-spacing:.06em;color:var(--text-muted);margin-bottom:.5rem}
.hd-scroll::-webkit-scrollbar{width:6px}.hd-scroll::-webkit-scrollbar-track{background:transparent}.hd-scroll::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px}.hd-scroll::-webkit-scrollbar-thumb:hover{background:var(--text-muted)}
@keyframes hdFadeUp{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
.hd-hero-card,.hd-pipeline,.hd-client,.hd-section{animation:hdFadeUp .35s ease-out both}
.hd-hero-card:nth-child(1){animation-delay:0s}.hd-hero-card:nth-child(2){animation-delay:.06s}.hd-hero-card:nth-child(3){animation-delay:.12s}.hd-hero-card:nth-child(4){animation-delay:.18s}
.hd-client:nth-child(1){animation-delay:.1s}.hd-client:nth-child(2){animation-delay:.15s}.hd-client:nth-child(3){animation-delay:.2s}.hd-client:nth-child(4){animation-delay:.25s}.hd-client:nth-child(5){animation-delay:.3s}
.hd-pipeline-seg{position:relative}.hd-pipeline-seg::after{content:'';position:absolute;inset:0;background:linear-gradient(180deg,rgba(255,255,255,.18) 0%,transparent 45%,rgba(0,0,0,.06) 100%);pointer-events:none}
.hd-client{border-top:3px solid var(--client-color,var(--border))}
.hd-mini-bar{height:3px;background:var(--bg-sidebar);border-radius:2px;overflow:hidden;margin-top:2px}.hd-mini-bar-fill{height:100%;border-radius:2px;transition:width .5s ease}
.hd-activity-compact{margin-top:.1rem}.hd-activity-row{display:flex;align-items:center;gap:.4rem;padding:.3rem 0;border-bottom:1px solid var(--border-light);font-size:.6rem}.hd-activity-row:last-child{border-bottom:none}
.hd-health-row{display:flex;flex-wrap:wrap;gap:.35rem;margin-top:.3rem}
.hd-health-chip{display:flex;align-items:center;gap:.25rem;font-size:.52rem;font-weight:500;padding:3px 8px;border-radius:5px;background:var(--green-light);color:var(--green);border:1px solid rgba(45,159,78,.12)}
.hd-health-dot{width:5px;height:5px;border-radius:50%;background:var(--green);flex-shrink:0}
.hd-lead-value{font-size:.52rem;font-weight:700;font-family:'JetBrains Mono',monospace;color:var(--text-secondary);flex-shrink:0;margin-right:.15rem}
.hd-tag-priority{font-size:.42rem;font-weight:700;padding:1px 5px;border-radius:3px;background:var(--accent-light);color:var(--accent);margin-left:4px;vertical-align:middle;text-transform:uppercase;letter-spacing:.03em}
.hd-divider{height:1px;background:linear-gradient(90deg,transparent 0%,var(--border) 20%,var(--border) 80%,transparent 100%);margin:1.25rem 0 1rem}
.hd-date-banner{font-size:.6rem;color:var(--text-muted);font-weight:500;margin-bottom:1rem;display:flex;align-items:center;gap:.5rem}
.hd-date-banner strong{color:var(--text);font-weight:700;font-size:.7rem}
.hd-three-col{display:grid;grid-template-columns:1fr 1fr 1fr;gap:.75rem;margin-bottom:1.25rem}
@media(max-width:1100px){.hd-hero{grid-template-columns:repeat(2,1fr)}.hd-clients{grid-template-columns:repeat(3,1fr)}.hd-agents{grid-template-columns:repeat(2,1fr)}.hd-three-col{grid-template-columns:1fr}}
@media(max-width:700px){.hd-cols,.hd-hero{grid-template-columns:1fr}.hd-clients{grid-template-columns:1fr 1fr}}

/* NORTH STAR REVENUE TRACKER */
.ns-wrap{background:var(--bg);border:1px solid var(--border);border-radius:12px;padding:1.1rem 1.3rem;margin-bottom:1.25rem;box-shadow:var(--shadow);position:relative;overflow:hidden;animation:hdFadeUp .35s ease-out both}
.ns-wrap::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,var(--accent),var(--amber) 50%,var(--green))}
.ns-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:.75rem}
.ns-title{font-size:.56rem;font-weight:700;text-transform:uppercase;letter-spacing:.08em;color:var(--text-muted);display:flex;align-items:center;gap:.4rem}
.ns-title::before{content:'\2605';color:var(--accent);font-size:.7rem}
.ns-goal-tag{font-size:.56rem;font-weight:700;color:var(--accent);font-family:'JetBrains Mono',monospace;background:var(--accent-light);padding:2px 10px;border-radius:10px}
.ns-revenue{display:grid;grid-template-columns:auto 1fr auto;align-items:center;gap:1.2rem;margin-bottom:.6rem}
.ns-amount{text-align:center}
.ns-amount-num{font-size:2rem;font-weight:800;font-family:'JetBrains Mono',monospace;line-height:1;letter-spacing:-.03em}
.ns-amount-label{font-size:.48rem;font-weight:600;text-transform:uppercase;letter-spacing:.06em;color:var(--text-muted);margin-top:4px}
.ns-bar-wrap{position:relative}
.ns-bar{height:28px;background:var(--bg-sidebar);border-radius:14px;overflow:hidden;position:relative;box-shadow:inset 0 2px 4px rgba(0,0,0,.06)}
.ns-bar-fill{height:100%;border-radius:14px;background:linear-gradient(90deg,var(--accent),#ff8a50);position:relative;transition:width 1s ease;min-width:50px;display:flex;align-items:center;justify-content:flex-end;padding-right:10px}
.ns-bar-fill::after{content:'';position:absolute;inset:0;background:linear-gradient(180deg,rgba(255,255,255,.22) 0%,transparent 50%,rgba(0,0,0,.06) 100%);border-radius:14px;pointer-events:none}
.ns-bar-pct{font-size:.7rem;font-weight:800;font-family:'JetBrains Mono',monospace;color:#fff;text-shadow:0 1px 3px rgba(0,0,0,.3);position:relative;z-index:1}
.ns-gap-row{display:flex;align-items:center;justify-content:center;gap:.6rem;margin-bottom:.75rem;font-size:.54rem;color:var(--text-muted);font-weight:500;flex-wrap:wrap}
.ns-gap-pill{display:inline-flex;align-items:center;gap:.2rem;padding:2px 8px;border-radius:10px;font-weight:700;font-size:.54rem;font-family:'JetBrains Mono',monospace}
.ns-kpi-title{font-size:.48rem;font-weight:700;text-transform:uppercase;letter-spacing:.06em;color:var(--text-muted);margin-bottom:.4rem;text-align:center}
.ns-kpis{display:grid;grid-template-columns:repeat(6,1fr);gap:.45rem}
.ns-kpi{text-align:center;padding:.55rem .3rem .45rem;background:var(--bg-warm);border:1px solid var(--border-light);border-radius:8px;position:relative;overflow:hidden;transition:transform .15s,box-shadow .15s}
.ns-kpi:hover{transform:translateY(-2px);box-shadow:var(--shadow-sm)}
.ns-kpi::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:var(--kpi-color,var(--accent))}
.ns-kpi-num{font-size:1.3rem;font-weight:800;font-family:'JetBrains Mono',monospace;line-height:1}
.ns-kpi-unit{font-size:.42rem;font-weight:600;text-transform:uppercase;letter-spacing:.04em;color:var(--text-muted);margin-top:2px}
.ns-kpi-label{font-size:.5rem;font-weight:700;margin-top:4px;color:var(--text)}
.ns-kpi-result{font-size:.42rem;color:var(--text-muted);margin-top:3px;font-weight:500;line-height:1.2}
.ns-kpi-of{font-size:.44rem;font-weight:600;color:var(--text-muted);font-family:'JetBrains Mono',monospace;margin-top:1px}
.ns-kpi-bar{height:3px;background:var(--bg-sidebar);border-radius:2px;margin-top:5px;overflow:hidden}
.ns-kpi-bar-fill{height:100%;border-radius:2px;transition:width .8s ease}
.ns-week-label{font-size:.44rem;font-weight:600;color:var(--text-muted);margin-left:.3rem}
.ns-summary{display:flex;align-items:center;justify-content:center;gap:.3rem;margin-top:.6rem;padding-top:.5rem;border-top:1px solid var(--border-light);font-size:.52rem;font-weight:500;color:var(--text-secondary);flex-wrap:wrap}
.ns-summary strong{font-weight:800;font-family:'JetBrains Mono',monospace}
/* PACE BAR — single clean row after KPIs */
.ns-pace-bar{display:flex;align-items:center;gap:.75rem;margin-top:.65rem;padding:.5rem .7rem;background:var(--bg-sidebar);border-radius:8px;border:1px solid var(--border-light)}
.ns-pace-vol{display:flex;align-items:center;gap:.4rem;flex-shrink:0}
.ns-pace-pct{font-size:.9rem;font-weight:800;font-family:'JetBrains Mono',monospace;line-height:1}
.ns-pace-track{flex:1;height:4px;background:var(--bg);border-radius:2px;min-width:40px;overflow:hidden}
.ns-pace-track-fill{height:100%;border-radius:2px;transition:width .8s ease}
.ns-pace-pills{display:flex;align-items:center;gap:.4rem;flex-shrink:0}
.ns-pace-pill{font-size:.46rem;font-weight:700;font-family:'JetBrains Mono',monospace;padding:2px 7px;border-radius:8px;white-space:nowrap}
/* INSIGHT ROW — funnel + sources inline */
.ns-insight{display:flex;align-items:center;justify-content:center;gap:.4rem;margin-top:.4rem;font-size:.44rem;color:var(--text-muted);font-weight:500;flex-wrap:wrap}
.ns-insight strong{font-weight:700;font-family:'JetBrains Mono',monospace;color:var(--text-secondary)}
.ns-insight-sep{color:var(--border);margin:0 .1rem}
.ns-src-dot{width:6px;height:6px;border-radius:2px;display:inline-block;margin-right:2px;vertical-align:middle}
/* DAILY TOGGLE — in header row */
.ns-day-toggle{display:inline-flex;align-items:center;gap:.25rem;cursor:pointer;user-select:none;margin-left:.5rem}
.ns-day-toggle input{display:none}
.ns-day-switch{width:24px;height:12px;background:var(--bg-sidebar);border:1px solid var(--border);border-radius:6px;position:relative;transition:background .2s}
.ns-day-switch::after{content:'';position:absolute;top:1px;left:1px;width:8px;height:8px;border-radius:50%;background:var(--text-muted);transition:transform .2s}
.ns-day-toggle input:checked~.ns-day-switch{background:var(--accent);border-color:var(--accent)}
.ns-day-toggle input:checked~.ns-day-switch::after{transform:translateX(12px);background:#fff}
.ns-day-label{font-size:.4rem;font-weight:600;color:var(--text-muted);text-transform:uppercase;letter-spacing:.04em}
@media(max-width:1100px){.ns-kpis{grid-template-columns:repeat(3,1fr)}.ns-revenue{grid-template-columns:1fr;text-align:center;gap:.6rem}.ns-pace-bar{flex-wrap:wrap}}
@media(max-width:700px){.ns-kpis{grid-template-columns:repeat(2,1fr)}.ns-pace-bar{flex-direction:column;align-items:stretch}}

/* CLIENT HEALTH SCORES */
.health-badge{display:inline-flex;align-items:center;gap:3px;font-size:.5rem;font-weight:700;padding:2px 7px;border-radius:10px;text-transform:uppercase;letter-spacing:.03em}
.health-badge.green{background:var(--green-light);color:var(--green)}
.health-badge.amber{background:var(--amber-light);color:var(--amber)}
.health-badge.red{background:var(--red-light);color:var(--red)}
.health-badge-dot{width:5px;height:5px;border-radius:50%}
.health-badge.green .health-badge-dot{background:var(--green)}
.health-badge.amber .health-badge-dot{background:var(--amber)}
.health-badge.red .health-badge-dot{background:var(--red)}
.guarantee-pace{font-size:.52rem;font-weight:600;margin-top:2px}
.guarantee-pace.on-track{color:var(--green)}
.guarantee-pace.behind{color:var(--amber)}
.guarantee-pace.critical{color:var(--red)}
.delivery-flag{display:inline-flex;align-items:center;gap:3px;font-size:.46rem;font-weight:600;padding:2px 6px;border-radius:4px;margin-right:3px}
.delivery-flag.active{background:var(--green-light);color:var(--green)}
.delivery-flag.paused{background:var(--amber-light);color:var(--amber)}
.delivery-flag.none{background:var(--red-light);color:var(--red)}

/* PIPELINE VELOCITY */
.pipeline-conversion{display:flex;align-items:center;gap:.2rem;margin-bottom:1rem;flex-wrap:wrap;justify-content:center}
.pipeline-conv-stage{text-align:center;padding:.4rem .6rem;background:var(--bg);border:1px solid var(--border);border-radius:var(--radius-sm);min-width:80px}
.pipeline-conv-count{font-size:1rem;font-weight:700;font-family:'JetBrains Mono',monospace;line-height:1}
.pipeline-conv-label{font-size:.5rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:.03em;margin-top:2px}
.pipeline-conv-arrow{font-size:.52rem;font-weight:700;color:var(--text-muted);display:flex;flex-direction:column;align-items:center;gap:1px;padding:0 .15rem}
.pipeline-conv-arrow span{font-family:'JetBrains Mono',monospace}
.pipeline-velocity-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:.5rem;margin-bottom:1rem}
.pipeline-vel-card{background:var(--bg);border:1px solid var(--border);border-radius:var(--radius-sm);padding:.5rem .6rem;text-align:center;box-shadow:var(--shadow-sm)}
.pipeline-vel-val{font-size:1rem;font-weight:700;font-family:'JetBrains Mono',monospace;line-height:1}
.pipeline-vel-label{font-size:.5rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:.03em;margin-top:2px}
.pipeline-vel-sub{font-size:.46rem;color:var(--text-secondary);margin-top:1px}

/* TEAM OPERATIONS TAB */
.team-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:.75rem;margin-bottom:1.25rem}
.team-card{background:var(--bg);border:1px solid var(--border);border-radius:10px;padding:.85rem 1rem;box-shadow:var(--shadow-sm);transition:transform .15s,box-shadow .15s;border-top:3px solid var(--team-color,var(--accent))}
.team-card:hover{transform:translateY(-2px);box-shadow:0 4px 16px rgba(0,0,0,.08)}
.team-card-top{display:flex;align-items:center;gap:.6rem;margin-bottom:.6rem}
.team-card-avatar{width:38px;height:38px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.7rem;font-weight:700;color:#fff;flex-shrink:0}
.team-card-info{flex:1}
.team-card-name{font-size:.82rem;font-weight:700}
.team-card-role{font-size:.58rem;color:var(--text-muted)}
.team-card-stats{display:grid;grid-template-columns:1fr 1fr 1fr;gap:.35rem}
.team-card-stat{text-align:center;padding:.3rem;background:var(--bg-warm);border-radius:var(--radius-sm)}
.team-card-stat-val{font-size:.85rem;font-weight:700;font-family:'JetBrains Mono',monospace;line-height:1}
.team-card-stat-label{font-size:.44rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:.03em;margin-top:2px}
.team-card-capacity{height:4px;background:var(--bg-hover);border-radius:2px;margin-top:.5rem;overflow:hidden}
.team-card-capacity-fill{height:100%;border-radius:2px;transition:width .6s}
.team-summary{display:grid;grid-template-columns:repeat(auto-fit,minmax(130px,1fr));gap:.6rem;margin-bottom:1rem}
.team-summary-card{background:var(--bg);border:1px solid var(--border);border-radius:var(--radius);padding:.65rem;text-align:center;box-shadow:var(--shadow-sm)}
.team-summary-val{font-size:1.2rem;font-weight:700;font-family:'JetBrains Mono',monospace;line-height:1}
.team-summary-label{font-size:.55rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:.04em;margin-top:3px}
.team-summary-sub{font-size:.5rem;color:var(--text-secondary);margin-top:2px}
.summary-label{font-size:.55rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:.04em;margin-bottom:3px}
.summary-value{font-size:1.1rem;font-weight:700;line-height:1}
.team-stat-item{text-align:center;padding:.35rem;background:var(--bg-warm);border-radius:var(--radius-sm)}
.team-stat-label{font-size:.44rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:.03em;display:block;margin-bottom:2px}
.team-stat-value{font-size:.82rem;font-weight:700;font-family:'JetBrains Mono',monospace;line-height:1}

/* YOUTUBE CHANNEL METRICS */
.yt-channel-wrap{background:var(--bg);border:1px solid var(--border);border-radius:10px;padding:.85rem 1rem;margin-bottom:1.25rem;box-shadow:var(--shadow-sm)}
.yt-channel-header{display:flex;align-items:center;gap:.6rem;margin-bottom:.6rem}
.yt-channel-avatar{width:42px;height:42px;border-radius:50%;background:var(--red);display:flex;align-items:center;justify-content:center;font-size:1rem;font-weight:700;color:#fff}
.yt-channel-name{font-size:.85rem;font-weight:700}
.yt-channel-handle{font-size:.6rem;color:var(--text-muted)}
.yt-channel-stats{display:grid;grid-template-columns:repeat(5,1fr);gap:.5rem}
.yt-channel-stat{text-align:center;padding:.45rem;background:var(--bg-warm);border-radius:var(--radius-sm)}
.yt-channel-stat-val{font-size:1rem;font-weight:700;font-family:'JetBrains Mono',monospace;line-height:1}
.yt-channel-stat-label{font-size:.44rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:.03em;margin-top:2px}
.yt-channel-stat-sub{font-size:.42rem;color:var(--text-secondary);margin-top:1px}
.yt-conversion{display:flex;align-items:center;justify-content:center;gap:.3rem;padding:.5rem .7rem;background:var(--bg-sidebar);border-radius:8px;border:1px solid var(--border-light);margin-top:.6rem;font-size:.54rem;font-weight:500;color:var(--text-secondary);flex-wrap:wrap}
.yt-conversion strong{font-weight:800;font-family:'JetBrains Mono',monospace;color:var(--text)}

/* INSTANTLY OVERVIEW */
.instantly-overview{background:var(--bg);border:1px solid var(--border);border-radius:10px;padding:.85rem 1rem;margin-bottom:1rem;box-shadow:var(--shadow-sm)}
.instantly-stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(100px,1fr));gap:.45rem}
.instantly-stat{text-align:center;padding:.4rem;background:var(--bg-warm);border-radius:var(--radius-sm)}
.instantly-stat-val{font-size:.9rem;font-weight:700;font-family:'JetBrains Mono',monospace;line-height:1}
.instantly-stat-label{font-size:.44rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:.03em;margin-top:2px}

/* ANIMATIONS */
@keyframes fade-in{from{opacity:0}to{opacity:1}}
@keyframes slide-up{from{opacity:0;transform:translateY(4px)}to{opacity:1;transform:translateY(0)}}
.kanban-card,.yt-card{animation:slide-up .25s ease-out both}
.agent-item{animation:fade-in .2s ease-out both}

@media(max-width:1200px){.sidebar-right{width:250px;min-width:250px}}
@media(max-width:1000px){.sidebar-left{width:210px;min-width:210px}}

/* ─── APP WRAP FIX ─────────────────────────────────── */
#app-wrap{display:flex;flex-direction:column;flex:1;overflow:hidden}

/* ─── MOBILE OPTIMIZATION ──────────────────────────── */
@media(max-width:768px){
  body{height:100dvh}
  /* Header: compact */
  .header{padding:0 .75rem;height:44px;min-height:44px;gap:.4rem}
  .header-title{font-size:.82rem}
  .header-badge,.clock-date,.online-badge{display:none}
  .clock{font-size:.8rem}
  .sc-label{display:none}
  .sc-track{width:28px;height:15px}
  .sc-track::after{width:11px;height:11px}
  .sc-wrap.active .sc-track::after{transform:translateX(13px)}
  /* Tab bar: scrollable */
  .tab-bar{padding:0 .4rem;overflow-x:auto;-webkit-overflow-scrolling:touch;scrollbar-width:none}
  .tab-bar::-webkit-scrollbar{display:none}
  .tab-btn{padding:.4rem .65rem;font-size:.66rem;white-space:nowrap;flex-shrink:0}
  /* AI Agents: hide sidebars on mobile */
  .sidebar-left,.sidebar-right{display:none}
  .kanban-area{width:100%}
  .kanban-header{padding:.5rem .65rem}
  .kanban-board{padding:0 .35rem .35rem}
  .kanban-column{min-width:135px}
  .kanban-card{min-height:auto;padding:.5rem .55rem}
  .kanban-card-title{font-size:.72rem}
  .kanban-card-desc{font-size:.62rem}
  /* Home: tighter */
  .hd-scroll{padding:.75rem .65rem}
  .hd-hero{gap:.45rem}
  .hd-hero-num{font-size:1.35rem}
  .hd-hero-card{padding:.65rem .75rem}
  .hd-hero-label{font-size:.52rem;margin-top:4px}
  .hd-hero-sub{font-size:.48rem}
  .hd-clients{gap:.4rem}
  .hd-client{padding:.5rem .55rem}
  .hd-client-avatar{width:24px;height:24px;font-size:.42rem}
  .hd-client-name{font-size:.64rem}
  .hd-client-svc{font-size:.4rem;max-width:90px}
  .hd-client-stat{font-size:.48rem}
  .hd-client-stat strong{font-size:.54rem}
  .hd-pipeline{padding:.6rem .7rem}
  .hd-pipeline-bar{height:28px}
  .hd-pipeline-seg{font-size:.5rem}
  .hd-pipeline-legend{gap:.2rem .5rem}
  .hd-pipeline-legend-item{font-size:.46rem}
  .hd-section{padding:.6rem .65rem}
  .hd-section-title{font-size:.54rem;margin-bottom:.4rem}
  .hd-cols{gap:.5rem}
  .hd-three-col{gap:.5rem}
  .hd-agents{grid-template-columns:repeat(2,1fr);gap:.25rem}
  .hd-agent{padding:.25rem .3rem;font-size:.52rem}
  .hd-agent-dot{width:6px;height:6px}
  .hd-agent-label{font-size:.38rem;padding:1px 4px}
  .hd-lead{padding:.3rem .2rem;gap:.4rem}
  .hd-lead-avatar{width:24px;height:24px;font-size:.44rem}
  .hd-lead-name{font-size:.62rem}
  .hd-lead-badge{font-size:.42rem;padding:2px 6px}
  .hd-date-banner{font-size:.52rem}
  .hd-date-banner strong{font-size:.6rem}
  .hd-link{font-size:.52rem;padding:.3rem .5rem}
  .hd-divider{margin:.85rem 0 .7rem}
  .hd-alert{padding:.4rem .65rem;font-size:.6rem;gap:.4rem}
  .hd-alert-icon{font-size:.72rem}
  /* North Star */
  .ns-wrap{padding:.7rem .75rem;border-radius:10px;margin-bottom:.85rem}
  .ns-header{flex-wrap:wrap;gap:.3rem}
  .ns-title{font-size:.5rem}
  .ns-goal-tag{font-size:.48rem;padding:2px 7px}
  .ns-day-toggle{margin-left:.25rem}
  .ns-day-label{font-size:.36rem}
  .ns-revenue{grid-template-columns:auto 1fr auto;gap:.6rem}
  .ns-amount-num{font-size:1.4rem}
  .ns-amount-label{font-size:.42rem}
  .ns-bar{height:20px}
  .ns-bar-fill{min-width:30px;padding-right:6px}
  .ns-bar-pct{font-size:.58rem}
  .ns-gap-row{font-size:.46rem;gap:.2rem}
  .ns-gap-pill{font-size:.46rem;padding:1px 5px}
  .ns-kpi{padding:.4rem .2rem .35rem}
  .ns-kpi-num{font-size:.95rem}
  .ns-kpi-label{font-size:.42rem}
  .ns-kpi-unit{font-size:.36rem}
  .ns-kpi-result{font-size:.36rem}
  .ns-kpi-of{font-size:.38rem}
  .ns-pace-bar{padding:.35rem .5rem;gap:.4rem}
  .ns-pace-pct{font-size:.7rem}
  .ns-pace-pill{font-size:.4rem;padding:1px 5px}
  .ns-insight{font-size:.38rem;gap:.2rem}
  .ns-insight-sep{margin:0}
  /* Tab scroll content */
  .tab-scroll{padding:.75rem .65rem}
  /* DD Pipeline */
  .pipeline-stages{flex-wrap:wrap;gap:.3rem}
  .pipeline-stage{flex:0 0 calc(33.33% - .25rem);padding:.45rem .3rem}
  .pipeline-stage-count{font-size:1.1rem}
  .pipeline-stage-name{font-size:.52rem}
  .dd-kanban{min-height:200px}
  .dd-kanban-col{min-width:120px}
  .dd-lead-card{padding:.4rem .45rem}
  .dd-lead-card-name{font-size:.62rem}
  .lead-row{gap:.4rem;padding:.4rem .45rem}
  .lead-avatar{width:26px;height:26px;font-size:.58rem}
  .lead-name{font-size:.7rem}
  .lead-company{font-size:.58rem}
  .lead-value{font-size:.72rem}
  .insight-card{padding:.45rem .55rem;gap:.4rem}
  .insight-text{font-size:.66rem}
  .metric-cards{grid-template-columns:repeat(2,1fr);gap:.4rem}
  .metric-card{padding:.6rem}
  .metric-value{font-size:1.1rem}
  .metric-label{font-size:.56rem}
  .section-heading{font-size:.58rem;margin:1rem 0 .5rem}
  /* Clients */
  .client-summary{grid-template-columns:repeat(3,1fr);gap:.35rem}
  .client-summary-card{padding:.45rem}
  .client-summary-val{font-size:.95rem}
  .client-summary-label{font-size:.48rem}
  .client-tabs{scrollbar-width:none}
  .client-tabs::-webkit-scrollbar{display:none}
  .client-tab{padding:.35rem .4rem;font-size:.54rem}
  .client-tab-avatar{width:16px;height:16px;font-size:.4rem}
  .client-detail-header{flex-wrap:wrap;gap:.5rem;padding:.55rem .65rem}
  .client-detail-avatar{width:34px;height:34px;font-size:.7rem}
  .client-detail-name{font-size:.82rem}
  .client-detail-services{font-size:.6rem}
  .client-detail-link{font-size:.54rem;padding:2px 6px}
  .client-detail-days{font-size:1.1rem}
  .client-detail-contract{text-align:left;display:flex;align-items:center;gap:.5rem;width:100%;border-top:1px solid var(--border-light);padding-top:.4rem}
  .client-section-title{font-size:.6rem;margin:.75rem 0 .4rem}
  .client-kpis{gap:.25rem}
  .client-kpi{padding:.3rem}
  .client-kpi-val{font-size:.82rem}
  .client-kpi-label{font-size:.46rem}
  .client-campaigns{grid-template-columns:1fr}
  .client-pipeline-stages{gap:.3rem}
  .client-pipeline-stage{min-width:72px;padding:.35rem .5rem}
  .client-pipeline-stage-count{font-size:.95rem}
  .client-pipeline-stage-name{font-size:.5rem}
  .client-guests-grid{grid-template-columns:1fr}
  .client-two-col{grid-template-columns:1fr}
  .client-outreach-totals{grid-template-columns:repeat(3,1fr)}
  .client-outreach-stat-val{font-size:.78rem}
  .client-outreach-stat-label{font-size:.42rem}
  .camp-table th,.camp-table td{padding:.3rem .35rem;font-size:.6rem}
  .camp-table th{font-size:.5rem}
  .client-view{padding:.55rem}
  /* YouTube */
  .yt-metrics{grid-template-columns:repeat(2,1fr);gap:.4rem}
  .yt-trending-grid{grid-template-columns:1fr;gap:.45rem}
  .yt-trending-body{padding:.4rem .5rem}
  .yt-trending-title{font-size:.65rem}
  .yt-trending-channel{font-size:.52rem}
  .yt-trending-stats{font-size:.48rem}
  .yt-kanban{flex-direction:column;min-height:auto;gap:.5rem}
  .yt-column{min-width:100%}
  .yt-card{padding:.45rem .5rem}
  .yt-card-title{font-size:.68rem}
  .yt-ideas-table th,.yt-ideas-table td{padding:.3rem .4rem}
  .yt-ideas-table th{font-size:.48rem}
  .yt-ideas-table td{font-size:.6rem}
  .yt-ideas-table .idea-desc{max-width:140px}
  .yt-toolbar{gap:.25rem;margin-left:auto}
  .yt-toolbar-btn{font-size:.48rem;padding:2px 7px}
  .yt-save-btn{opacity:1;width:24px;height:24px}
  .yt-save-btn svg{width:12px;height:12px}
  /* Modal */
  .modal{width:95vw;max-height:85vh;border-radius:10px}
  .modal-header{padding:.65rem .8rem}
  .modal-title{font-size:.82rem}
  .modal-body{padding:.7rem}
  .modal-row{padding:.35rem 0;gap:.35rem}
  .modal-label{font-size:.6rem;min-width:70px}
  .modal-value{font-size:.7rem}
  /* Auth gate: larger touch targets */
  .auth-input{font-size:.85rem;padding:.7rem .8rem}
  .auth-btn{font-size:.72rem;padding:.65rem}
  .auth-logo{font-size:1.3rem}
  .auth-sub{font-size:.62rem;margin-bottom:1.2rem}
  .auth-remember{font-size:.5rem}
  .auth-err{font-size:.5rem}
}

@media(max-width:480px){
  .header{height:40px;min-height:40px;padding:0 .55rem}
  .header-dot{width:8px;height:8px}
  .header-title{font-size:.75rem}
  .header-right{gap:.5rem}
  .tab-btn{padding:.35rem .55rem;font-size:.6rem;gap:.25rem}
  .hd-scroll{padding:.55rem .5rem}
  .hd-hero{grid-template-columns:1fr 1fr;gap:.35rem}
  .hd-hero-num{font-size:1.15rem}
  .hd-hero-card{padding:.5rem .6rem}
  .hd-hero-label{font-size:.46rem}
  .hd-hero-sub{font-size:.42rem}
  .hd-clients{grid-template-columns:1fr}
  .hd-client-stats{grid-template-columns:repeat(4,1fr);gap:2px .3rem}
  .hd-client-top{gap:.35rem}
  .hd-cols{grid-template-columns:1fr}
  .hd-three-col{grid-template-columns:1fr}
  .hd-agents{grid-template-columns:1fr 1fr;gap:.2rem}
  .ns-wrap{padding:.55rem .6rem;margin-bottom:.65rem}
  .ns-revenue{grid-template-columns:1fr;text-align:center;gap:.35rem}
  .ns-amount-num{font-size:1.2rem}
  .ns-kpis{grid-template-columns:repeat(2,1fr);gap:.3rem}
  .ns-kpi-num{font-size:.85rem}
  .ns-pace-bar{flex-direction:column;align-items:stretch;gap:.25rem}
  .ns-pace-vol{justify-content:center}
  .ns-pace-pills{justify-content:center}
  .pipeline-stages{gap:.2rem}
  .pipeline-stage{flex:0 0 calc(50% - .15rem);padding:.35rem .25rem}
  .pipeline-stage-count{font-size:.95rem}
  .client-summary{grid-template-columns:repeat(2,1fr)}
  .client-summary-card{padding:.4rem}
  .client-summary-val{font-size:.85rem}
  .yt-metrics{grid-template-columns:1fr 1fr;gap:.3rem}
  .metric-cards{grid-template-columns:1fr 1fr;gap:.3rem}
  .metric-card{padding:.5rem}
  .metric-value{font-size:.95rem}
  .tab-scroll{padding:.6rem .5rem}
}
</style>
</head>
<body>

<div class="auth-gate" id="auth-gate">
  <div class="auth-box">
    <div class="auth-logo">Mission Control</div>
    <div class="auth-sub">Dopamine Digital — Enter password to continue</div>
    <form onsubmit="return checkAuth(event)">
      <input class="auth-input" id="auth-pw" type="password" placeholder="Password" autocomplete="current-password" autofocus>
      <button class="auth-btn" type="submit">Unlock</button>
    </form>
    <div class="auth-err" id="auth-err"></div>
    <label class="auth-remember"><input type="checkbox" id="auth-remember" checked> Remember for 7 days</label>
  </div>
</div>

<div id="app-wrap" style="display:none;contents:all">
<header class="header">
  <div class="header-left">
    <span class="header-dot"></span>
    <span class="header-title">MISSION CONTROL</span>
    <span class="header-badge">Dopamine Digital</span>
  </div>
  <div class="header-right">
    <div style="text-align:right">
      <div class="clock" id="clock">--:--:--</div>
      <div class="clock-date" id="clock-date">---</div>
    </div>
    <span class="sync-badge" id="sync-badge" style="font-size:.62rem;color:var(--text-muted);display:none">Synced: <span id="sync-time">—</span></span>
    <div class="sc-wrap" id="sc-wrap" onclick="toggleShowcase()" title="Showcase mode — fake data for filming"><span class="sc-label">SHOWCASE</span><div class="sc-track"></div></div>
    <span class="online-badge"><span class="online-dot"></span>ONLINE</span>
  </div>
</header>

<div class="tab-bar">
  <button class="tab-btn active" data-tab="home">🏠 Home</button>
  <button class="tab-btn" data-tab="agents">🤖 AI Agents</button>
  <button class="tab-btn" data-tab="dd">📊 DD Pipeline</button>
  <button class="tab-btn" data-tab="clients">📋 Clients</button>
  <button class="tab-btn" data-tab="youtube">🎬 YouTube</button>
  <button class="tab-btn" data-tab="team">👥 Team</button>
</div>

<div class="modal-overlay" id="modal-overlay">
  <div class="modal">
    <div class="modal-header">
      <span class="modal-title" id="modal-title">Details</span>
      <button class="modal-close" id="modal-close">&times;</button>
    </div>
    <div class="modal-body" id="modal-body"></div>
  </div>
</div>
<div class="yt-toast" id="yt-toast"></div>

<!-- TAB 0: HOME DASHBOARD -->
<div id="tab-home" class="tab-content active">
  <div class="hd-scroll">
    <div id="home-content"></div>
  </div>
</div>

<!-- TAB 1: AI AGENTS (Full Mission Control) -->
<div id="tab-agents" class="tab-content">
  <div class="mc-layout">
    <aside class="sidebar-left">
      <div class="sidebar-header"><span class="sidebar-title">Agents</span><span class="sidebar-count">13</span></div>
      <div class="agent-list" id="agent-list"></div>
      <div class="build-section" id="build-section"></div>
    </aside>
    <div class="kanban-area">
      <div class="kanban-header"><span class="kanban-dot"></span><span class="kanban-title">Mission Queue</span></div>
      <div class="kanban-board" id="kanban-board"></div>
    </div>
    <aside class="sidebar-right">
      <div class="feed-header">
        <div class="feed-title">Live Feed</div>
        <div class="feed-tabs" id="feed-tabs">
          <button class="feed-tab active" data-filter="all">All</button>
          <button class="feed-tab" data-filter="tasks">Tasks</button>
          <button class="feed-tab" data-filter="status">Status</button>
        </div>
      </div>
      <div class="feed-agent-chips" id="agent-chips"></div>
      <div class="activity-list" id="activity-feed"></div>
      <div class="health-section">
        <div class="health-title">System Health</div>
        <div class="health-grid" id="health-list"></div>
      </div>
    </aside>
  </div>
</div>

<!-- TAB 2: DD PIPELINE -->
<div id="tab-dd" class="tab-content"><div class="tab-scroll" id="dd-content"></div></div>

<!-- TAB 3: CLIENT PIPELINE -->
<div id="tab-clients" class="tab-content"><div class="tab-scroll" id="clients-content"></div></div>

<!-- TAB 4: YOUTUBE CONTENT -->
<div id="tab-youtube" class="tab-content"><div class="tab-scroll" id="youtube-content"></div></div>

<!-- TAB 5: TEAM OPERATIONS -->
<div id="tab-team" class="tab-content"><div class="tab-scroll" id="team-content"></div></div>

<script>
// ═══════════════════════════════════
// DATA
// ═══════════════════════════════════

const agents=[
  {id:'cooper',name:'Cooper',role:'Squad Lead',type:'lead',typeFull:'Lead — Orchestrates all agents',buildStatus:'live',emoji:'🐱',color:'#e05d2a',schedule:'5:00 AM daily',file:'cooper-SOUL.md',desc:'Overnight orchestration agent. Runs at 5 AM Bangkok, coordinates all other agents, builds content calendars, reviews fleet health, and posts morning priorities.'},
  {id:'radar',name:'Radar',role:'Research & Intel',type:'spc',typeFull:'Specialist — Domain expertise',buildStatus:'live',emoji:'📡',color:'#5c6bc0',schedule:'6:00 AM daily',file:'radar-SOUL.md',desc:'Daily research agent. Scans X/Twitter, Reddit, HN for B2B marketing trends. Delivers intel brief with video ideas and positioning angles.'},
  {id:'keenan',name:'Keenan',role:'Sales Coach',type:'spc',typeFull:'Specialist — Domain expertise',buildStatus:'live',emoji:'🎯',color:'#8d6e63',schedule:'On-demand',file:'keenan-SOUL.md',desc:'Sales call auditor. Analyzes calls against Gap Selling, SPIN, Challenger, and MEDDPICC frameworks. Produces Slack summary + detailed Google Doc audit.'},
  {id:'forge',name:'Forge',role:'Agent Auditor',type:'spc',typeFull:'Specialist — Domain expertise',buildStatus:'built',emoji:'🔨',color:'#ff8a65',schedule:'4:00 AM daily',file:'forge-SOUL.md',desc:'Fleet quality agent. Audits all SOUL files for completeness, consistency, guardrail coverage, and scoring accuracy.'},
  {id:'dash',name:'Dash',role:'Speed-to-Lead',type:'int',typeFull:'Integrator — Connects systems',buildStatus:'built',emoji:'⚡',color:'#26a69a',schedule:'Every 30 min',file:'dash-SOUL.md',desc:'Lead response monitor. Checks Instantly, HeyReach, YouTube, Gmail, ClickUp every 30 min. Ensures no hot lead waits.'},
  {id:'scout',name:'Scout',role:'Lead Enrichment',type:'spc',typeFull:'Specialist — Domain expertise',buildStatus:'built',emoji:'🧭',color:'#2d9f4e',schedule:'6:00 AM daily',file:'scout-SOUL.md',desc:'Morning lead processor. Enriches, scores, deduplicates, and routes leads from all sources.'},
  {id:'sherlock',name:'Sherlock',role:'Deep Research',type:'spc',typeFull:'Specialist — Domain expertise',buildStatus:'built',emoji:'🔎',color:'#7c5cbf',schedule:'On-demand',file:'sherlock-SOUL.md',desc:'On-demand investigator. Lead deep-dives, company intel, market scans, competitive analysis, due diligence.'},
  {id:'echo',name:'Echo',role:'Content Engine',type:'spc',typeFull:'Specialist — Domain expertise',buildStatus:'built',emoji:'📣',color:'#9ccc65',schedule:'7:00 AM daily',file:'echo-SOUL.md',desc:'Content draft agent. YouTube scripts, LinkedIn posts, tweet threads, email content from Radar intel.'},
  {id:'sentinel',name:'Sentinel',role:'Client Health',type:'int',typeFull:'Integrator — Connects systems',buildStatus:'built',emoji:'🛡',color:'#ef5350',schedule:'7:30 AM daily',file:'sentinel-SOUL.md',desc:'Client health monitor. Tracks 6 dimensions per client. Green/Yellow/Red scoring.'},
  {id:'pulse',name:'Pulse',role:'Morning Briefing',type:'int',typeFull:'Integrator — Connects systems',buildStatus:'built',emoji:'📊',color:'#3b7dd8',schedule:'8:00 AM daily',file:'pulse-SOUL.md',desc:'Compiles single Telegram summary from all agents so Jordan knows what to do first.'},
  {id:'scribe',name:'Scribe',role:'Call Summaries',type:'int',typeFull:'Integrator — Connects systems',buildStatus:'built',emoji:'📝',color:'#26c6da',schedule:'On-demand',file:'scribe-SOUL.md',desc:'Call processing agent. Fathom transcripts → Slack summary + full brief + ClickUp action items.'},
  {id:'harbor',name:'Harbor',role:'Client Onboarding',type:'spc',typeFull:'Specialist — Domain expertise',buildStatus:'built',emoji:'⚓',color:'#7e57c2',schedule:'On-demand',file:'harbor-SOUL.md',desc:'Onboarding package builder. ClickUp workspace, ICP research, podcast questions, Dream 200, campaign architecture.'},
  {id:'maverick',name:'Maverick',role:'Campaign Mgmt',type:'int',typeFull:'Integrator — Connects systems',buildStatus:'built',emoji:'🚀',color:'#e05d2a',schedule:'On-demand',file:'maverick-SOUL.md',desc:'Campaign optimizer. Analyzes Instantly + HeyReach metrics. A/B tests and optimizations with rollback plans.'},
];

let systems=[
  {name:'SDR Inbox',status:'ok',detail:'Checking replies every 5 min'},
  {name:'YouTube n8n',status:'ok',detail:'36-node workflow active'},
  {name:'Mac Mini',status:'ok',detail:'All crons running'},
  {name:'ClickUp API',status:'ok',detail:'Connected'},
  {name:'Instantly',status:'ok',detail:'5 client accounts'},
  {name:'HeyReach',status:'ok',detail:'LinkedIn active'},
];

const northStar={
  currentMRR:18000,goalMRR:100000,avgClientMRR:4000,currentClients:5,closeRate:0.20,monthsToGoal:5,
  weekLabel:'Feb 3\u20139',weekDay:3,workDays:5,
  funnel:{sent:486,replies:45,interested:1,calls:3,closed:0},
  sources:{youtube:3,coldEmail:1,podcast:1,referral:0},
  kpis:[
    {label:'Emails Sent',num:1250,actual:486,unit:'/week',result:'2% reply \u00B7 ~10 meetings/mo',color:'var(--blue)'},
    {label:'LinkedIn',num:300,actual:0,unit:'/week',result:'15% accept \u00B7 ~6 meetings/mo',color:'var(--purple)'},
    {label:'YouTube Videos',num:7,actual:2,unit:'/week',result:'~3 leads/video \u00B7 compounds',color:'var(--red)'},
    {label:'Podcast Invites',num:30,actual:0,unit:'/week',result:'25% book \u00B7 ~2 meetings/mo',color:'var(--amber)'},
    {label:'Sales Calls',num:5,actual:3,unit:'/week',result:'20% close \u00B7 ~4 clients/mo',color:'var(--green)'},
    {label:'New Clients',num:1,actual:0,unit:'/week',result:'+$4K MRR each \u00B7 $100K in ~5mo',color:'var(--accent)'},
  ]
};

const kanbanColumns=[
  {id:'inbox',title:'Inbox',color:'#9b9990',cards:[
    {id:'k1',agent:'forge',title:'Fleet audit — all 13 agents',desc:'Forge needs deployment to run first fleet-wide SOUL audit.',insight:'10 agents have SOULs but no cron schedule yet. Priority: Dash (speed-to-lead) and Sentinel (client health) should deploy first.',time:'Pending',details:'Forge audits all 13 SOUL files for completeness, consistency, and guardrail coverage. Blocked until deployed to Mac Mini cron.'},
    {id:'k2',agent:'dash',title:'Configure monitoring scope',desc:'Define which channels Dash monitors — start with DD internal only.',insight:'YouTube leads currently take ~4 min end-to-end. Dash could cut to <60s by monitoring #youtube-leads directly.',time:'Pending',details:'Dash needs configuration before deployment. Start with DD internal Slack + ClickUp only. Client inboxes added after testing.'},
    {id:'k3',agent:'maverick',title:'Campaign baseline report',desc:'Pull current Instantly + HeyReach metrics as baseline.',insight:'5 client Instantly accounts active. No automated reporting exists — Angela pulls manually each week.',time:'Pending',details:'Maverick needs a baseline snapshot of all active campaigns before producing optimization reports.'},
  ]},
  {id:'assigned',title:'Assigned',color:'#3b7dd8',cards:[
    {id:'k4',agent:'scout',title:'Deploy enrichment pipeline',desc:'Connect Scout to Clay/Apollo cached data and Instantly lead lists.',insight:'DD Sales Pipeline has 61 leads across 7 stages. Scout would auto-enrich new entries and flag duplicates.',time:'Next up',details:'Scout needs API connections to Clay, Apollo, Instantly, HeyReach, MillionVerifier, and ClickUp client lists.'},
    {id:'k10',agent:'sentinel',title:'Client health scoring setup',desc:'Configure 6-dimension health check for all 5 active clients.',insight:'ODF contract expired Jan 1. Ocon expired Jan 21. Both still active but need renewal conversations.',time:'Next up',details:'Sentinel tracks: delivery cadence, reply rates, call volume, contract timeline, at-risk signals, satisfaction signals.'},
  ]},
  {id:'in-progress',title:'In Progress',color:'#e05d2a',cards:[
    {id:'k5',agent:'cooper',title:'Daily orchestration — active',desc:'Runs at 5 AM Bangkok. Coordinating Radar + task reminders.',insight:'Cooper triggers 6 daily automations: task reminders (9/10/3 PM), Hubstaff report (1 AM), YouTube monitor (every 2 min), Radar (6 AM).',time:'Daily 5:00 AM',tags:[{label:'LIVE',bg:'#ecf8ef',color:'#2d9f4e'}],details:'Cooper is live. Coordinates Radar, Hubstaff, task reminders, YouTube lead monitor.'},
    {id:'k6',agent:'keenan',title:'Sales coaching — Durell audit pending',desc:'Quick summary + full audit pipeline live. Button clicks work via webhook server.',insight:'Last audit: Kevin Clarity Call scored 42/120 (Critical). Durell Patrick call today classified as team_meeting — may need reclassification for sales audit.',time:'On-demand',tags:[{label:'LIVE',bg:'#ecf8ef',color:'#2d9f4e'}],details:'Keenan posts to #sales-coach-keenan. Quick analysis (~1K tokens) + full 5-framework audit (8K tokens). Webhook server on port 8766.'},
    {id:'k11',agent:'radar',title:'Morning intel — delivered today',desc:'Scanned X/Twitter, Reddit, HN. Top trend: AI agent orchestration.',insight:'3 video ideas generated, 2 positioning angles. Radar has run 5 consecutive days without errors.',time:'Ran 6:00 AM',tags:[{label:'LIVE',bg:'#ecf8ef',color:'#2d9f4e'}],details:'Radar ran at 6:00 AM Bangkok. 3 video ideas, 2 positioning angles. Filed to shared workspace.'},
  ]},
  {id:'review',title:'Review',color:'#7c5cbf',cards:[
    {id:'k7',agent:'cooper',title:'All 13 SOUL files — review fleet',desc:'Every agent has a SOUL. Review before deployment.',insight:'3 LIVE (Cooper, Radar, Keenan), 10 SOUL-built. Next deploy candidates: Dash, Sentinel, Forge.',time:'Today',details:'All 13 agent SOUL files built Feb 5, 2026. 3 LIVE, 10 SOUL-built awaiting deployment.'},
    {id:'k12',agent:'scribe',title:'Fathom call processing — review output',desc:'Scribe processes Fathom calls to #jordan-meeting-tasks with AI summaries.',insight:'739 total calls in state file. Durell Patrick processed today — 3 action items, high priority. Channel fixed from #meeting-notes to #jordan-meeting-tasks.',time:'Today',details:'Scribe (fathom_call_intelligence.py) runs via cron at 2 PM + 10 PM Bangkok. Fixed: ANTHROPIC_API_KEY export, Slack channel access.'},
  ]},
  {id:'done',title:'Done',color:'#2d9f4e',cards:[
    {id:'k8',agent:'cooper',title:'Built 13/13 SOUL files',desc:'Complete OpenClaw agent fleet designed and documented.',insight:'Agent types: 3 Leads, 5 Specialists, 5 Integrators. All SOULs follow standardized format with guardrails.',time:'Today',details:'LIVE: Cooper, Radar, Keenan. SOUL Built: Forge, Dash, Scout, Sherlock, Echo, Sentinel, Pulse, Scribe, Harbor, Maverick.'},
    {id:'k9',agent:'keenan',title:'Full audit pipeline — tested & working',desc:'5-framework analysis: Gap Selling, SPIN, Challenger, MEDDPICC, Chris Voss.',insight:'Kevin Clarity Call: 42/120 Critical. Webhook server + Cloudflare tunnel running. Slack buttons route through port 8766.',time:'Tested',details:'--full-audit CLI tested. Webhook server handles Slack interactivity. Non-Keenan actions forwarded to n8n.'},
  ]},
];

let activityLog=[
  {agent:'cooper',action:'completed',task:'soul_fleet_build',time:'Just now',hasResult:true,detail:'All 13 SOUL files built. Cooper, Radar, Keenan are LIVE. 10 agents SOUL-built awaiting deployment.'},
  {agent:'cooper',action:'completed',task:'mission_control_v4',time:'10 min ago',hasResult:true,detail:'Mission Control dashboard rebuilt with full interactivity, tab filtering, and build progress.'},
  {agent:'radar',action:'completed',task:'morning_intel',time:'6:05 AM',hasResult:true,detail:'Scanned X/Twitter, Reddit, HN. Top trend: multi-agent AI orchestration. 3 video ideas, 2 positioning angles.'},
  {agent:'cooper',action:'logged:',task:'content_calendar',time:'5:03 AM',hasResult:false,detail:'February 2026 content calendar built from Radar research. 12 video ideas mapped to weeks.'},
  {agent:'cooper',action:'logged:',task:'fleet_coordination',time:'5:00 AM',hasResult:false,detail:'Morning orchestration started. Triggered Radar at 6 AM. Keenan on standby.'},
  {agent:'keenan',action:'logged:',task:'standby',time:'On-demand',hasResult:false,detail:'Sales coaching agent on standby. Awaiting call recording for audit.'},
  {agent:'cooper',action:'logged:',task:'hubstaff_daily',time:'1:00 AM',hasResult:false,detail:'Hubstaff tracking report posted to #team-logs. Angela 7.2h (89%), Filip 6.8h (82%), Sophia 5.1h (91%).'},
];

const STATUS_COLORS={
  'upcoming podcasts':'var(--green)','post podcast':'var(--accent)','upcoming pre-calls':'var(--blue)',
  'to reschedule':'var(--amber)','revisit later':'var(--gray)','discovery':'var(--purple)',
  'don\'t pursue':'var(--red)','linkedin reach outs':'var(--blue)','in negotiation':'var(--amber)',
  'signed deal':'var(--green)','podcasts today':'var(--green)','call requests':'var(--blue)','unorganised':'var(--gray)',
  'contacted':'var(--blue)','warm':'var(--amber)','responded':'var(--green)','not interested':'var(--red)',
  'video sent':'var(--blue)','video request':'var(--purple)'
};
let clientData=[
  {id:'jamie',name:'Jamie — Unstuck',shortName:'Jamie',color:'#e05d2a',initials:'JU',source:'youtube',
    pipeline:{target:300000,currency:'$'},calls:{target:40},
    contract:{days:194,start:'2025-11-06'},
    contact:'Jamie Schneiderman — jamie@unstuckyourbusiness.com',
    business:'Growth consulting for venture-backed founders',
    clickup:{spaceId:'90188537777',podcastListId:'901813911117'},
    slack:{channel:'#client-jamie-schneiderman',channelId:'C09S30RPBNC',team:'#team-jamie-schneiderman',teamId:'C09R29F0A11'},
    services:'Podcast Lead Gen, Sales Coaching',
    alerts:[],
    podcastStages:{'post podcast':2,'upcoming podcasts':2,'to reschedule':3,'revisit later':3,'discovery':1,'linkedin reach outs':1,'don\'t pursue':1},
    guests:[
      {name:'Will Meinhardt — Mach 1',status:'post podcast',url:'https://app.clickup.com/t/86ewgpwhd'},
      {name:'Robb Miller — IndyKite',status:'post podcast',url:'https://app.clickup.com/t/86ewgpwhd'},
      {name:'Greg Perotto — Poggio',status:'upcoming podcasts',url:'https://app.clickup.com/t/86ewgpwhd'},
      {name:'Dipti Srivastava — ZeeHu',status:'upcoming podcasts',url:'https://app.clickup.com/t/86ewgpwhd'},
      {name:'Julia Psitos — Fabrik',status:'revisit later',url:'https://app.clickup.com/t/86ewgpwhd'},
      {name:'Jake Anderson — Tor',status:'to reschedule',url:'https://app.clickup.com/t/86ewgpwhd'},
      {name:'Elad Levy — Dive',status:'revisit later',url:'https://app.clickup.com/t/86ewgpwhd'},
      {name:'Anton Prenneis',status:'to reschedule',url:'https://app.clickup.com/t/86ewgpwhd'},
      {name:'Mike Roberts — RivalFlow',status:'revisit later',url:'https://app.clickup.com/t/86ewgpwhd'},
      {name:'Kevin Kissi — Zof AI',status:'to reschedule',url:'https://app.clickup.com/t/86ewgpwhd'},
      {name:'Akshay Madhani — Scrollmark',status:'discovery',url:'https://app.clickup.com/t/86ewgpwhd'},
      {name:'Jed Morris — SVH Capital',status:'linkedin reach outs',url:'https://app.clickup.com/t/86ewgpwhd'},
      {name:'James DeCesare — HyperSphere',status:'don\'t pursue',url:'https://app.clickup.com/t/86ewgpwhd'},
    ]},
  {id:'phellos',name:'Phellos (Leo)',shortName:'Phellos',color:'#5c6bc0',initials:'PH',source:'youtube',
    pipeline:{target:300000,currency:'£'},calls:{target:40},
    contract:{days:194,start:'2025-10-28'},
    contact:'Leo Kuyumciyan — leo@phellosconsultancy.co.uk',
    business:'Finance consultancy for tech startups — investor due diligence',
    clickup:{spaceId:'90188531148',podcastListId:'901813906092'},
    slack:{channel:'#client-phellos',channelId:'C09P9B81JAG',team:'#team-phellos',teamId:'C09NZCKBQ1H'},
    services:'Podcast Lead Gen',
    alerts:[],
    podcastStages:{'upcoming podcasts':4,'post podcast':2,'upcoming pre-calls':2,'to reschedule':6,'revisit later':4,'don\'t pursue':6},
    guests:[
      {name:'Marcel Fowler — New Motion Labs',status:'upcoming podcasts',url:'https://app.clickup.com/t/86ewfyznq'},
      {name:'Bechara Saab — Mobio Interactive',status:'upcoming podcasts',url:'https://app.clickup.com/t/86ewfut1m'},
      {name:'Zaré Baghdasarian — AMBERD AI',status:'upcoming podcasts',url:'https://app.clickup.com/t/86ewaenwu'},
      {name:'Mike Lambert — CoreStory',status:'upcoming podcasts',url:'https://app.clickup.com/t/86ewaee4k'},
      {name:'Shyam Sreenivasan — Quantel Asset Mgmt',status:'upcoming pre-calls',url:'https://app.clickup.com/t/86ewfurtx'},
      {name:'Walt Gall — Eminence Grey',status:'upcoming pre-calls',url:'https://app.clickup.com/t/86ew658w6'},
      {name:'Greg Scown — TextExpander',status:'post podcast',url:'https://app.clickup.com/t/86ew6ndtt'},
      {name:'Pete O\'Dell — Swan Island Networks',status:'post podcast',url:'https://app.clickup.com/t/86ew65amg'},
      {name:'John O\'Connell — Cryptoworth',status:'to reschedule',url:'https://app.clickup.com/t/86ew7d1yy'},
      {name:'Steve Wilson — Exabeam',status:'to reschedule',url:'https://app.clickup.com/t/86ew6zu1j'},
      {name:'Nicole Connors — Decision Logic',status:'to reschedule',url:'https://app.clickup.com/t/86ew64p6p'},
      {name:'William Locker — Storilly',status:'to reschedule',url:'https://app.clickup.com/t/86ew4pgz5'},
      {name:'Thomas Ho — Thomas Ho Company Ltd',status:'to reschedule',url:'https://app.clickup.com/t/86evtxa1y'},
      {name:'Andre Ureña — Fiado',status:'to reschedule',url:'https://app.clickup.com/t/86evtt7gw'},
      {name:'David Levy — Makora',status:'revisit later',url:'https://app.clickup.com/t/86ewc9j5v'},
      {name:'Rhys Ryan — Ekkobar',status:'revisit later',url:'https://app.clickup.com/t/86ew93unj'},
      {name:'Will Simpson — Spark',status:'revisit later',url:'https://app.clickup.com/t/86ew48zpb'},
      {name:'Allen Thornton — TruthScan',status:'revisit later',url:'https://app.clickup.com/t/86evyve86'},
      {name:'Nikhil Nainwani — Inboxkit',status:'don\'t pursue',url:'https://app.clickup.com/t/86ewfurxx'},
      {name:'Tom Vroemen — TETMET',status:'don\'t pursue',url:'https://app.clickup.com/t/86ew8uur1'},
      {name:'Michael Fauscette — Arion Research',status:'don\'t pursue',url:'https://app.clickup.com/t/86ew6nhk8'},
      {name:'Jack Skywalker — Massed Compute',status:'don\'t pursue',url:'https://app.clickup.com/t/86ew64uhg'},
      {name:'Marc Glasser — Ro& by Armatec',status:'don\'t pursue',url:'https://app.clickup.com/t/86ew3r3xw'},
      {name:'Allen Kopelman — Nationwide Payment Systems',status:'don\'t pursue',url:'https://app.clickup.com/t/86evt0f9r'},
    ]},
  {id:'odf',name:'ODF (Daniel)',shortName:'ODF',color:'#2d9f4e',initials:'OD',source:'referral',
    pipeline:{target:150000,currency:'$'},calls:{target:20},
    contract:{days:104,start:'2025-10-03'},
    contact:'Daniel Lindsey — daniel@ondemandfulfillment.com',
    business:'Done-for-you supplement fulfillment — FDA/GMP backend',
    clickup:{spaceId:'90188565944',podcastListId:'901813953534'},
    slack:{channel:'#client-on-demand-fulfillment',channelId:'C09QCBMHU1F',team:'#team-on-demand-fulfillment',teamId:'C09PW18L1A9'},
    services:'Podcast Lead Gen, Dream 200, Partner Engine',
    alerts:['Contract expired Jan 1 — renewal conversation needed'],
    podcastStages:{'upcoming podcasts':12,'post podcast':11,'upcoming pre-calls':1,'to reschedule':5,'revisit later':3,'don\'t pursue':4},
    guests:[
      {name:'Haris Reis — CarpalAID',status:'upcoming podcasts',url:'https://app.clickup.com/t/86ewg9j2h'},
      {name:'Cate Krider — Obsidian Partners',status:'upcoming podcasts',url:'https://app.clickup.com/t/86ewg6711'},
      {name:'Dom Davis — Temerarii Media',status:'upcoming podcasts',url:'https://app.clickup.com/t/86ewg1mfz'},
      {name:'Kate Kerr — Presently',status:'upcoming podcasts',url:'https://app.clickup.com/t/86ewf6qxa'},
      {name:'Mustufa Khan — 4Socials',status:'upcoming podcasts',url:'https://app.clickup.com/t/86ewegh6k'},
      {name:'Troy Kahler — Digital Brand Agent',status:'upcoming podcasts',url:'https://app.clickup.com/t/86ewegh6e'},
      {name:'Rabii Babou — Livano Agency',status:'upcoming podcasts',url:'https://app.clickup.com/t/86ewegh60'},
      {name:'Prajit Dasani — Atrybe Inc.',status:'upcoming podcasts',url:'https://app.clickup.com/t/86ewegh5h'},
      {name:'Mateo Garzon — Spark Digital Marketing',status:'upcoming podcasts',url:'https://app.clickup.com/t/86ewcp7e5'},
      {name:'Yonah Nimmer — Amazon Growth Lab',status:'upcoming podcasts',url:'https://app.clickup.com/t/86ewcnq6t'},
      {name:'Rezin David — DontBlink',status:'upcoming podcasts',url:'https://app.clickup.com/t/86ewcggak'},
      {name:'De Ivett — 5D Spectrum',status:'upcoming podcasts',url:'https://app.clickup.com/t/86ewc7q3v'},
      {name:'Mandy Gartrell — Angry Shrimp Media',status:'upcoming pre-calls',url:'https://app.clickup.com/t/86ewg64at'},
      {name:'Troy Merkle — Thulium',status:'post podcast',url:'https://app.clickup.com/t/86ew9bde6'},
      {name:'Dotty Scott — AskDotty',status:'post podcast',url:'https://app.clickup.com/t/86ew9aqbq'},
      {name:'Brady Lowe — TASTENETWORK',status:'post podcast',url:'https://app.clickup.com/t/86ew9anyz'},
      {name:'Amy Heir — Overstood.co',status:'post podcast',url:'https://app.clickup.com/t/86ew8va6g'},
      {name:'Jordan Narducci — DTCPG',status:'post podcast',url:'https://app.clickup.com/t/86ew7d93j'},
      {name:'Samuel Davel — Rubix Agency',status:'post podcast',url:'https://app.clickup.com/t/86ew77zby'},
      {name:'John Graham Harper — Lumaflex',status:'post podcast',url:'https://app.clickup.com/t/86ew6y9y4'},
      {name:'Brandon Sherwood — Gladly Network',status:'post podcast',url:'https://app.clickup.com/t/86evwm1xk'},
      {name:'David Lorango — Startup Accelerators',status:'post podcast',url:'https://app.clickup.com/t/86evvvx4q'},
      {name:'Mariah Parsons — Malomo',status:'post podcast',url:'https://app.clickup.com/t/86evvvkmk'},
      {name:'Jesse McFarland — SpearPoint Marketing',status:'post podcast',url:'https://app.clickup.com/t/86evvverq'},
      {name:'New Williams — Trendcend Media',status:'to reschedule',url:'https://app.clickup.com/t/86ewbzdab'},
      {name:'Kevin Roy — GreenBananaSEO',status:'to reschedule',url:'https://app.clickup.com/t/86ewbyh10'},
      {name:'Syed Mahad Hussain — 514 Digital',status:'to reschedule',url:'https://app.clickup.com/t/86evwrkdd'},
      {name:'David Bonthrone — Mr. Foster Consulting',status:'to reschedule',url:'https://app.clickup.com/t/86evwdtkx'},
      {name:'Alice Galperin — Sales Bagel Company',status:'to reschedule',url:'https://app.clickup.com/t/86evv693t'},
      {name:'David Pasqualone',status:'revisit later',url:'https://app.clickup.com/t/86ewcpdjw'},
      {name:'Patrick Tuure — Caregiver Cloud Services',status:'revisit later',url:'https://app.clickup.com/t/86ewaxr7f'},
      {name:'Bill Stump — Well Made Creative',status:'revisit later',url:'https://app.clickup.com/t/86evvvhdd'},
      {name:'Jason Hunt — Merged Media',status:'don\'t pursue',url:'https://app.clickup.com/t/86ewegh5k'},
      {name:'Lisa Bowman — MarketingMojo',status:'don\'t pursue',url:'https://app.clickup.com/t/86ew9w09h'},
      {name:'Joshua Maddux — 95Visual',status:'don\'t pursue',url:'https://app.clickup.com/t/86ew759ym'},
      {name:'Megan Shinney — Wallis Gray Marketing',status:'don\'t pursue',url:'https://app.clickup.com/t/86evwt182'},
    ]},
  {id:'ocon',name:'Ocon Chemicals (Kevin)',shortName:'Ocon',color:'#7c5cbf',initials:'OC',source:'youtube',
    pipeline:{target:150000,currency:'€'},calls:{target:null},
    contract:{days:104,start:'2025-10-23'},
    contact:'Kevin — kevin@oconchemicals.com',
    business:'Lab consumables distributor — ScanStation 300 automated colony counting',
    clickup:{spaceId:'90188565970',linkedinListId:'901813954836',emailListId:'901815303138'},
    slack:{channel:'#client-ocon-chemicals',channelId:'C09P5GC1823',team:'#team-ocon-chemicals',teamId:'C09PZT59589'},
    services:'Podcast Lead Gen, Outbound Engine',
    alerts:['Contract expired Jan 21 — renewal conversation needed'],
    podcastStages:{},
    outboundStages:{'video sent':24,'video request':2,'signed deal':1,'don\'t pursue':2},
    guests:[
      {name:'Kieran Daly — Glenilen Farm',status:'signed deal',url:'https://app.clickup.com/t/86evygmrv'},
      {name:'Faisal Usman — Guerbet',status:'video request',url:'https://app.clickup.com/t/86ewggbhw'},
      {name:'Dr. Muhammad Asif — Griffith College Cork',status:'video request',url:'https://app.clickup.com/t/86ewggbhd'},
      {name:'aoife de barra — Eurofins Environment Testing',status:'video sent',url:'https://app.clickup.com/t/86ewg25tt'},
      {name:'Rajan Choudhary — University College Dublin',status:'video sent',url:'https://app.clickup.com/t/86ewg252b'},
      {name:'Anthony McLaughlin — Radon Aware Group',status:'video sent',url:'https://app.clickup.com/t/86ewg221q'},
      {name:'Nadjib Otmani — RCSI',status:'video sent',url:'https://app.clickup.com/t/86ewf9chm'},
      {name:'Conor Davis — Sustainable Lab Solutions',status:'video sent',url:'https://app.clickup.com/t/86ewdz9mu'},
      {name:'Meet Rathod — Eurofins BioPharma',status:'video sent',url:'https://app.clickup.com/t/86ewdz9m4'},
      {name:'Maryna Oliinyk — SGS',status:'video sent',url:'https://app.clickup.com/t/86ewdyfj0'},
      {name:'Mohammed Khan — GE Vernova',status:'video sent',url:'https://app.clickup.com/t/86ewdacwx'},
      {name:'Sammy Sieber — Verdé Environmental',status:'video sent',url:'https://app.clickup.com/t/86ewcgtnp'},
      {name:'Homayoun Safarpour — XTREME Living Lab',status:'video sent',url:'https://app.clickup.com/t/86ewcgf8q'},
      {name:'Shane O\'Regan — Cully',status:'video sent',url:'https://app.clickup.com/t/86ewcgbxy'},
      {name:'Elzbieta Krupa — Eli Lilly',status:'video sent',url:'https://app.clickup.com/t/86ewcfcvm'},
      {name:'Noel Murphy — BioMarin',status:'video sent',url:'https://app.clickup.com/t/86ewcf403'},
      {name:'Markos Paschalis — ABP Ireland',status:'video sent',url:'https://app.clickup.com/t/86ewceypc'},
      {name:'Donna Louise Gray — Axis Bioservices',status:'video sent',url:'https://app.clickup.com/t/86ewcen4a'},
      {name:'João Frias — Marine & Freshwater Research',status:'video sent',url:'https://app.clickup.com/t/86ew9zv9u'},
      {name:'Cian McNulty-Casey — MSD Ireland',status:'video sent',url:'https://app.clickup.com/t/86ew9ywrz'},
      {name:'Peter Flanagan — Health Service Executive',status:'video sent',url:'https://app.clickup.com/t/86ew9abgu'},
      {name:'Olalekan Alabi — Geotechnical & Soil Testing',status:'video sent',url:'https://app.clickup.com/t/86ew8wrbe'},
      {name:'Erik Abbà — Stryker',status:'video sent',url:'https://app.clickup.com/t/86ew8wmpc'},
      {name:'Aisling Speers — Clinty Laboratories',status:'video sent',url:'https://app.clickup.com/t/86ew818g3'},
      {name:'Girivasan Egambaram — Irish Metal Finishing',status:'video sent',url:'https://app.clickup.com/t/86evyea1h'},
      {name:'Luiz Rodrigues — The Culinary Food Group',status:'video sent',url:'https://app.clickup.com/t/86evw8rbp'},
      {name:'Darren Donohoe — Krispy Kreme UK & IRE',status:'video sent',url:'https://app.clickup.com/t/86ew8t3bx'},
      {name:'Daisy Arrey — ISS Facility Services',status:'don\'t pursue',url:'https://app.clickup.com/t/86ewg23ze'},
      {name:'Seamus Enright — Kerry Group',status:'don\'t pursue',url:'https://app.clickup.com/t/86evye796'},
    ]},
  {id:'ripple',name:'Ripple (Adrian)',shortName:'Ripple',color:'#26a69a',initials:'RP',source:'coldEmail',
    pipeline:{target:null,currency:'$'},calls:{target:null},
    contract:{days:null,start:null},
    contact:'Adrian Smith',
    business:'Supply chain/logistics compliance platform',
    clickup:{spaceId:'90184899675',podcastListId:'901808543769'},
    slack:{channel:'#client-ripple',channelId:'C08RT8RUG73',team:'#team-ripple',teamId:'C08TEGFGQ04'},
    services:'Podcasts, Sales Analysis',
    alerts:[],
    podcastStages:{'upcoming podcasts':6,'post podcast':8,'podcasts today':2,'upcoming pre-calls':1,'discovery':13,'in negotiation':10,'signed deal':3,'to reschedule':19,'revisit later':15,'don\'t pursue':21,'call requests':1,'unorganised':1},
    guests:[
      {name:'Daman Grewal — BC Trucking Association',status:'podcasts today',url:'https://app.clickup.com/t/86evr7dtq'},
      {name:'Stacey Scher — VAULTRA SELF-STORAGE',status:'podcasts today',url:'https://app.clickup.com/t/86evr7d39'},
      {name:'Robert Peluso — North Coast Logistics',status:'upcoming podcasts',url:'https://app.clickup.com/t/86evj0x6x'},
      {name:'Phil Waterhouse — APCL Group',status:'upcoming podcasts',url:'https://app.clickup.com/t/86ev9uqxq'},
      {name:'Wiley Strahan — A.P. Moller - Maersk',status:'upcoming podcasts',url:'https://app.clickup.com/t/86ev0au56'},
      {name:'Ray Owens — ShipSage',status:'upcoming podcasts',url:'https://app.clickup.com/t/86eunee71'},
      {name:'Casey Jenkins — Radial Inc.',status:'upcoming podcasts',url:'https://app.clickup.com/t/86euy485c'},
      {name:'Matthew Hertz — Third Person',status:'upcoming podcasts',url:'https://app.clickup.com/t/86eue1ydy'},
      {name:'Oscar Mendez Maldonado — Locus Robotics',status:'upcoming pre-calls',url:'https://app.clickup.com/t/86evjbdp3'},
      {name:'John Murray — CCL Logistics & Technology',status:'post podcast',url:'https://app.clickup.com/t/86ev8v95n'},
      {name:'Paul Haught — Seahorse Express',status:'post podcast',url:'https://app.clickup.com/t/86ev5gu36'},
      {name:'Christopher Hinz — Red Wolf Global Logistics',status:'post podcast',url:'https://app.clickup.com/t/86ev50m1f'},
      {name:'Rohan Shah — Conduit Commerce',status:'post podcast',url:'https://app.clickup.com/t/86ev3keju'},
      {name:'Charles Gittens — Seafarers House',status:'post podcast',url:'https://app.clickup.com/t/86ev2nud9'},
      {name:'Joshua Galbraith — Unishippers',status:'post podcast',url:'https://app.clickup.com/t/86euvvdcg'},
      {name:'Dustin Kennon — Terra Drive Systems',status:'post podcast',url:'https://app.clickup.com/t/86eujufqu'},
      {name:'Vache Ourfalian — Jetline Transport',status:'post podcast',url:'https://app.clickup.com/t/86euay9c2'},
      {name:'Nicu Baranga — Caravan Group of Companies',status:'discovery',url:'https://app.clickup.com/t/86evtwpx0'},
      {name:'Stanley Kelman Jr. — Peloton Workforce',status:'discovery',url:'https://app.clickup.com/t/86evkqynf'},
      {name:'Stefan Trifan — FreightSync',status:'discovery',url:'https://app.clickup.com/t/86evj7vuw'},
      {name:'Matthew Crocker — Pegasus Maritime',status:'discovery',url:'https://app.clickup.com/t/86evbu0fw'},
      {name:'Brian Kuramoto — Ease Logistics',status:'discovery',url:'https://app.clickup.com/t/86evbkzq4'},
      {name:'Darren Twiselton — ZigZag Global',status:'discovery',url:'https://app.clickup.com/t/86evb7614'},
      {name:'Michelle Scott — Total Compliance',status:'discovery',url:'https://app.clickup.com/t/86evac1kf'},
      {name:'Vikas Aron — Bricz',status:'discovery',url:'https://app.clickup.com/t/86ev68zdp'},
      {name:'Shravan S — OptInn Solutions',status:'discovery',url:'https://app.clickup.com/t/86ev56jyq'},
      {name:'Gabriel Ponce — Erives Enterprises',status:'discovery',url:'https://app.clickup.com/t/86euyjqag'},
      {name:'Elisa Harmon — Ruan Transportation',status:'discovery',url:'https://app.clickup.com/t/86eupkf4b'},
      {name:'Bill Jackson — Synchrogistics',status:'discovery',url:'https://app.clickup.com/t/86eud2a6c'},
      {name:'Prashant Shah — SwagUp',status:'discovery',url:'https://app.clickup.com/t/86eud2a4g'},
      {name:'Taras Chorniy — RAM International Shipping',status:'in negotiation',url:'https://app.clickup.com/t/86ev5g1vx'},
      {name:'Nebojsa Zivkovic — White City Logistics',status:'in negotiation',url:'https://app.clickup.com/t/86ev3k0zp'},
      {name:'Sten Svendsen — Rulewave',status:'in negotiation',url:'https://app.clickup.com/t/86ev0wkx4'},
      {name:'Russ Felker — MegaCorp Logistics',status:'in negotiation',url:'https://app.clickup.com/t/86eum6r7g'},
      {name:'Michael St. Julien — Circle Logistics',status:'in negotiation',url:'https://app.clickup.com/t/86eum5urg'},
      {name:'Charles Ickes — Bergen Logistics',status:'in negotiation',url:'https://app.clickup.com/t/86euhg3vf'},
      {name:'Kendra Jackson — DELIVER IT',status:'in negotiation',url:'https://app.clickup.com/t/86eugckjw'},
      {name:'Kelsey Hensley — NovEx Supply Chain',status:'in negotiation',url:'https://app.clickup.com/t/86eufvv74'},
      {name:'Paul D. Tonsager — Integrated Multimodal',status:'in negotiation',url:'https://app.clickup.com/t/86eue1y8n'},
      {name:'Gino Carnevale — efRouting',status:'in negotiation',url:'https://app.clickup.com/t/86eu8x6nv'},
      {name:'Janice Wright — JPM Consulting',status:'signed deal',url:'https://app.clickup.com/t/86eugckpk'},
      {name:'Kenny Gouts — Southern States TOYOTAlift',status:'signed deal',url:'https://app.clickup.com/t/86eugcknk'},
      {name:'Mike Shorts — ITC Manufacturing',status:'signed deal',url:'https://app.clickup.com/t/86eud2a3n'},
      {name:'Rupert Upton — 1st Class Logistics UK',status:'call requests',url:'https://app.clickup.com/t/86evfcwcj'},
      {name:'Doug Pilkington — Ryder',status:'to reschedule',url:'https://app.clickup.com/t/86evjb89h'},
      {name:'Cody Howdeshell — Azimuth Maritime',status:'to reschedule',url:'https://app.clickup.com/t/86evfcqct'},
      {name:'Robert Bray — ITS Logistics',status:'to reschedule',url:'https://app.clickup.com/t/86ev56qvf'},
      {name:'Rohit Solanki — Aquaduct Logistics',status:'to reschedule',url:'https://app.clickup.com/t/86ev475z6'},
      {name:'John Ferguson — Pivot Supply Chain',status:'to reschedule',url:'https://app.clickup.com/t/86ev2nvgk'},
      {name:'Aman Tamana — Tamana Truck Lines',status:'to reschedule',url:'https://app.clickup.com/t/86euz80mx'},
      {name:'Joel Thomas — Stratos Jet Charters',status:'to reschedule',url:'https://app.clickup.com/t/86euz80kc'},
      {name:'Travis Wascher — DN Van Lines',status:'to reschedule',url:'https://app.clickup.com/t/86euyuyet'},
      {name:'Mike Bush — Talon Logistics',status:'to reschedule',url:'https://app.clickup.com/t/86euyfnjh'},
      {name:'Gilbert Aspeitia — WFX Logistics',status:'to reschedule',url:'https://app.clickup.com/t/86euup657'},
      {name:'Paul Lorensen — Central Transport',status:'to reschedule',url:'https://app.clickup.com/t/86euqm133'},
      {name:'Rod Imhoff — Chicago Pneumatic',status:'to reschedule',url:'https://app.clickup.com/t/86eupjb0p'},
      {name:'Tom Reiter — queticollc',status:'to reschedule',url:'https://app.clickup.com/t/86eum6rh3'},
      {name:'Jason Smith — Cargomatic',status:'to reschedule',url:'https://app.clickup.com/t/86eum6r6u'},
      {name:'Maria Carolina Diaz — YouFit Gyms',status:'to reschedule',url:'https://app.clickup.com/t/86eum5rth'},
      {name:'Janet Pena Santiago — Can Corporation',status:'to reschedule',url:'https://app.clickup.com/t/86euhgr9u'},
      {name:'Dana Kellerman — OnPoint Group',status:'to reschedule',url:'https://app.clickup.com/t/86euhg3xj'},
      {name:'Sean Arslanian — Pulse Fulfilment',status:'to reschedule',url:'https://app.clickup.com/t/86eudmhh2'},
      {name:'Segah Yildirim — U.S. Moving Protection',status:'to reschedule',url:'https://app.clickup.com/t/86eu8x70f'},
      {name:'Samuel Berman — Logistics Research Center',status:'revisit later',url:'https://app.clickup.com/t/86evcy6a9'},
      {name:'Drew Herpich — Nolan Transportation',status:'revisit later',url:'https://app.clickup.com/t/86euy4ck2'},
      {name:'Zack Perlman — Makt-Trans',status:'revisit later',url:'https://app.clickup.com/t/86euy4bgt'},
      {name:'Michael Duke — DBT Aero',status:'revisit later',url:'https://app.clickup.com/t/86eupja99'},
      {name:'Paige Harper — The Raymond Corporation',status:'revisit later',url:'https://app.clickup.com/t/86eukzq1f'},
      {name:'Jason Reed — Reed\'s Fuel & Trucking',status:'revisit later',url:'https://app.clickup.com/t/86euj3cb0'},
      {name:'Jordan Wareham — Spirit Airlines',status:'revisit later',url:'https://app.clickup.com/t/86eugcn3v'},
      {name:'Dean Vicha — NationaLease',status:'revisit later',url:'https://app.clickup.com/t/86eugckkd'},
      {name:'Julie Van de Kamp — SONAR',status:'revisit later',url:'https://app.clickup.com/t/86eugckbk'},
      {name:'Matthew Spencer — Conectiv Supply Chain',status:'revisit later',url:'https://app.clickup.com/t/86eugck8y'},
      {name:'Stephen Wilson — APEX Companies',status:'revisit later',url:'https://app.clickup.com/t/86eue1y7p'},
      {name:'Ryan Joyce — GenLogs',status:'revisit later',url:'https://app.clickup.com/t/86eudyd48'},
      {name:'Allison Ullrich — Potentiate OS',status:'revisit later',url:'https://app.clickup.com/t/86eub2vz1'},
      {name:'Guy Gillingwater — Surplush',status:'revisit later',url:'https://app.clickup.com/t/86eu8x7kb'},
      {name:'Vijay Kapila — Designed Conveyor Systems',status:'revisit later',url:'https://app.clickup.com/t/86euhg3zk'},
      {name:'Brian Schumacher — Illinois Trucking Assoc',status:'don\'t pursue',url:'https://app.clickup.com/t/86evbkxet'},
      {name:'Clark Alexander — NEXT Trucking',status:'don\'t pursue',url:'https://app.clickup.com/t/86ev33mc1'},
      {name:'Eric Ramirez — Swift Supply Chain',status:'don\'t pursue',url:'https://app.clickup.com/t/86ev2vquq'},
      {name:'Kai Timmermann — Prompt Global',status:'don\'t pursue',url:'https://app.clickup.com/t/86ev0cf75'},
      {name:'Jason Weber — RJW Logistics',status:'don\'t pursue',url:'https://app.clickup.com/t/86euvxr7g'},
      {name:'Travis Krabbenhoft — Denver Intl Airport',status:'don\'t pursue',url:'https://app.clickup.com/t/86eupjabu'},
      {name:'Richard Shure — Vetra Technologies',status:'don\'t pursue',url:'https://app.clickup.com/t/86eupjab3'},
      {name:'Marc Zazeela — APC Postal Logistics',status:'don\'t pursue',url:'https://app.clickup.com/t/86eupja8j'},
      {name:'Capt. Gajanan Karanjikar — Panama Ship Registry',status:'don\'t pursue',url:'https://app.clickup.com/t/86euntdg5'},
      {name:'John Elzy — Coach USA',status:'don\'t pursue',url:'https://app.clickup.com/t/86eum6r5e'},
      {name:'Robert Smith — XOJET Aviation',status:'don\'t pursue',url:'https://app.clickup.com/t/86euhmvwp'},
      {name:'Warren Powell — Optimal Dynamics',status:'don\'t pursue',url:'https://app.clickup.com/t/86euhg7yv'},
      {name:'Jordan Neuman — National Jets',status:'don\'t pursue',url:'https://app.clickup.com/t/86euhg47b'},
      {name:'Naveen Chandra — CSCMP Atlanta',status:'don\'t pursue',url:'https://app.clickup.com/t/86euhg42c'},
      {name:'Doug Downey — ASSP',status:'don\'t pursue',url:'https://app.clickup.com/t/86eugckme'},
      {name:'Tracy Mitchell — Trinity Logistics',status:'don\'t pursue',url:'https://app.clickup.com/t/86eugckkv'},
      {name:'Donovan Sarka — Doepker Industries',status:'don\'t pursue',url:'https://app.clickup.com/t/86eufdwmq'},
      {name:'Randy Bishop — Exiger',status:'don\'t pursue',url:'https://app.clickup.com/t/86eudx2h1'},
      {name:'Codye Satterwhite — Plantensive',status:'don\'t pursue',url:'https://app.clickup.com/t/86eudmmkt'},
      {name:'Justin Huang — J&H Group',status:'don\'t pursue',url:'https://app.clickup.com/t/86eu8wqcb'},
      {name:'Graciela Trillanes — HGmotive',status:'don\'t pursue',url:'https://app.clickup.com/t/86eu8wpp7'},
      {name:'Amia Mize — Takes A Village Transportation',status:'unorganised',url:'https://app.clickup.com/t/86euhr6gm'},
    ]},
];

// Outreach campaign data per client (populated by live data loader)
const clientCampaigns={
  jamie:{
    outreachType:'podcast',
    instantly:null,
    heyreach:null,
    callsBooked:4,pipelineGenerated:60000
  },
  phellos:{
    outreachType:'podcast',
    instantly:null,
    heyreach:null,
    callsBooked:3,pipelineGenerated:45000
  },
  odf:{
    outreachType:'podcast+dream200',
    instantly:null,
    heyreach:null,
    callsBooked:6,pipelineGenerated:90000
  },
  ocon:{
    outreachType:'podcast+outbound',
    instantly:{campaigns:['Ocon Labs Outreach'],totals:{sent:850,openRate:42,replyRate:8.5,positiveRate:3.2}},
    heyreach:{campaigns:['Ocon LinkedIn'],totals:{connected:120,messaged:95,replyRate:12}},
    callsBooked:2,pipelineGenerated:22000
  },
  ripple:{
    outreachType:'podcast',
    instantly:null,
    heyreach:null,
    callsBooked:13,pipelineGenerated:null
  }
};
// DD-level Instantly stats (all DD campaigns combined)
const ddInstantlyOverview={sent:95280,replies:5534,bounced:855,opportunities:1564,oppValue:12869000,interested:593,meetingsBooked:5,activeCampaigns:1};

let ddPipeline={
  stages:[
    {name:'Joey Podcast',count:18,color:'#87909e'},
    {name:'Jordan Podcast',count:12,color:'#5f55ee'},
    {name:'YouTube Lead',count:5,color:'#ff7800'},
    {name:'Warm Lead',count:23,color:'#f9d900'},
    {name:'Strategy Call',count:1,color:'#04a9f4'},
    {name:'Growth Plan',count:2,color:'#a875ff'},
  ],
  sources:[
    {name:'Joey Podcast',count:18,icon:'🎙️',trend:'5 high-priority'},
    {name:'YouTube TypeForm',count:5,icon:'▶️',trend:'1 high-priority (Ashley — iConvert)'},
    {name:'Jordan Podcast',count:12,icon:'🎙️',trend:'4 high-priority'},
    {name:'Other / Warm',count:23,icon:'🔥',trend:'Oldest: Hayk (Insight Genie AI)'},
  ],
  leads:[
    {name:'Durell Patrick',initials:'DP',company:'how2pay4college',source:'YouTube',stage:'Strategy Call',stageColor:'#04a9f4',value:'$15K',days:0,url:'https://app.clickup.com/t/86ewgp71c'},
    {name:'Bryan Mejia',initials:'BM',company:'Horizon Acres Land',source:'YouTube',stage:'Growth Plan',stageColor:'#a875ff',value:'$15K',days:0,url:'https://app.clickup.com/t/86ewgp723'},
    {name:'Dimitris Mougis',initials:'DM',company:'Three Visuals Ltd',source:'YouTube',stage:'Growth Plan',stageColor:'#a875ff',value:'$15K',days:0,url:'https://app.clickup.com/t/86ewgp71m'},
    {name:'Ashley',initials:'AS',company:'iConvert',source:'YouTube',stage:'YouTube Lead',stageColor:'#ff7800',value:'$15K',days:0,url:'https://app.clickup.com/t/86ewgpt43',tags:['high-priority']},
    {name:'Adrian',initials:'AD',company:'FORTBRIDGE',source:'YouTube',stage:'YouTube Lead',stageColor:'#ff7800',value:'—',days:0,url:'https://app.clickup.com/t/86ewgpt55'},
    {name:'Sam Hassell',initials:'SH',company:'Great Minds Advising',source:'YouTube',stage:'YouTube Lead',stageColor:'#ff7800',value:'—',days:0,url:'https://app.clickup.com/t/86ewgpt4v'},
    {name:'Joe Patino',initials:'JP',company:'Installation Business (Houston)',source:'Other',stage:'Warm Lead',stageColor:'#f9d900',value:'$15K',days:0,url:'https://app.clickup.com/t/86ewgp743'},
    {name:'Johnny Maghzal',initials:'JM',company:'Togal.AI',source:'Jordan Podcast',stage:'Jordan Podcast',stageColor:'#5f55ee',value:'—',days:0,url:'https://app.clickup.com/t/86ewgprzj',tags:['high-priority']},
    {name:'Jessica Robertson',initials:'JR',company:'Orbb (fka Intail)',source:'Jordan Podcast',stage:'Jordan Podcast',stageColor:'#5f55ee',value:'—',days:0,url:'https://app.clickup.com/t/86ewgpryg',tags:['high-priority']},
    {name:'Jeff Kirchick',initials:'JK',company:'Zorro',source:'Joey Podcast',stage:'Joey Podcast',stageColor:'#87909e',value:'—',days:0,url:'https://app.clickup.com/t/86ewgptk9',tags:['high-priority']},
    {name:'Noam Maital',initials:'NM',company:'Darwin AI (DarwinGov)',source:'Joey Podcast',stage:'Joey Podcast',stageColor:'#87909e',value:'—',days:0,url:'https://app.clickup.com/t/86ewgptk0',tags:['high-priority']},
    {name:'Ryan Foote',initials:'RF',company:'JobGet',source:'Other',stage:'Warm Lead',stageColor:'#f9d900',value:'—',days:0,url:'https://app.clickup.com/t/86ewgp74b'},
  ],
  metrics:{avgDeal:'$12-15K',cycle:'—',conversion:'—',pipelineValue:'$915K',ytLeadsThisMonth:5,replyRate:'—'},
  clickupUrl:'https://app.clickup.com/9018484779/v/li/901815818935'
};

const CLICKUP_WS='9018484779';

// Team data
const teamMembers=[
  {name:'Angela',initials:'AP',role:'Operations Manager',color:'#e05d2a',rate:'$3K/mo',channel:'#angela-management',channelId:'C0000ANGELA',clients:['Jamie','Phellos','ODF','Ocon','Ripple'],avgHours:7.2,activity:89,tasks:12,capacity:85},
  {name:'Filip',initials:'FK',role:'Content & Lead Management',color:'#3b7dd8',rate:'$1.5K/mo',channel:'#filip-management',channelId:'C0000FILIP',clients:['Jamie','ODF','Ripple'],avgHours:6.8,activity:82,tasks:8,capacity:72},
  {name:'Sophia',initials:'SM',role:'Inbox Manager',color:'#7c5cbf',rate:'$1K/mo',channel:'#sophia-management',channelId:'C0000SOPHIA',clients:['Jamie','Phellos','ODF','Ocon'],avgHours:5.1,activity:91,tasks:15,capacity:90},
  {name:'Rodney',initials:'RV',role:'Video Editing',color:'#2d9f4e',rate:'Variable',channel:'#rodney-management',channelId:'C0000RODNEY',clients:['YouTube'],avgHours:4.5,activity:78,tasks:4,capacity:55},
];

// YouTube channel data
const ytChannel={
  name:'Dopamine Digital',handle:'@DopamineDigital',subs:'2.1K',totalViews:'142K',
  avgViewDuration:'4:32',ctr:'6.8%',avgViews:'2.4K',
  last30:{views:28400,watchHours:1240,subs:180,impressions:418000},
  topVideos:[
    {title:'Ranking Every B2B Lead Gen Channel',views:'3.2K',ctr:'8.2%',avgDuration:'5:11',published:'Jan 28'},
    {title:'How I Built a 13-Agent AI Army',views:'2.8K',ctr:'7.4%',avgDuration:'4:45',published:'Jan 21'},
    {title:'The Cold Email Framework That Gets Replies',views:'2.1K',ctr:'6.1%',avgDuration:'3:58',published:'Jan 14'},
  ],
  ytToLead:{impressions:418000,clicks:28400,typeformViews:890,submissions:42,qualified:18,callsBooked:5}
};

// Client health score computation
function computeClientHealth(c,campaigns){
  const camp=campaigns[c.id]||{};
  const dr=daysRemaining(c.contract.start,c.contract.days);
  let score=0,factors=0;

  // Contract factor (0-25): expired = 0, <30d = 10, <60d = 18, >60d = 25, ongoing = 25
  if(dr===null){score+=25}
  else if(dr<=0){score+=0}
  else if(dr<30){score+=10}
  else if(dr<60){score+=18}
  else{score+=25}
  factors++;

  // Calls pace (0-25): if target, check pace
  if(c.calls.target){
    const booked=camp.callsBooked||0;
    const elapsed=c.contract.days?(c.contract.days-(dr||0)):90;
    const expectedPace=c.calls.target*(elapsed/c.contract.days);
    const paceRatio=expectedPace>0?booked/expectedPace:0;
    score+=paceRatio>=0.8?25:paceRatio>=0.5?15:paceRatio>=0.25?8:0;
    factors++;
  }

  // Pipeline generation pace (0-25)
  if(c.pipeline.target){
    const gen=camp.pipelineGenerated||0;
    const pct=gen/c.pipeline.target;
    score+=pct>=0.5?25:pct>=0.3?18:pct>=0.15?10:0;
    factors++;
  }

  // Active outreach (0-25): has campaigns running?
  const hasInstantly=camp.instantly&&camp.instantly.totals&&camp.instantly.totals.sent>0;
  const hasHeyreach=camp.heyreach&&camp.heyreach.totals&&camp.heyreach.totals.messaged>0;
  const activeGuests=getActiveGuests(c);
  if(hasInstantly||hasHeyreach||activeGuests>3){score+=25}
  else if(activeGuests>0){score+=15}
  else{score+=0}
  factors++;

  // Alerts penalty
  score-=c.alerts.length*10;

  const maxScore=factors*25;
  const pct=maxScore>0?Math.round((score/maxScore)*100):0;
  const level=pct>=70?'green':pct>=40?'amber':'red';
  const label=pct>=70?'Healthy':pct>=40?'At Risk':'Critical';
  return{score:Math.max(0,pct),level,label};
}

const trendingVideos=[
  {title:'I Replaced My SDR Team With Claude — Here\'s What Happened',channel:'Liam Ottley',subs:'210K',views:'53K',likes:'2.8K',published:'1 day ago',duration:'19:55',outlier:true,outlierLabel:'15x avg',videoId:'HiC1J8a9V1I',hook:'Proof-of-concept video showing live AI replacing human roles — triggers fear + curiosity',url:'https://youtube.com/watch?v=HiC1J8a9V1I'},
  {title:'I Built an AI Agent Army That Runs My Entire Business',channel:'Nick Saraev',subs:'180K',views:'47K',likes:'2.1K',published:'2 days ago',duration:'18:42',outlier:true,outlierLabel:'10x avg',videoId:'4pAt0DP-x50',hook:'Extreme outcome + "entire business" scope claim. Thumbnail likely shows agent dashboard grid.',url:'https://youtube.com/watch?v=4pAt0DP-x50'},
  {title:'SEO Is Dead — AI Content Is 10x Better (Proof)',channel:'Julian Goldie',subs:'120K',views:'41K',likes:'2.4K',published:'3 days ago',duration:'14:08',outlier:true,outlierLabel:'12x avg',videoId:'AKRbTH9OBCY',hook:'Contrarian "X is dead" hook + specific 10x claim with proof. Taps SEO audience\'s anxiety.',url:'https://youtube.com/watch?v=AKRbTH9OBCY'},
  {title:'I Built a ClawdBot — It Does EVERYTHING',channel:'Alex Finn',subs:'95K',views:'32K',likes:'1.8K',published:'1 day ago',duration:'22:15',outlier:true,outlierLabel:'8x avg',videoId:'Qkqe-uRhQJE',hook:'VIRAL hit — personal brand bot concept. "Does EVERYTHING" = curiosity gap.',url:'https://youtube.com/watch?v=Qkqe-uRhQJE'},
  {title:'How I Automate $50K/Month With AI Workflows',channel:'Nick Saraev',subs:'180K',views:'28K',likes:'1.5K',published:'5 days ago',duration:'15:33',outlier:false,videoId:'zbCxi7CjiF0',hook:'Specific revenue number + "automate" = passive income dream.',url:'https://youtube.com/watch?v=zbCxi7CjiF0'},
  {title:'Build AI Agents That Actually Work (n8n + Claude)',channel:'Alex Finn',subs:'95K',views:'18K',likes:'1.1K',published:'6 days ago',duration:'25:30',outlier:false,videoId:'6RMpUnvHmJw',hook:'Tutorial format + "actually work" = differentiation from theory videos.',url:'https://youtube.com/watch?v=6RMpUnvHmJw'},
  {title:'Cold Email in 2026 Is BROKEN — What To Do Instead',channel:'Alex Berman',subs:'310K',views:'22K',likes:'1.2K',published:'3 days ago',duration:'9:42',outlier:false,videoId:'QUTy30H8v58',hook:'"BROKEN" = negative hook + alternative promise. Short runtime = high retention.',url:'https://youtube.com/watch?v=QUTy30H8v58'},
  {title:'The ONLY B2B Lead Gen Strategy That Works in 2026',channel:'Patrick Dang',subs:'450K',views:'19K',likes:'890',published:'4 days ago',duration:'11:47',outlier:false,videoId:'C1J5rF5mnR0',hook:'"ONLY" = exclusivity claim. Year-gating for freshness.',url:'https://youtube.com/watch?v=C1J5rF5mnR0'},
  {title:'I Built 20 AI Agents in 7 Days — Full Breakdown',channel:'Liam Ottley',subs:'210K',views:'35K',likes:'1.9K',published:'5 days ago',duration:'24:18',outlier:true,outlierLabel:'6x avg',videoId:'XC5oeZnMvcg',hook:'Speed + quantity flex. "Full Breakdown" = educational promise.',url:'https://youtube.com/watch?v=XC5oeZnMvcg'},
  {title:'How to Make Money With Claude Code (Step by Step)',channel:'Nick Saraev',subs:'180K',views:'21K',likes:'1.3K',published:'4 days ago',duration:'16:42',outlier:false,videoId:'rPAKq2oQVBs',hook:'Direct monetization promise + step-by-step = beginner-friendly.',url:'https://youtube.com/watch?v=rPAKq2oQVBs'},
  {title:'AI SEO Strategy That Gets 100K Visits/Month',channel:'Julian Goldie',subs:'120K',views:'29K',likes:'1.6K',published:'5 days ago',duration:'17:55',outlier:true,outlierLabel:'8x avg',videoId:'usJLwOaKLX8',hook:'Specific traffic number = credibility. AI + SEO intersection.',url:'https://youtube.com/watch?v=usJLwOaKLX8'},
  {title:'Why AI Agency Owners Are Getting Rich in 2026',channel:'Liam Ottley',subs:'210K',views:'44K',likes:'2.2K',published:'2 days ago',duration:'20:10',outlier:true,outlierLabel:'7x avg',videoId:'Tt-hpp87pd0',hook:'"Getting Rich" = aspiration. AI Agency = trending niche identity.',url:'https://youtube.com/watch?v=Tt-hpp87pd0'},
];

const contentIdeas=[
  {keyword:'AI agents for business automation',volume:'12K/mo',competition:'Medium',score:82,scoreBg:'var(--green-light)',scoreColor:'var(--green)',desc:'Build agents that run ops, sales, marketing. Show your OpenClaw fleet as proof.'},
  {keyword:'Claude Code tutorial 2026',volume:'8.5K/mo',competition:'Low',score:91,scoreBg:'var(--green-light)',scoreColor:'var(--green)',desc:'Step-by-step Claude Code workflow. MCP servers, hooks, automations.'},
  {keyword:'B2B podcast lead generation',volume:'3.2K/mo',competition:'Low',score:88,scoreBg:'var(--green-light)',scoreColor:'var(--green)',desc:'Your exact method — Dream 200 → podcast invite → off-air transition → close.'},
  {keyword:'n8n automation examples',volume:'6.1K/mo',competition:'Medium',score:75,scoreBg:'var(--amber-light)',scoreColor:'var(--amber)',desc:'Show real n8n workflows: YouTube lead response, Hubstaff reports, Fathom processing.'},
  {keyword:'cold email vs LinkedIn outreach',volume:'4.8K/mo',competition:'High',score:62,scoreBg:'var(--amber-light)',scoreColor:'var(--amber)',desc:'Data comparison from Instantly + HeyReach. Use real client campaign numbers.'},
  {keyword:'Alex Hormozi lead gen strategy',volume:'9.7K/mo',competition:'High',score:58,scoreBg:'var(--red-light)',scoreColor:'var(--red)',desc:'Apply $100M Leads to B2B services. Your playbook is literally this — show the proof.'},
  {keyword:'how to replace employees with AI',volume:'15K/mo',competition:'Medium',score:79,scoreBg:'var(--green-light)',scoreColor:'var(--green)',desc:'Controversial but trending. Frame as augmentation. Show Cooper + agent fleet.'},
  {keyword:'building a marketing agency 2026',volume:'5.4K/mo',competition:'Medium',score:71,scoreBg:'var(--amber-light)',scoreColor:'var(--amber)',desc:'Behind the scenes of DD. Revenue, team, tech stack, wins and losses.'},
];

const youtubeData={
  metrics:{ideas:5,inProduction:3,posted:1,avgViews:'2.4K'},
  columns:[
    {id:'ideas',title:'Ideas',color:'var(--blue)',cards:[
      {title:'Why Most B2B Funnels Are Backwards',tag:'Contrarian',tagBg:'#fdeaea',tagColor:'#d14343',author:'Radar',date:'Feb 5',desc:'Challenge the standard ToFu → MQL → SQL pipeline. Argue that starting with podcast conversations (bottom-of-funnel trust) and working backwards generates higher-quality leads. Use DD client data as proof.',docPath:'~/.openclaw/workspace/shared/echo/ideas/b2b-funnels-backwards.md'},
      {title:'I Analyzed 50 Cold Emails From My Inbox',tag:'Data',tagBg:'#edf3fc',tagColor:'#3b7dd8',author:'Echo',date:'Feb 4',desc:'Break down 50 real cold emails Jordan received. Score each on subject line, personalization, CTA, length. Show patterns of what works vs what gets deleted. Include before/after rewrites.',docPath:'~/.openclaw/workspace/shared/echo/ideas/50-cold-emails.md'},
      {title:'AI Agents Are Replacing SDRs — Here\'s Proof',tag:'Hot Take',tagBg:'#fff3ed',tagColor:'#e05d2a',author:'Cooper',date:'Feb 5',desc:'Show how OpenClaw agent squad handles lead enrichment, response monitoring, and research that used to require 2-3 SDRs. Live demo of Scout + Dash + Sherlock working together.',docPath:'~/.openclaw/workspace/shared/cooper/content-calendar/ai-agents-sdrs.md'},
      {title:'The LinkedIn DM That Books Calls',tag:'Tutorial',tagBg:'#ecf8ef',tagColor:'#2d9f4e',author:'Echo',date:'Feb 3',desc:'Step-by-step breakdown of the HeyReach message sequence that gets 12-15% reply rates. Show actual messages, timing, and follow-up cadence. Include A/B test results from Phellos campaign.',docPath:'~/.openclaw/workspace/shared/echo/ideas/linkedin-dm-books-calls.md'},
      {title:'Stop Wasting Money on Meta Ads for B2B',tag:'Contrarian',tagBg:'#fdeaea',tagColor:'#d14343',author:'Radar',date:'Feb 2',desc:'Data-driven argument that Meta ads have a <1% conversion rate for B2B services above $5K. Compare CAC of Meta ads vs podcast outreach vs cold email. Use real client numbers.',docPath:'~/.openclaw/workspace/shared/echo/ideas/meta-ads-b2b.md'},
    ]},
    {id:'approved',title:'Approved',color:'var(--green)',cards:[
      {title:'The Podcast Lead Gen Framework',tag:'Strategy',tagBg:'#f3effb',tagColor:'#7c5cbf',author:'Echo',date:'Feb 1',desc:'Full breakdown of DD\'s podcast-first lead gen system. Step 1: Dream 200 list. Step 2: Podcast invite as Trojan horse. Step 3: Pain discovery during recording. Step 4: Off-air transition to sales.',docPath:'~/.openclaw/workspace/shared/echo/scripts/podcast-framework.md'},
      {title:'$100M Leads Applied to B2B SaaS',tag:'Hormozi',tagBg:'#fef7e8',tagColor:'#c78b1a',author:'Echo',date:'Jan 30',desc:'Take Hormozi\'s 4 core lead gen methods and apply them specifically to B2B SaaS. Show which ones work (content, outreach) and which don\'t scale (paid ads, affiliates) at the $1-10M ARR stage.',docPath:'~/.openclaw/workspace/shared/echo/scripts/100m-leads-saas.md'},
    ]},
    {id:'recording',title:'Ready to Record',color:'var(--amber)',cards:[
      {title:'How We Book 40 Sales Calls in 180 Days',tag:'Case Study',tagBg:'#ecf8ef',tagColor:'#2d9f4e',author:'Jordan',date:'Jan 28',desc:'Behind-the-scenes of the Jamie-Unstuck campaign. Show the full system: Dream 200 research → podcast invites → recordings → off-air transitions → booked calls. Include actual numbers and timeline.',docPath:'https://docs.google.com/document/d/EXAMPLE_JAMIE_CASE_STUDY'},
    ]},
    {id:'posted',title:'Posted on YouTube',color:'var(--accent)',cards:[
      {title:'Ranking Every B2B Lead Gen Channel',tag:'Ranking',tagBg:'#f3effb',tagColor:'#7c5cbf',author:'Jordan',date:'Jan 28',desc:'Tier list ranking of every B2B lead gen channel: podcasts (S-tier), cold email (A-tier), LinkedIn (A-tier), content (B-tier), paid ads (C-tier), events (B-tier). Based on DD\'s actual cost-per-meeting data.',docPath:'https://youtube.com/watch?v=EXAMPLE',views:'3.2K',likes:142},
    ]},
  ]
};

// ═══════════════════════════════════
// MODAL
// ═══════════════════════════════════
function openModal(t,c){document.getElementById('modal-title').textContent=t;document.getElementById('modal-body').innerHTML=c;document.getElementById('modal-overlay').classList.add('active')}
function closeModal(){document.getElementById('modal-overlay').classList.remove('active')}
document.getElementById('modal-close').addEventListener('click',closeModal);
document.getElementById('modal-overlay').addEventListener('click',e=>{if(e.target===e.currentTarget)closeModal()});
document.addEventListener('keydown',e=>{if(e.key==='Escape')closeModal()});

// STATE
let activeTab='all',activeAgentFilter=null;
function getAgent(id){return agents.find(a=>a.id===id)||agents[0]}

// ═══════════════════════════════════
// TAB 0: HOME DASHBOARD
// ═══════════════════════════════════

function renderHome(){
  const el=document.getElementById('home-content');
  const sc=getShowcaseData();
  const _clients=sc?sc.clients:clientData;
  const _campaigns=sc?sc.campaigns:clientCampaigns;
  const _activity=sc?sc.activity:activityLog;
  const d=sc?sc.pipeline:ddPipeline;
  const totalLeads=d.stages.reduce((s,st)=>s+st.count,0);
  const totalGuests=_clients.reduce((s,c)=>s+(c.guests?c.guests.length:getTotalGuests(c)),0);
  const totalCallsBooked=Object.values(_campaigns).reduce((s,c)=>s+(c.callsBooked||0),0);
  const totalPipeGenerated=Object.values(_campaigns).reduce((s,c)=>s+(c.pipelineGenerated||0),0);
  const _agents=sc?sc.agents:agents;
  const liveAgents=_agents.filter(a=>a.buildStatus==='live');
  const builtAgents=_agents.filter(a=>a.buildStatus==='built');
  const expiredClients=_clients.filter(c=>{const dr=daysRemaining(c.contract.start,c.contract.days);return dr!==null&&dr<=0});
  const now=new Date(new Date().toLocaleString('en-US',{timeZone:'Asia/Bangkok'}));
  const dayNames=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];
  const monthNames=['January','February','March','April','May','June','July','August','September','October','November','December'];
  const dateBanner=`${dayNames[now.getDay()]}, ${monthNames[now.getMonth()]} ${now.getDate()}, ${now.getFullYear()}`;

  // — Alerts —
  const alerts=[];
  expiredClients.forEach(c=>alerts.push(`<div class="hd-alert danger"><span class="hd-alert-icon">\u26A0\uFE0F</span><strong>${c.shortName}</strong> contract expired \u2014 schedule renewal call immediately</div>`));
  _clients.filter(c=>{const camp=_campaigns[c.id]||{};const hasOutreach=camp.outreachType||false;const hasInstantly=camp.instantly&&camp.instantly.totals.sent>0;const hasHeyreach=camp.heyreach&&camp.heyreach.totals.messaged>0;const hasGuests=(c.guests?c.guests.length:getTotalGuests(c))>0;return!hasOutreach&&!hasInstantly&&!hasHeyreach&&!hasGuests}).forEach(c=>alerts.push(`<div class="hd-alert warn"><span class="hd-alert-icon">\u{1F4E7}</span><strong>${c.shortName}</strong> \u2014 no active outreach campaigns running</div>`));

  // — Pipeline bar (proportional) —
  const activeStages=d.stages.filter(s=>s.count>0);
  const pipelineBar=activeStages.map(s=>{const pct=totalLeads>0?Math.round((s.count/totalLeads)*100):0;return`<div class="hd-pipeline-seg" style="flex:${s.count};background:${s.color}" title="${s.name}: ${s.count} leads (${pct}%)"><span>${s.count}</span></div>`;}).join('');
  const pipelineLegend=activeStages.map(s=>{const pct=totalLeads>0?Math.round((s.count/totalLeads)*100):0;return`<div class="hd-pipeline-legend-item"><div class="hd-pipeline-legend-dot" style="background:${s.color}"></div>${s.name} <strong style="font-family:'JetBrains Mono',monospace">${s.count}</strong> <span style="color:var(--text-muted)">(${pct}%)</span></div>`;}).join('');

  // — Client cards —
  const clientCards=_clients.map(c=>{
    const dr=daysRemaining(c.contract.start,c.contract.days);
    const total=c.guests?c.guests.length:getTotalGuests(c);
    const active=c.guests?Math.floor(c.guests.length*.6):getActiveGuests(c);
    const camp=_campaigns[c.id]||{};
    const calls=camp.callsBooked||0;
    const pipeGen=camp.pipelineGenerated;
    const isExpired=dr!==null&&dr<=0;
    const contractPct=dr===null?100:isExpired?100:Math.max(0,Math.min(100,(dr/c.contract.days)*100));
    const contractColor=dr===null?'var(--blue)':isExpired?'var(--red)':dr<30?'var(--red)':dr<60?'var(--amber)':'var(--green)';
    const contractText=dr===null?'Ongoing':isExpired?'Expired':dr+'d left';
    return`<div class="hd-client" style="--client-color:${c.color}">
      ${isExpired?'<div class="hd-client-expired">Expired</div>':''}
      <div class="hd-client-top">
        <div class="hd-client-avatar" style="background:${c.color}">${c.initials}</div>
        <div style="min-width:0"><div class="hd-client-name">${c.shortName}</div><div class="hd-client-svc">${c.services}</div></div>
      </div>
      <div class="hd-client-stats">
        <div class="hd-client-stat"><strong>${total}</strong> leads</div>
        <div class="hd-client-stat"><strong>${active}</strong> active</div>
        <div class="hd-client-stat"><strong>${calls}</strong>${c.calls.target?'/'+c.calls.target:''} calls</div>
        <div class="hd-client-stat">${pipeGen?'<strong>'+c.pipeline.currency+(pipeGen/1000)+'K</strong>'+('/'+c.pipeline.currency+(c.pipeline.target/1000)+'K'):'<strong>\u2014</strong> gen'}</div>
      </div>
      ${c.calls.target?`<div class="hd-mini-bar"><div class="hd-mini-bar-fill" style="width:${Math.min(100,(calls/c.calls.target)*100)}%;background:${calls>=c.calls.target?'var(--green)':calls>=c.calls.target*.5?'var(--amber)':'var(--accent)'}"></div></div>`:''}
      <div class="hd-client-contract-label"><span>Contract</span><span style="color:${contractColor};font-weight:600">${contractText}</span></div>
      <div class="hd-progress"><div class="hd-progress-fill" style="width:${contractPct}%;background:${contractColor}"></div></div>
    </div>`;
  }).join('');

  // — Hot leads —
  const stageRank={'Strategy Call':1,'Growth Plan':2,'Warm Lead':3,'YouTube Lead':4};
  const hotLeads=d.leads.filter(l=>stageRank[l.stage]).sort((a,b)=>(stageRank[a.stage]||99)-(stageRank[b.stage]||99));
  const leadRows=hotLeads.slice(0,7).map(l=>{
    const isPriority=l.tags&&l.tags.includes('high-priority');
    return`<div class="hd-lead">
    <div class="hd-lead-avatar" style="background:${l.stageColor}">${l.initials}</div>
    <div class="hd-lead-info">
      <div class="hd-lead-name"><a href="${l.url||'#'}" target="_blank">${l.name}</a>${isPriority?'<span class="hd-tag-priority">Priority</span>':''}</div>
      <div class="hd-lead-company">${l.company} \u00B7 ${l.source}</div>
    </div>
    ${l.value&&l.value!=='\u2014'?`<span class="hd-lead-value">${l.value}</span>`:''}
    <div class="hd-lead-badge" style="background:${l.stageColor}14;color:${l.stageColor}">${l.stage}</div>
  </div>`;}).join('');

  // — Agent fleet (show all agents in showcase mode) —
  const fleetAgents=sc?_agents:[...liveAgents,...builtAgents];
  const agentChips=fleetAgents.map(a=>{
    const isLive=a.buildStatus==='live';
    return`<div class="hd-agent" title="${a.role} \u2014 ${a.schedule}">
      <div class="hd-agent-dot ${isLive?'live':''}" style="background:${isLive?'var(--green)':'var(--blue)'}"></div>
      <span>${a.emoji}</span>
      <div style="flex:1;min-width:0"><span class="hd-agent-name">${a.name}</span><div style="font-size:.44rem;color:var(--text-muted);margin-top:-1px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">${a.role}</div></div>
      <span class="hd-agent-label" style="background:${isLive?'var(--green-light)':'var(--blue-light)'};color:${isLive?'var(--green)':'var(--blue)'}">${isLive?'LIVE':'READY'}</span>
    </div>`;
  }).join('');

  // — Activity feed (3 most recent) —
  const activityRows=_activity.slice(0,4).map(a=>{const ag=getAgent(a.agent);return`<div class="hd-activity-row">
    <span style="width:6px;height:6px;border-radius:50%;background:${ag.color};flex-shrink:0"></span>
    <span style="font-weight:600;color:${ag.color};flex-shrink:0;font-size:.58rem">${ag.name}</span>
    <span style="flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:var(--text-secondary)">${a.action} "${a.task}"</span>
    <span style="font-size:.5rem;color:var(--text-muted);flex-shrink:0">${a.time}</span>
  </div>`;}).join('');

  // — System health —
  const _systems=sc?sc.systems:systems;
  const healthChips=_systems.map(s=>`<div class="hd-health-chip"><span class="hd-health-dot" style="background:${s.status==='ok'?'var(--green)':s.status==='warn'?'var(--amber)':'var(--red)'}"></span>${s.name}</div>`).join('');

  // — North Star —
  const ns=sc&&sc.northStar?sc.northStar:northStar;
  const nsGap=ns.goalMRR-ns.currentMRR;
  const nsPct=Math.round((ns.currentMRR/ns.goalMRR)*100);
  const nsClientsNeeded=Math.ceil(nsGap/ns.avgClientMRR);
  const nsPerMonth=Math.ceil(nsClientsNeeded/ns.monthsToGoal);
  const fmtK=n=>n>=1000?'$'+Math.round(n/1000)+'K':'$'+n;
  const nsOnTrack=ns.kpis.filter(k=>k.actual!=null&&k.actual/k.num>=0.8).length;
  // Pace projector: weighted avg completion → projected months
  const nsWeights=[10,6,4,2,5,0]; // meeting contribution weights (new clients excluded)
  const nsTotalW=nsWeights.reduce((a,b)=>a+b,0);
  const nsWAvg=ns.kpis.reduce((s,k,i)=>{if(!nsWeights[i])return s;const p=k.actual!=null?Math.min(k.actual/k.num,1):0;return s+p*nsWeights[i];},0)/nsTotalW;
  const nsPaceMonths=nsWAvg>0?Math.round(ns.monthsToGoal/nsWAvg):99;
  const nsPaceColor=nsPaceMonths<=ns.monthsToGoal?'var(--green)':nsPaceMonths<=ns.monthsToGoal*1.5?'var(--amber)':'var(--red)';
  // Funnel (inline text)
  const f=ns.funnel||{};
  const fReplyRate=f.sent?((f.replies||0)/f.sent*100).toFixed(1)+'%':'\u2014';
  const funnelText=`<strong>${f.sent||0}</strong> sent \u2192 <strong>${f.replies||0}</strong> replies (${fReplyRate}) \u2192 <strong>${f.interested||0}</strong> interested \u2192 <strong>${f.calls||0}</strong> calls \u2192 <strong>${f.closed||0}</strong> closed`;
  // Attribution (inline text)
  const srcData=ns.sources||{};const srcColors={youtube:'var(--red)',coldEmail:'var(--blue)',podcast:'var(--amber)',referral:'var(--green)'};
  const srcLabels={youtube:'YT',coldEmail:'Email',podcast:'Pod',referral:'Ref'};
  const srcParts=Object.entries(srcData).filter(([,v])=>v>0).map(([k,v])=>`<span class="ns-src-dot" style="background:${srcColors[k]}"></span>${v} ${srcLabels[k]}`).join(' \u00A0');
  // KPI cards
  const nsKpis=ns.kpis.map(k=>{
    const hasA=k.actual!=null;
    const pct=hasA?Math.min(Math.round((k.actual/k.num)*100),100):0;
    const pc=pct>=80?'var(--green)':pct>=50?'var(--amber)':'var(--red)';
    const numHtml=hasA?`<div class="ns-kpi-num" style="color:${pc}">${k.actual}</div><div class="ns-kpi-of">/ ${k.num} ${k.unit}</div>`:`<div class="ns-kpi-num" style="color:${k.color}">${k.num}</div><div class="ns-kpi-unit">${k.unit}</div>`;
    const barHtml=hasA?`<div class="ns-kpi-bar"><div class="ns-kpi-bar-fill" style="width:${pct}%;background:${pc}"></div></div>`:'';
    return`<div class="ns-kpi" style="--kpi-color:${k.color}">${numHtml}<div class="ns-kpi-label">${k.label}</div>${barHtml}<div class="ns-kpi-result">${k.result}</div></div>`;
  }).join('');

  // — Quick links —
  const quickLinks=`<a class="hd-link" href="${d.clickupUrl||'#'}" target="_blank">\u{1F4CA} DD Pipeline</a>`+_clients.map(c=>{
    const link=c.clickup.podcastListId?'https://app.clickup.com/'+CLICKUP_WS+'/v/li/'+c.clickup.podcastListId:'https://app.clickup.com/'+CLICKUP_WS+'/v/s/'+c.clickup.spaceId;
    return`<a class="hd-link" href="${link}" target="_blank" style="border-color:${c.color}30;color:${c.color}">${c.shortName}</a>`;
  }).join('');

  el.innerHTML=`
    <div class="ns-wrap">
      <div class="ns-header"><div class="ns-title">Revenue North Star</div><div style="display:flex;align-items:center;gap:.5rem"><label class="ns-day-toggle" title="Toggle daily view"><input type="checkbox" id="ns-daily-toggle" onchange="toggleNsDayMode(this.checked)"><span class="ns-day-switch"></span><span class="ns-day-label">Daily</span></label><div class="ns-goal-tag">${fmtK(ns.goalMRR)}/mo</div></div></div>
      <div class="ns-revenue">
        <div class="ns-amount"><div class="ns-amount-num" style="color:var(--accent)">${fmtK(ns.currentMRR)}</div><div class="ns-amount-label">Current MRR</div></div>
        <div class="ns-bar-wrap"><div class="ns-bar"><div class="ns-bar-fill" style="width:${nsPct}%"><span class="ns-bar-pct">${nsPct}%</span></div></div></div>
        <div class="ns-amount"><div class="ns-amount-num" style="color:var(--green)">${fmtK(ns.goalMRR)}</div><div class="ns-amount-label">Monthly Goal</div></div>
      </div>
      <div class="ns-gap-row">
        <span class="ns-gap-pill" style="background:var(--red-light);color:var(--red)">${fmtK(nsGap)} gap</span>
        <span style="color:var(--border)">\u00B7</span>
        <span class="ns-gap-pill" style="background:var(--amber-light);color:var(--amber)">${nsClientsNeeded} clients to go</span>
        <span style="color:var(--border)">\u00B7</span>
        <span class="ns-gap-pill" style="background:var(--blue-light);color:var(--blue)">~${nsPerMonth} new/month = goal in ${ns.monthsToGoal}mo</span>
      </div>
      <div class="ns-kpi-title">Weekly Targets<span class="ns-week-label">\u2014 ${ns.weekLabel||'This Week'} \u2014 ${nsOnTrack}/${ns.kpis.length} on track</span></div>
      <div class="ns-kpis">${nsKpis}</div>
      <div class="ns-pace-bar">
        <div class="ns-pace-vol"><span class="ns-pace-pct" style="color:${nsPaceColor}">${Math.round(nsWAvg*100)}%</span><span style="font-size:.42rem;font-weight:600;color:var(--text-muted)">volume</span></div>
        <div class="ns-pace-track"><div class="ns-pace-track-fill" style="width:${Math.round(nsWAvg*100)}%;background:${nsPaceColor}"></div></div>
        <div class="ns-pace-pills">
          <span class="ns-pace-pill" style="background:${nsPaceColor}15;color:${nsPaceColor}">Current \u2192 ${nsPaceMonths>=99?'\u221E':nsPaceMonths+'mo'}</span>
          <span class="ns-pace-pill" style="background:var(--green)15;color:var(--green)">Target \u2192 ${ns.monthsToGoal}mo</span>
        </div>
      </div>
      <div class="ns-insight">Funnel: ${funnelText}<span class="ns-insight-sep">|</span>Sources: ${srcParts}<span class="ns-insight-sep">|</span>~${nsPerMonth} closes/mo \u2192 ${fmtK(ns.goalMRR)} in ${ns.monthsToGoal}mo</div>
    </div>
    <div class="hd-date-banner"><strong>${dateBanner}</strong> \u00B7 Bangkok (UTC+7)</div>
    <div class="hd-hero">
      <div class="hd-hero-card accent">
        <div class="hd-hero-num" style="color:var(--accent)">${d.metrics.pipelineValue}</div>
        <div class="hd-hero-label">Pipeline Value</div>
        <div class="hd-hero-sub">${totalLeads} leads across ${activeStages.length} stages</div>
      </div>
      <div class="hd-hero-card blue">
        <div class="hd-hero-num" style="color:var(--blue)">${_clients.length}</div>
        <div class="hd-hero-label">Active Clients</div>
        <div class="hd-hero-sub">${totalGuests} pipeline guests \u00B7 ${expiredClients.length?'<span style="color:var(--red);font-weight:600">'+expiredClients.length+' expired</span>':'all active'}</div>
      </div>
      <div class="hd-hero-card green">
        <div class="hd-hero-num" style="color:var(--green)">${totalCallsBooked}</div>
        <div class="hd-hero-label">Calls Booked</div>
        <div class="hd-hero-sub">${totalPipeGenerated>0?(totalPipeGenerated>=1000000?'$'+(totalPipeGenerated/1000000).toFixed(1)+'M':'$'+Math.round(totalPipeGenerated/1000)+'K')+' generated':'—'} \u00B7 ${d.metrics.ytLeadsThisMonth} YT leads</div>
      </div>
      <div class="hd-hero-card purple">
        <div class="hd-hero-num" style="color:var(--purple)">${liveAgents.length}<span style="font-size:.9rem;color:var(--text-muted);font-weight:500">/${_agents.length}</span></div>
        <div class="hd-hero-label">Agents Online</div>
        <div class="hd-hero-sub"><span style="width:6px;height:6px;border-radius:50%;background:var(--green);display:inline-block;animation:livePulse 2s ease-in-out infinite"></span> ${liveAgents.map(a=>a.name).join(', ')}</div>
      </div>
    </div>

    ${alerts.length?`<div class="hd-alerts">${alerts.join('')}</div>`:''}

    <div class="hd-pipeline">
      <div class="hd-pipeline-header">
        <div class="hd-pipeline-title">Dopamine Digital Sales Pipeline</div>
        <a href="${d.clickupUrl||'#'}" target="_blank" style="font-size:.54rem;color:var(--accent);text-decoration:none;font-weight:600">View in ClickUp \u2192</a>
      </div>
      <div class="hd-pipeline-bar">${pipelineBar}</div>
      <div class="hd-pipeline-legend">${pipelineLegend}</div>
    </div>

    <div class="hd-section-label">Client Health</div>
    <div class="hd-clients">${clientCards}</div>

    <div class="hd-cols">
      <div class="hd-section">
        <div class="hd-section-title" style="--dot-color:var(--accent)">Dopamine Digital Hot Leads <span style="font-size:.48rem;font-weight:600;color:var(--accent);background:var(--accent-light);padding:1px 6px;border-radius:8px;margin-left:4px">${hotLeads.length}</span></div>
        ${leadRows||'<div style="font-size:.62rem;color:var(--text-muted);padding:.5rem 0">No hot leads in pipeline</div>'}
      </div>
      <div class="hd-section">
        <div class="hd-section-title" style="--dot-color:var(--purple)">AI Agent Fleet <span style="font-size:.48rem;font-weight:600;color:var(--green);background:var(--green-light);padding:1px 6px;border-radius:8px;margin-left:4px">${liveAgents.length} live</span></div>
        <div class="hd-agents">${agentChips}</div>
      </div>
    </div>

    <div class="hd-divider"></div>

    <div class="hd-three-col">
      <div class="hd-section">
        <div class="hd-section-title" style="--dot-color:var(--blue)">Recent Activity</div>
        <div class="hd-activity-compact">${activityRows}</div>
      </div>
      <div class="hd-section">
        <div class="hd-section-title" style="--dot-color:var(--green)">System Health</div>
        <div class="hd-health-row">${healthChips}</div>
      </div>
      <div class="hd-section">
        <div class="hd-section-title" style="--dot-color:var(--amber)">Content Pipeline</div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:4px">
          <div style="text-align:center;padding:.4rem;background:var(--blue-light);border-radius:6px"><div style="font-size:1rem;font-weight:800;font-family:'JetBrains Mono',monospace;color:var(--blue)">${youtubeData.metrics.ideas}</div><div style="font-size:.46rem;color:var(--text-muted);font-weight:600;text-transform:uppercase">Ideas</div></div>
          <div style="text-align:center;padding:.4rem;background:var(--green-light);border-radius:6px"><div style="font-size:1rem;font-weight:800;font-family:'JetBrains Mono',monospace;color:var(--green)">${youtubeData.metrics.inProduction}</div><div style="font-size:.46rem;color:var(--text-muted);font-weight:600;text-transform:uppercase">Approved</div></div>
          <div style="text-align:center;padding:.4rem;background:var(--amber-light);border-radius:6px"><div style="font-size:1rem;font-weight:800;font-family:'JetBrains Mono',monospace;color:var(--amber)">1</div><div style="font-size:.46rem;color:var(--text-muted);font-weight:600;text-transform:uppercase">Recording</div></div>
          <div style="text-align:center;padding:.4rem;background:var(--accent-light);border-radius:6px"><div style="font-size:1rem;font-weight:800;font-family:'JetBrains Mono',monospace;color:var(--accent)">${youtubeData.metrics.posted}</div><div style="font-size:.46rem;color:var(--text-muted);font-weight:600;text-transform:uppercase">Posted</div></div>
        </div>
      </div>
    </div>

    <div class="hd-links">${quickLinks}</div>
  `;
}

// ═══════════════════════════════════
// TAB 1: MISSION CONTROL RENDERS
// ═══════════════════════════════════

function renderAgentList(){
  const el=document.getElementById('agent-list');
  const sc=getShowcaseData();
  const _agents=sc?sc.agents:agents;
  el.innerHTML=_agents.map((a,i)=>`
    <div class="agent-item" data-agent-id="${a.id}" style="animation-delay:${i*25}ms">
      <div class="agent-avatar" style="background:${a.color}12">${a.emoji}</div>
      <div class="agent-info">
        <div class="agent-name-row">
          <span class="agent-name">${a.name}</span>
          <span class="agent-type-badge ${a.type}" data-tip="${a.typeFull}">${a.type.toUpperCase()}</span>
        </div>
        <div class="agent-role">${a.role}</div>
      </div>
      <div class="agent-status ${a.buildStatus}">
        <span class="agent-status-dot"></span>
        ${a.buildStatus==='live'?'LIVE':'READY'}
      </div>
    </div>`).join('');
  el.querySelectorAll('.agent-item').forEach(item=>{
    item.addEventListener('click',()=>{
      const a=getAgent(item.dataset.agentId);
      const sc=a.buildStatus==='live'?'live':'built';
      const sl=a.buildStatus==='live'?'LIVE':'SOUL Built';
      openModal(`${a.emoji} ${a.name}`,`
        <div class="modal-row"><span class="modal-label">Role</span><span class="modal-value">${a.role}</span></div>
        <div class="modal-row"><span class="modal-label">Type</span><span class="modal-value">${a.typeFull}</span></div>
        <div class="modal-row"><span class="modal-label">Status</span><span class="modal-badge ${sc}">${sl}</span></div>
        <div class="modal-row"><span class="modal-label">Schedule</span><span class="modal-value">${a.schedule}</span></div>
        <div class="modal-row"><span class="modal-label">About</span><span class="modal-value">${a.desc}</span></div>
        <div class="modal-row"><span class="modal-label">SOUL File</span><span class="modal-file">openclaw-agents/${a.file}</span></div>`);
    });
  });
}

function renderBuildProgress(){
  const el=document.getElementById('build-section');
  const sc=getShowcaseData();
  const _agents=sc?sc.agents:agents;
  const live=_agents.filter(a=>a.buildStatus==='live');
  const built=_agents.filter(a=>a.buildStatus==='built');
  const total=_agents.length,bc=live.length+built.length;
  const pct=Math.round((bc/total)*100),lp=Math.round((live.length/total)*100);
  el.innerHTML=`
    <div class="build-header"><span class="build-title">Build Progress</span><span class="build-count">${bc}/${total}</span></div>
    <div class="build-bar-track"><div class="build-bar-fill" style="width:${pct}%;background:linear-gradient(90deg,var(--green) ${(lp/pct)*100}%,var(--blue) ${(lp/pct)*100}%)"></div></div>
    <div class="build-legend">
      <span class="build-legend-item"><span class="build-legend-dot" style="background:var(--green)"></span>${live.length} Live</span>
      <span class="build-legend-item"><span class="build-legend-dot" style="background:var(--blue)"></span>${built.length} Ready</span>
    </div>
    <div class="build-agents-grid">
      ${live.map(a=>`<div class="build-agent-pill live" data-agent-id="${a.id}"><span class="pill-dot"></span>${a.name}</div>`).join('')}
      ${built.map(a=>`<div class="build-agent-pill built" data-agent-id="${a.id}"><span class="pill-dot"></span>${a.name}</div>`).join('')}
    </div>`;
  el.querySelectorAll('.build-agent-pill').forEach(p=>{
    p.addEventListener('click',()=>{
      const a=getAgent(p.dataset.agentId);
      openModal(`${a.emoji} ${a.name}`,`<div class="modal-row"><span class="modal-label">Role</span><span class="modal-value">${a.role}</span></div><div class="modal-row"><span class="modal-label">Status</span><span class="modal-badge ${a.buildStatus==='live'?'live':'built'}">${a.buildStatus==='live'?'LIVE':'SOUL Built'}</span></div><div class="modal-row"><span class="modal-label">About</span><span class="modal-value">${a.desc}</span></div>`);
    });
  });
}

function renderKanban(){
  const board=document.getElementById('kanban-board');
  const sc=getShowcaseData();
  const _kanban=sc?sc.kanban:kanbanColumns;
  board.innerHTML=_kanban.map(col=>`
    <div class="kanban-column" data-col="${col.id}">
      <div class="kanban-col-header">
        <div class="kanban-col-title"><span class="kanban-col-dot" style="background:${col.color}"></span>${col.title}</div>
        <span class="kanban-col-count">${col.cards.length}</span>
      </div>
      <div class="kanban-col-cards">
        ${col.cards.map((c,i)=>{const a=getAgent(c.agent);return`
          <div class="kanban-card" data-card-id="${c.id}" style="animation-delay:${i*50}ms">
            ${c.tags?`<div class="kanban-card-tags">${c.tags.map(t=>`<span class="kanban-tag" style="background:${t.bg};color:${t.color}">${t.label}</span>`).join('')}</div>`:''}
            <div class="kanban-card-title">${c.title}</div>
            <div class="kanban-card-desc">${c.desc}</div>
            ${c.insight?`<div class="kanban-card-insight">${c.insight}</div>`:''}
            ${c.details&&c.details!==c.desc?`<div style="font-size:.62rem;color:var(--text-muted);line-height:1.4;margin-bottom:.4rem;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden">${c.details}</div>`:''}
            <div class="kanban-card-footer">
              <div class="kanban-card-agent"><span class="kanban-card-avatar" style="background:${a.color}12">${a.emoji}</span><span class="kanban-card-agent-name">${a.name}</span></div>
              <span class="kanban-card-time">${c.time}</span>
            </div>
          </div>`;}).join('')}
      </div>
    </div>`).join('');
  board.querySelectorAll('.kanban-card').forEach(el=>{
    el.addEventListener('click',()=>{
      let card=null;
      for(const col of _kanban){const f=col.cards.find(c=>c.id===el.dataset.cardId);if(f){card=f;break;}}
      if(!card)return;
      const a=getAgent(card.agent);
      openModal(card.title,`
        <div class="modal-row"><span class="modal-label">Agent</span><span class="modal-value">${a.emoji} ${a.name} — ${a.role}</span></div>
        <div class="modal-row"><span class="modal-label">Status</span><span class="modal-value">${card.time}</span></div>
        <div class="modal-row"><span class="modal-label">Details</span><span class="modal-value">${(card.details||card.desc).replace(/\n/g,'<br>')}</span></div>`);
    });
  });
}

function renderHealth(){
  const el=document.getElementById('health-list');
  const sc=getShowcaseData();
  const _systems=sc?sc.systems:systems;
  el.innerHTML=_systems.map((s,i)=>`<div class="health-item" data-health-idx="${i}"><span class="health-dot ${s.status}"></span><span>${s.name}</span></div>`).join('');
  el.querySelectorAll('.health-item').forEach(item=>{
    item.addEventListener('click',()=>{
      const s=_systems[parseInt(item.dataset.healthIdx)];
      openModal(s.name,`<div class="modal-row"><span class="modal-label">Status</span><span class="modal-badge live">Healthy</span></div><div class="modal-row"><span class="modal-label">Detail</span><span class="modal-value">${s.detail}</span></div>`);
    });
  });
}

function getFilteredActivity(){
  const sc=getShowcaseData();
  let list=sc?sc.activity:activityLog;
  if(activeTab==='tasks')list=list.filter(a=>a.action.includes('completed'));
  else if(activeTab==='status')list=list.filter(a=>a.action.includes('logged'));
  if(activeAgentFilter)list=list.filter(a=>getAgent(a.agent).name===activeAgentFilter);
  return list;
}

function renderActivity(){
  const el=document.getElementById('activity-feed');
  const filtered=getFilteredActivity();
  if(!filtered.length){el.innerHTML='<div style="text-align:center;padding:2rem;font-size:.72rem;color:var(--text-muted);font-style:italic">No matching activity</div>';return;}
  el.innerHTML=filtered.map((a,i)=>{
    const agent=getAgent(a.agent);
    return`<div class="activity-entry" data-activity-idx="${i}">
      <div class="activity-entry-main">
        <span class="activity-dot" style="background:${agent.color}"></span>
        <div class="activity-content">
          <div class="activity-text"><span class="activity-agent" style="color:${agent.color}">${agent.name}</span> ${a.action} <span class="activity-task-name">"${a.task}"</span></div>
          <div class="activity-meta"><span class="activity-time">${a.time}</span>${a.hasResult?`<a class="activity-link" data-result-idx="${i}" href="#">View result &rarr;</a>`:''}</div>
        </div>
      </div>
    </div>`;}).join('');
  el.querySelectorAll('.activity-entry').forEach(entry=>{
    entry.addEventListener('click',()=>{
      const a=filtered[parseInt(entry.dataset.activityIdx)];
      const agent=getAgent(a.agent);
      openModal(`${agent.name}: ${a.task}`,`
        <div class="modal-row"><span class="modal-label">Agent</span><span class="modal-value">${agent.emoji} ${agent.name}</span></div>
        <div class="modal-row"><span class="modal-label">Task</span><span class="modal-value">${a.task}</span></div>
        <div class="modal-row"><span class="modal-label">Time</span><span class="modal-value">${a.time}</span></div>
        <div class="modal-row"><span class="modal-label">Details</span><span class="modal-value">${a.detail}</span></div>
        ${a.hasResult?`<div class="modal-row"><span class="modal-label">Output</span><span class="modal-file">~/.openclaw/workspace/shared/${agent.id}/${a.task}/</span></div>`:''}`);
    });
  });
  el.querySelectorAll('.activity-link').forEach(link=>{
    link.addEventListener('click',e=>{
      e.preventDefault();e.stopPropagation();
      const a=filtered[parseInt(link.dataset.resultIdx)];
      const agent=getAgent(a.agent);
      openModal(`Result: ${a.task}`,`
        <div class="modal-row"><span class="modal-label">Agent</span><span class="modal-value">${agent.emoji} ${agent.name}</span></div>
        <div class="modal-row"><span class="modal-label">Result</span><span class="modal-value">${a.detail}</span></div>
        <div class="modal-row"><span class="modal-label">Output</span><span class="modal-file">~/.openclaw/workspace/shared/${agent.id}/${a.task}/</span></div>`);
    });
  });
}

function renderAgentChips(){
  const el=document.getElementById('agent-chips');
  const sc=getShowcaseData();
  const _agents=sc?sc.agents:agents;
  const names=['All Agents',..._agents.filter(a=>a.buildStatus==='live').map(a=>a.name)];
  el.innerHTML=names.map(n=>{
    const a=agents.find(ag=>ag.name===n);
    return`<button class="agent-chip${n==='All Agents'?' active':''}" data-agent-name="${n}">${a?`<span class="agent-chip-dot" style="background:${a.color}"></span>`:''}${n}</button>`;
  }).join('');
  el.querySelectorAll('.agent-chip').forEach(chip=>{
    chip.addEventListener('click',()=>{
      el.querySelectorAll('.agent-chip').forEach(c=>c.classList.remove('active'));
      chip.classList.add('active');
      activeAgentFilter=chip.dataset.agentName==='All Agents'?null:chip.dataset.agentName;
      renderActivity();
    });
  });
}

// ═══════════════════════════════════
// TAB 2: DD PIPELINE
// ═══════════════════════════════════

function renderDDPipeline(){
  const el=document.getElementById('dd-content');
  const sc=getShowcaseData();
  const d=sc?sc.pipeline:ddPipeline;
  const totalLeads=d.stages.reduce((s,st)=>s+st.count,0);
  // Pipeline conversion funnel
  const funnelStages=['Joey Podcast','Jordan Podcast','YouTube Lead','Warm Lead','Strategy Call','Growth Plan'];
  const funnelCounts=funnelStages.map(name=>{const s=d.stages.find(x=>x.name===name);return{name,count:s?s.count:0,color:s?s.color:'var(--gray)'}});
  const conversionArrows=[];
  for(let i=0;i<funnelCounts.length-1;i++){
    const from=funnelCounts[i],to=funnelCounts[i+1];
    const rate=from.count>0?Math.round((to.count/from.count)*100):0;
    conversionArrows.push(rate);
  }
  const conversionHtml=funnelCounts.map((s,i)=>{
    let arrow='';
    if(i<conversionArrows.length){
      const rate=conversionArrows[i];
      const rColor=rate>=30?'var(--green)':rate>=15?'var(--amber)':'var(--red)';
      arrow=`<div class="pipeline-conv-arrow"><span style="color:${rColor}">${rate}%</span>\u2192</div>`;
    }
    return`<div class="pipeline-conv-stage"><div class="pipeline-conv-count" style="color:${s.color}">${s.count}</div><div class="pipeline-conv-label">${s.name}</div></div>${arrow}`;
  }).join('');

  // Instantly overview (DD aggregate)
  const inst=ddInstantlyOverview;
  const instReplyRate=inst.sent>0?((inst.replies/inst.sent)*100).toFixed(1):0;
  const instBounceRate=inst.sent>0?((inst.bounced/inst.sent)*100).toFixed(1):0;

  // Velocity metrics
  const stratCalls=d.stages.find(s=>s.name==='Strategy Call')?.count||0;
  const growthPlans=d.stages.find(s=>s.name==='Growth Plan')?.count||0;
  const hotLeadCount=stratCalls+growthPlans;
  const forecastRevenue=hotLeadCount*15000;
  const warmCount=d.stages.find(s=>s.name==='Warm Lead')?.count||0;

  el.innerHTML=`
    <div class="section-heading"><span class="section-dot" style="background:var(--accent)"></span>DD Sales Pipeline — ${totalLeads} leads <a href="${d.clickupUrl||'#'}" target="_blank" style="font-size:.6rem;color:var(--accent);font-weight:500;text-decoration:none;text-transform:none;letter-spacing:0">Open in ClickUp &rarr;</a></div>
    <div class="pipeline-stages">${d.stages.map(s=>`
      <div class="pipeline-stage"><div class="pipeline-stage-count" style="color:${s.color}">${s.count}</div><div class="pipeline-stage-name">${s.name}</div></div>`).join('')}
    </div>

    <div class="section-heading"><span class="section-dot" style="background:var(--purple)"></span>Conversion Funnel</div>
    <div class="pipeline-conversion">${conversionHtml}</div>

    <div class="pipeline-velocity-grid">
      <div class="pipeline-vel-card"><div class="pipeline-vel-val" style="color:var(--accent)">${totalLeads}</div><div class="pipeline-vel-label">Total Pipeline</div></div>
      <div class="pipeline-vel-card"><div class="pipeline-vel-val" style="color:var(--green)">${hotLeadCount}</div><div class="pipeline-vel-label">Hot Leads</div><div class="pipeline-vel-sub">Strategy + Growth Plan</div></div>
      <div class="pipeline-vel-card"><div class="pipeline-vel-val" style="color:var(--blue)">$${Math.round(forecastRevenue/1000)}K</div><div class="pipeline-vel-label">Revenue Forecast</div><div class="pipeline-vel-sub">${hotLeadCount} deals @ $15K avg</div></div>
      <div class="pipeline-vel-card"><div class="pipeline-vel-val">${d.metrics.avgDeal}</div><div class="pipeline-vel-label">Deal Size</div></div>
      <div class="pipeline-vel-card"><div class="pipeline-vel-val" style="color:var(--amber)">${warmCount}</div><div class="pipeline-vel-label">Warm Leads</div><div class="pipeline-vel-sub">Need follow-up</div></div>
      <div class="pipeline-vel-card"><div class="pipeline-vel-val">${d.metrics.ytLeadsThisMonth}</div><div class="pipeline-vel-label">YT Leads/Mo</div></div>
    </div>

    <div class="section-heading"><span class="section-dot" style="background:var(--blue)"></span>Instantly Email Performance (All Campaigns)</div>
    <div class="instantly-overview">
      <div class="instantly-stats">
        <div class="instantly-stat"><div class="instantly-stat-val">${(inst.sent/1000).toFixed(1)}K</div><div class="instantly-stat-label">Emails Sent</div></div>
        <div class="instantly-stat"><div class="instantly-stat-val">${(inst.replies/1000).toFixed(1)}K</div><div class="instantly-stat-label">Replies</div></div>
        <div class="instantly-stat"><div class="instantly-stat-val" style="color:${instReplyRate>=3?'var(--green)':'var(--amber)'}">${instReplyRate}%</div><div class="instantly-stat-label">Reply Rate</div></div>
        <div class="instantly-stat"><div class="instantly-stat-val" style="color:var(--green)">${inst.interested}</div><div class="instantly-stat-label">Interested</div></div>
        <div class="instantly-stat"><div class="instantly-stat-val">${(inst.oppValue/1000000).toFixed(1)}M</div><div class="instantly-stat-label">Opp Value</div></div>
        <div class="instantly-stat"><div class="instantly-stat-val" style="color:${instBounceRate<2?'var(--green)':'var(--red)'}">${instBounceRate}%</div><div class="instantly-stat-label">Bounce Rate</div></div>
        <div class="instantly-stat"><div class="instantly-stat-val">${inst.meetingsBooked}</div><div class="instantly-stat-label">Meetings</div></div>
        <div class="instantly-stat"><div class="instantly-stat-val">${inst.activeCampaigns}</div><div class="instantly-stat-label">Active Campaigns</div></div>
      </div>
    </div>
    <div class="section-heading"><span class="section-dot" style="background:var(--accent)"></span>Pipeline Board</div>
    <div class="dd-kanban" id="dd-kanban"></div>
    <div class="section-heading"><span class="section-dot" style="background:var(--blue)"></span>Lead Sources (from ClickUp tags)</div>
    <div class="metric-cards">${d.sources.map(s=>`
      <div class="metric-card"><div class="metric-value">${s.icon} ${s.count}</div><div class="metric-label">${s.name}</div><div class="metric-sub">${s.trend}</div></div>`).join('')}
    </div>
    <div class="section-heading"><span class="section-dot" style="background:var(--purple)"></span>Key Prospects (from ClickUp)</div>
    <div id="dd-leads"></div>
    <div class="section-heading"><span class="section-dot" style="background:var(--green)"></span>Pipeline Notes</div>
    ${sc?`
    <div class="insight-card"><span class="insight-icon">\uD83D\uDD25</span><span class="insight-text"><strong>Sarah Mitchell (ScaleForce AI)</strong> \u2014 Strategy Call stage. Discovery call scheduled Friday, high priority. 3 action items: custom proposal, send case studies, book follow-up.</span></div>
    <div class="insight-card"><span class="insight-icon">\uD83D\uDCCA</span><span class="insight-text"><strong>Elena Voronova + Priya Sharma</strong> \u2014 Growth Plan stage. Both high-intent leads, closest to close. Combined deal value: $30K.</span></div>
    <div class="insight-card"><span class="insight-icon">\uD83C\uDFA4</span><span class="insight-text"><strong>70 podcast leads</strong> (42 Joey + 28 Jordan) in early pipeline. 20 marked high-priority \u2014 push to recording first.</span></div>
    <div class="insight-card"><span class="insight-icon">\u26A0\uFE0F</span><span class="insight-text"><strong>51 warm leads</strong> across all sources. 8 re-engagement sequences active. Maverick optimizing follow-up cadence.</span></div>
    `:`
    <div class="insight-card"><span class="insight-icon">\uD83D\uDD25</span><span class="insight-text"><strong>Durell Patrick (how2pay4college)</strong> \u2014 Strategy Call stage. Had call today, high priority. 3 action items: custom proposal, send YouTube videos, book follow-up.</span></div>
    <div class="insight-card"><span class="insight-icon">\uD83D\uDCCA</span><span class="insight-text"><strong>Bryan Mejia + Dimitris Mougis</strong> \u2014 Growth Plan stage. Both YouTube leads, closest to close.</span></div>
    <div class="insight-card"><span class="insight-icon">\uD83C\uDFA4</span><span class="insight-text"><strong>30 podcast leads</strong> (18 Joey + 12 Jordan) in early pipeline. 9 marked high-priority \u2014 these are the ones to push to recording first.</span></div>
    <div class="insight-card"><span class="insight-icon">\u26A0\uFE0F</span><span class="insight-text"><strong>23 warm leads</strong> sitting without clear next step. Review for staleness \u2014 some may need re-engagement or archiving.</span></div>
    `}
  `;
  // Build kanban board
  const kanbanEl=document.getElementById('dd-kanban');
  const stageMap={};
  d.stages.forEach(s=>{stageMap[s.name]={color:s.color,count:s.count,leads:[]}});
  d.leads.forEach(l=>{if(stageMap[l.stage])stageMap[l.stage].leads.push(l)});
  kanbanEl.innerHTML=Object.entries(stageMap).map(([name,data])=>{
    const slug=name.toLowerCase().replace(/\s+/g,'-');
    return`<div class="dd-kanban-col" data-stage="${slug}">
      <div class="dd-kanban-col-header">
        <div class="dd-kanban-col-title"><span class="kanban-col-dot" style="background:${data.color}"></span>${name}</div>
        <span class="dd-kanban-col-count">${data.count}</span>
      </div>
      <div class="dd-kanban-cards">${data.leads.map(l=>`
        <a class="dd-lead-card" href="${l.url||'#'}" target="_blank">
          <div class="dd-lead-card-name">${l.name}${l.tags&&l.tags.includes('high-priority')?'<span class="dd-lead-card-priority">PRIORITY</span>':''}</div>
          <div class="dd-lead-card-company">${l.company}</div>
          <div class="dd-lead-card-footer">
            <span class="dd-lead-card-source">${l.source}</span>
            <span class="dd-lead-card-value">${l.value}</span>
          </div>
        </a>`).join('')}
      </div>
    </div>`;
  }).join('');

  // Build lead list
  const leadsEl=document.getElementById('dd-leads');
  leadsEl.innerHTML=d.leads.map(l=>`
    <a class="lead-row" data-lead-name="${l.name}" href="${l.url||'#'}" target="_blank" style="text-decoration:none;color:inherit">
      <div class="lead-avatar">${l.initials}</div>
      <div class="lead-info"><div class="lead-name">${l.name}</div><div class="lead-company">${l.company}</div></div>
      <span class="lead-stage-tag" style="background:${l.stageColor}18;color:${l.stageColor}">${l.stage}</span>
      <div style="text-align:center"><div style="font-size:.58rem;color:var(--text-muted)">Source</div><div style="font-size:.7rem;font-weight:500">${l.source}</div></div>
      ${l.tags&&l.tags.includes('high-priority')?`<span style="font-size:.54rem;font-weight:600;padding:1px 6px;border-radius:10px;background:var(--red-light);color:var(--red)">Priority</span>`:`<div style="width:50px"></div>`}
      <div class="lead-value">${l.value}</div>
    </a>`).join('');
}

// ═══════════════════════════════════
// TAB 3: CLIENT PIPELINE
// ═══════════════════════════════════

function daysRemaining(start,contractDays){
  if(!start||!contractDays)return null;
  const s=new Date(start);
  const end=new Date(s.getTime()+contractDays*86400000);
  const now=new Date('2026-02-05');
  return Math.max(0,Math.round((end-now)/86400000));
}

let activeClientTab='jamie';
function getTotalGuests(c){return Object.values(c.podcastStages||{}).reduce((s,v)=>s+v,0)+(c.outboundStages?Object.values(c.outboundStages).reduce((s,v)=>s+v,0):0)}
function getActiveGuests(c){return(c.podcastStages?.['upcoming podcasts']||0)+(c.podcastStages?.['post podcast']||0)+(c.podcastStages?.['upcoming pre-calls']||0)+(c.podcastStages?.['podcasts today']||0)}

function renderClientPipeline(){
  const el=document.getElementById('clients-content');
  const sc=getShowcaseData();
  const _cd=sc?sc.clients:clientData;
  const _cc=sc?sc.campaigns:clientCampaigns;
  if(!_cd.find(c=>c.id===activeClientTab))activeClientTab=_cd[0].id;
  // Summary metrics
  const totalGuests=_cd.reduce((s,c)=>s+getTotalGuests(c),0);
  const activeGuests=_cd.reduce((s,c)=>s+getActiveGuests(c),0);
  const alertCount=_cd.reduce((s,c)=>s+c.alerts.length,0);
  const expiredCount=_cd.filter(c=>{const dr=daysRemaining(c.contract.start,c.contract.days);return dr!==null&&dr<=0}).length;

  // Compute health scores for all clients
  const healthScores={};
  _cd.forEach(c=>{healthScores[c.id]=computeClientHealth(c,_cc)});
  const healthyCt=Object.values(healthScores).filter(h=>h.level==='green').length;
  const atRiskCt=Object.values(healthScores).filter(h=>h.level==='amber').length;
  const criticalCt=Object.values(healthScores).filter(h=>h.level==='red').length;

  el.innerHTML=`
    <div class="client-summary">
      <div class="client-summary-card"><div class="client-summary-val">${_cd.length}</div><div class="client-summary-label">Active Clients</div></div>
      <div class="client-summary-card"><div class="client-summary-val">${totalGuests}</div><div class="client-summary-label">Total Pipeline</div><div class="client-summary-sub">All podcast + outbound leads</div></div>
      <div class="client-summary-card"><div class="client-summary-val" style="color:var(--green)">${activeGuests}</div><div class="client-summary-label">Active Guests</div><div class="client-summary-sub">Upcoming + post-podcast + pre-calls</div></div>
      <div class="client-summary-card">
        <div class="client-summary-val"><span style="color:var(--green)">${healthyCt}</span> <span style="font-size:.7rem;color:var(--text-muted)">/</span> <span style="color:var(--amber)">${atRiskCt}</span> <span style="font-size:.7rem;color:var(--text-muted)">/</span> <span style="color:var(--red)">${criticalCt}</span></div>
        <div class="client-summary-label">Health Score</div>
        <div class="client-summary-sub">Healthy / At Risk / Critical</div>
      </div>
      <div class="client-summary-card"><div class="client-summary-val" style="color:${expiredCount>0?'var(--red)':'var(--green)'}">${expiredCount}</div><div class="client-summary-label">Expired Contracts</div><div class="client-summary-sub">${expiredCount>0?_cd.filter(c=>{const dr=daysRemaining(c.contract.start,c.contract.days);return dr!==null&&dr<=0}).map(c=>c.shortName).join(', '):''}</div></div>
    </div>
    <div class="client-tabs" id="client-tabs"></div>
    <div id="client-views"></div>`;

  // Render sub-tabs
  const tabsEl=document.getElementById('client-tabs');
  tabsEl.innerHTML=_cd.map(c=>{
    const h=healthScores[c.id];
    return`<button class="client-tab${c.id===activeClientTab?' active':''}" data-client-id="${c.id}">
      <span class="client-tab-avatar" style="background:${c.color}">${c.initials}</span>
      ${c.shortName}
      <span class="health-badge ${h.level}"><span class="health-badge-dot"></span>${h.score}%</span>
      <span style="font-size:.62rem;color:var(--text-muted);font-weight:400">${getTotalGuests(c)}</span>
      ${c.alerts.length?'<span class="client-tab-alert"></span>':''}
    </button>`;}).join('');

  // Render all client views
  const viewsEl=document.getElementById('client-views');
  viewsEl.innerHTML=_cd.map(c=>{
    const dr=daysRemaining(c.contract.start,c.contract.days);
    const drColor=dr===null?'var(--text-muted)':dr<=0?'var(--red)':dr<30?'var(--red)':dr<60?'var(--amber)':'var(--green)';
    const cuSpace=`https://app.clickup.com/${CLICKUP_WS}/v/s/${c.clickup.spaceId}`;
    const cuPodcast=c.clickup.podcastListId?`https://app.clickup.com/${CLICKUP_WS}/v/li/${c.clickup.podcastListId}`:'';
    const cuLinkedin=c.clickup.linkedinListId?`https://app.clickup.com/${CLICKUP_WS}/v/li/${c.clickup.linkedinListId}`:'';
    const cuEmail=c.clickup.emailListId?`https://app.clickup.com/${CLICKUP_WS}/v/li/${c.clickup.emailListId}`:'';
    const slackClient=`https://app.slack.com/client/T07V3HYJN0N/${c.slack.channelId}`;
    const slackTeam=`https://app.slack.com/client/T07V3HYJN0N/${c.slack.teamId}`;
    const stages=c.podcastStages||{};
    const outbound=c.outboundStages||{};
    const allStages={...stages,...outbound};
    const totalPipeline=Object.values(allStages).reduce((s,v)=>s+v,0);

    const h=healthScores[c.id];
    const camp0=_cc[c.id]||{};
    const hasInst0=camp0.instantly&&camp0.instantly.totals&&camp0.instantly.totals.sent>0;
    const hasHR0=camp0.heyreach&&camp0.heyreach.totals&&camp0.heyreach.totals.messaged>0;
    const activeG0=getActiveGuests(c);
    // Guarantee pace calculation
    let callsPace='',pipePace='';
    if(c.calls.target&&dr!==null&&c.contract.days){
      const elapsed=c.contract.days-(dr||0);const expectedNow=Math.round(c.calls.target*(elapsed/c.contract.days));
      const booked0=camp0.callsBooked||0;
      const ratio=expectedNow>0?booked0/expectedNow:0;
      callsPace=ratio>=0.8?'on-track':ratio>=0.5?'behind':'critical';
    }
    if(c.pipeline.target&&camp0.pipelineGenerated){
      const pctGen=camp0.pipelineGenerated/c.pipeline.target;
      pipePace=pctGen>=0.4?'on-track':pctGen>=0.2?'behind':'critical';
    }

    return`<div class="client-view${c.id===activeClientTab?' active':''}" id="cv-${c.id}">
      <div class="client-detail-header">
        <div class="client-detail-avatar" style="background:${c.color}">${c.initials}</div>
        <div class="client-detail-info">
          <div class="client-detail-name">${c.name} <span class="health-badge ${h.level}"><span class="health-badge-dot"></span>${h.label} (${h.score}%)</span></div>
          <div class="client-detail-services">${c.services} | ${c.contact}</div>
          <div style="display:flex;gap:.25rem;flex-wrap:wrap;margin-top:3px">
            ${hasInst0?'<span class="delivery-flag active">Email Active</span>':'<span class="delivery-flag none">No Email</span>'}
            ${hasHR0?'<span class="delivery-flag active">LinkedIn Active</span>':'<span class="delivery-flag none">No LinkedIn</span>'}
            ${activeG0>3?'<span class="delivery-flag active">'+activeG0+' Active Guests</span>':activeG0>0?'<span class="delivery-flag paused">'+activeG0+' Active Guests</span>':'<span class="delivery-flag none">No Active Guests</span>'}
          </div>
          <div style="font-size:.66rem;color:var(--text-muted);margin-top:2px">${c.business}</div>
          <div class="client-detail-links">
            <a class="client-detail-link" href="${cuSpace}" target="_blank">ClickUp Space</a>
            ${cuPodcast?`<a class="client-detail-link" href="${cuPodcast}" target="_blank">Podcast Board</a>`:''}
            ${cuLinkedin?`<a class="client-detail-link" href="${cuLinkedin}" target="_blank">LinkedIn Leads</a>`:''}
            ${cuEmail?`<a class="client-detail-link" href="${cuEmail}" target="_blank">Email Leads</a>`:''}
            <a class="client-detail-link" href="${slackClient}" target="_blank">${c.slack.channel}</a>
            <a class="client-detail-link" href="${slackTeam}" target="_blank">${c.slack.team}</a>
          </div>
        </div>
        <div class="client-detail-contract">
          <div class="client-detail-days" style="color:${drColor}">${dr===null?'—':dr<=0?'EXPIRED':dr+'d'}</div>
          <div class="client-detail-days-label">${dr===null?'Ongoing':dr<=0?'Renewal needed':'remaining'}</div>
          ${c.pipeline.target?`<div class="client-detail-target">${c.pipeline.currency}${c.pipeline.target.toLocaleString()} target</div>`:''}
          ${c.calls.target?`<div class="client-detail-target">${c.calls.target} calls guaranteed</div>`:''}
          ${callsPace?`<div class="guarantee-pace ${callsPace}">${callsPace==='on-track'?'Calls on track':'Calls '+callsPace}</div>`:''}
          ${pipePace?`<div class="guarantee-pace ${pipePace}">${pipePace==='on-track'?'Pipeline on track':'Pipeline '+pipePace}</div>`:''}
        </div>
      </div>

      ${c.alerts.length?`<div style="margin-bottom:.75rem">${c.alerts.map(a=>`<div class="client-alert-item red">${a}</div>`).join('')}</div>`:''}

      ${(()=>{
        const camp=_cc[c.id]||{};
        const cb=camp.callsBooked||0;
        const pg=camp.pipelineGenerated||0;
        const cbPct=c.calls.target?Math.min(100,Math.round((cb/c.calls.target)*100)):0;
        const pgPct=c.pipeline.target?Math.min(100,Math.round((pg/c.pipeline.target)*100)):0;
        const inst=camp.instantly||{campaigns:[],totals:{sent:0,openRate:0,replyRate:0,positiveRate:0}};
        const hr=camp.heyreach||{campaigns:[],totals:{connected:0,messaged:0,replyRate:0}};
        const calls=camp.recentCalls||[];
        return`
      ${c.calls.target||c.pipeline.target?`
      <div class="client-section-title">Guarantee Progress</div>
      <div style="display:grid;grid-template-columns:${c.calls.target&&c.pipeline.target?'1fr 1fr':'1fr'};gap:.75rem;margin-bottom:.75rem">
        ${c.calls.target?`<div style="background:var(--bg);border:1px solid var(--border);border-radius:var(--radius);padding:.65rem .85rem;box-shadow:var(--shadow-sm)">
          <div style="display:flex;justify-content:space-between;align-items:baseline;margin-bottom:.4rem">
            <span style="font-size:.68rem;font-weight:600;color:var(--text-secondary)">Calls Booked</span>
            <span style="font-size:1rem;font-weight:700;font-family:'JetBrains Mono',monospace;color:${cbPct>=50?'var(--green)':cbPct>=25?'var(--amber)':'var(--text)'}">${cb}/${c.calls.target}</span>
          </div>
          <div style="height:6px;background:var(--bg-hover);border-radius:3px;overflow:hidden">
            <div style="height:100%;width:${cbPct}%;background:${c.color};border-radius:3px;transition:width .6s"></div>
          </div>
          <div style="font-size:.58rem;color:var(--text-muted);margin-top:3px">${cbPct}% of ${c.calls.target} qualified sales calls</div>
        </div>`:''}
        ${c.pipeline.target?`<div style="background:var(--bg);border:1px solid var(--border);border-radius:var(--radius);padding:.65rem .85rem;box-shadow:var(--shadow-sm)">
          <div style="display:flex;justify-content:space-between;align-items:baseline;margin-bottom:.4rem">
            <span style="font-size:.68rem;font-weight:600;color:var(--text-secondary)">Pipeline Generated</span>
            <span style="font-size:1rem;font-weight:700;font-family:'JetBrains Mono',monospace;color:${pgPct>=50?'var(--green)':pgPct>=25?'var(--amber)':'var(--text)'}">${c.pipeline.currency}${pg>0?(pg/1000).toFixed(0)+'K':'0'}/${c.pipeline.currency}${(c.pipeline.target/1000).toFixed(0)}K</span>
          </div>
          <div style="height:6px;background:var(--bg-hover);border-radius:3px;overflow:hidden">
            <div style="height:100%;width:${pgPct}%;background:${c.color};border-radius:3px;transition:width .6s"></div>
          </div>
          <div style="font-size:.58rem;color:var(--text-muted);margin-top:3px">${pgPct}% of ${c.pipeline.currency}${c.pipeline.target.toLocaleString()} pipeline</div>
        </div>`:''}
      </div>`:''}

      <div class="client-section-title">Outreach Performance</div>
      <div class="client-two-col">
        <div class="client-outreach-panel">
          <div class="client-outreach-header">
            <span class="client-outreach-title"><span class="platform-dot" style="background:var(--blue)"></span>Cold Email (Instantly)</span>
            <span style="font-size:.56rem;color:${inst.totals.sent>0?'var(--green)':'var(--text-muted)'}; font-weight:600">${inst.totals.sent>0?'ACTIVE':'NO CAMPAIGNS'}</span>
          </div>
          ${inst.totals.sent>0?`
          <div class="client-outreach-totals">
            <div class="client-outreach-stat"><div class="client-outreach-stat-val">${inst.totals.sent.toLocaleString()}</div><div class="client-outreach-stat-label">Sent</div></div>
            <div class="client-outreach-stat"><div class="client-outreach-stat-val">${inst.totals.openRate}%</div><div class="client-outreach-stat-label">Open Rate</div></div>
            <div class="client-outreach-stat"><div class="client-outreach-stat-val" style="color:${inst.totals.replyRate>=3?'var(--green)':inst.totals.replyRate>=1?'var(--amber)':'var(--red)'}">${inst.totals.replyRate}%</div><div class="client-outreach-stat-label">Reply Rate</div></div>
            <div class="client-outreach-stat"><div class="client-outreach-stat-val" style="color:${inst.totals.positiveRate>=1?'var(--green)':'var(--amber)'}">${inst.totals.positiveRate}%</div><div class="client-outreach-stat-label">Positive</div></div>
          </div>
          ${inst.campaigns.map(camp=>`
            <div class="client-camp-row">
              <span class="client-camp-status-dot ${camp.status}"></span>
              <span class="client-camp-name-text" title="${camp.name}">${camp.name}</span>
              <span class="client-camp-metric">${camp.sent} sent</span>
              <span class="client-camp-metric">${camp.replied} replies</span>
              <span class="client-camp-metric" style="color:var(--green);font-weight:600">${camp.positive} pos</span>
            </div>`).join('')}
          `:`<div style="padding:.5rem 0;font-size:.66rem;color:var(--text-muted);text-align:center">No Instantly campaigns configured</div>`}
        </div>
        <div class="client-outreach-panel">
          <div class="client-outreach-header">
            <span class="client-outreach-title"><span class="platform-dot" style="background:var(--accent)"></span>LinkedIn (HeyReach)</span>
            <span style="font-size:.56rem;color:${hr.totals.messaged>0?'var(--green)':'var(--text-muted)'}; font-weight:600">${hr.totals.messaged>0?'ACTIVE':'NOT CONNECTED'}</span>
          </div>
          ${hr.totals.messaged>0?`
          <div class="client-outreach-totals">
            <div class="client-outreach-stat"><div class="client-outreach-stat-val">${hr.totals.connected}</div><div class="client-outreach-stat-label">Connected</div></div>
            <div class="client-outreach-stat"><div class="client-outreach-stat-val">${hr.totals.messaged}</div><div class="client-outreach-stat-label">Messaged</div></div>
            <div class="client-outreach-stat"><div class="client-outreach-stat-val" style="color:${hr.totals.replyRate>=15?'var(--green)':hr.totals.replyRate>=8?'var(--amber)':'var(--red)'}">${hr.totals.replyRate}%</div><div class="client-outreach-stat-label">Reply Rate</div></div>
          </div>
          ${hr.campaigns.map(camp=>`
            <div class="client-camp-row">
              <span class="client-camp-status-dot ${camp.status}"></span>
              <span class="client-camp-name-text" title="${camp.name}">${camp.name}</span>
              <span class="client-camp-metric">${camp.connected} conn.</span>
              <span class="client-camp-metric">${camp.replied} replies</span>
            </div>`).join('')}
          `:`<div style="padding:.5rem 0;font-size:.66rem;color:var(--text-muted);text-align:center">No HeyReach campaigns configured</div>`}
        </div>
      </div>

      `;})()}

      <div class="client-section-title">${Object.keys(stages).length?'Podcast':'Outbound'} Pipeline <span class="count-badge">${totalPipeline} total</span></div>
      <div class="client-pipeline-stages">
        ${Object.entries(allStages).sort((a,b)=>b[1]-a[1]).map(([status,count])=>`
          <div class="client-pipeline-stage">
            <div class="client-pipeline-stage-count" style="color:${STATUS_COLORS[status]||'var(--gray)'}">${count}</div>
            <div class="client-pipeline-stage-name">${status}</div>
          </div>`).join('')}
      </div>
      <div class="dd-kanban" id="ck-${c.id}" style="min-height:200px"></div>
    </div>`;}).join('');

  // Build client pipeline kanban boards
  _cd.forEach(c=>{
    const el=document.getElementById('ck-'+c.id);
    if(!el)return;
    const stages=c.podcastStages||{};
    const outbound=c.outboundStages||{};
    const allStages={...stages,...outbound};
    const sorted=Object.entries(allStages).sort((a,b)=>b[1]-a[1]);

    // Helper: convert CSS var color to a subtle column tint
    const colTint=(sc)=>{
      const m={'var(--green)':'236,248,239','var(--accent)':'255,243,237','var(--blue)':'237,243,252','var(--purple)':'243,239,251','var(--amber)':'254,247,232','var(--red)':'253,234,234','var(--gray)':'240,239,236'};
      const rgb=m[sc]||'250,249,247';
      return`background:linear-gradient(180deg,rgba(${rgb},1) 0%,var(--bg-sidebar) 100%);border-top:2px solid ${sc};box-shadow:inset 0 2px 4px rgba(0,0,0,.03)`;
    };
    if(c.guests.length){
      const byStage={};
      sorted.forEach(([s])=>{byStage[s]=c.guests.filter(g=>g.status===s)});
      el.innerHTML=sorted.map(([status,count])=>{
        const gs=byStage[status]||[];
        const sc=STATUS_COLORS[status]||'var(--gray)';
        return`<div class="dd-kanban-col" style="${colTint(sc)}">
          <div class="dd-kanban-col-header">
            <div class="dd-kanban-col-title"><span class="kanban-col-dot" style="background:${sc}"></span>${status}</div>
            <span class="dd-kanban-col-count">${count}</span>
          </div>
          <div class="dd-kanban-cards">${gs.map(g=>`
            <a class="dd-lead-card" href="${g.url}" target="_blank">
              <div class="dd-lead-card-name">${g.name}</div>
            </a>`).join('')}
            ${count>gs.length?`<div style="font-size:.54rem;color:var(--text-muted);text-align:center;padding:.25rem">${count-gs.length} more in ClickUp</div>`:''}
          </div>
        </div>`;
      }).join('');
    }else{
      const cuLink=c.clickup.podcastListId?`https://app.clickup.com/${CLICKUP_WS}/v/li/${c.clickup.podcastListId}`:c.clickup.linkedinListId?`https://app.clickup.com/${CLICKUP_WS}/v/li/${c.clickup.linkedinListId}`:`https://app.clickup.com/${CLICKUP_WS}/v/s/${c.clickup.spaceId}`;
      el.innerHTML=sorted.map(([status,count])=>{
        const sc=STATUS_COLORS[status]||'var(--gray)';
        return`<div class="dd-kanban-col" style="${colTint(sc)}">
          <div class="dd-kanban-col-header">
            <div class="dd-kanban-col-title"><span class="kanban-col-dot" style="background:${sc}"></span>${status}</div>
            <span class="dd-kanban-col-count">${count}</span>
          </div>
          <div class="dd-kanban-cards">
            <div style="font-size:.56rem;color:var(--text-muted);text-align:center;padding:.4rem">${count} leads</div>
          </div>
        </div>`;
      }).join('')+`<div style="font-size:.6rem;color:var(--text-muted);text-align:center;padding:.5rem;grid-column:1/-1"><a href="${cuLink}" target="_blank" style="color:var(--accent);font-weight:500;text-decoration:none">View full pipeline in ClickUp &rarr;</a></div>`;
    }
  });

  // Tab switching
  tabsEl.querySelectorAll('.client-tab').forEach(tab=>{
    tab.addEventListener('click',()=>{
      activeClientTab=tab.dataset.clientId;
      tabsEl.querySelectorAll('.client-tab').forEach(t=>t.classList.remove('active'));
      tab.classList.add('active');
      viewsEl.querySelectorAll('.client-view').forEach(v=>v.classList.remove('active'));
      document.getElementById('cv-'+activeClientTab).classList.add('active');
    });
  });
}

// ═══════════════════════════════════
// TAB 4: YOUTUBE CONTENT
// ═══════════════════════════════════

// Saved videos (localStorage)
let ytSavedVideos=new Set(JSON.parse(localStorage.getItem('mc_saved_videos')||'[]'));
let ytShowSaved=false;

function ytToggleSave(videoId,e){
  e.preventDefault();e.stopPropagation();
  if(ytSavedVideos.has(videoId)){ytSavedVideos.delete(videoId)}else{ytSavedVideos.add(videoId)}
  localStorage.setItem('mc_saved_videos',JSON.stringify([...ytSavedVideos]));
  ytShowToast(ytSavedVideos.has(videoId)?'Saved for later':'Removed from saved');
  renderYouTube();
}
function ytToggleSavedFilter(){
  ytShowSaved=!ytShowSaved;
  renderYouTube();
}
function ytShowToast(msg){
  const t=document.getElementById('yt-toast');t.textContent=msg;t.classList.add('show');
  clearTimeout(t._tid);t._tid=setTimeout(()=>t.classList.remove('show'),2000);
}
function ytRefreshTrending(){
  const btn=document.querySelector('.yt-refresh-btn');
  if(btn){btn.classList.add('spinning');setTimeout(()=>{btn.classList.remove('spinning');ytShowToast('Trending data is up to date')},800)}
}

function renderYouTube(){
  const el=document.getElementById('youtube-content');
  const yd=youtubeData;
  const outlierCount=trendingVideos.filter(v=>v.outlier).length;

  // Channel performance
  const yt=ytChannel;
  const ytFunnel=yt.ytToLead;
  const ytClickRate=ytFunnel.impressions>0?((ytFunnel.clicks/ytFunnel.impressions)*100).toFixed(1):0;
  const ytSubRate=ytFunnel.clicks>0?((ytFunnel.typeformViews/ytFunnel.clicks)*100).toFixed(1):0;
  const ytQualRate=ytFunnel.submissions>0?((ytFunnel.qualified/ytFunnel.submissions)*100).toFixed(0):0;

  const savedCount=ytSavedVideos.size;
  el.innerHTML=`
    <div class="section-heading"><span class="section-dot" style="background:var(--red)"></span>Your Channel Performance</div>
    <div class="yt-channel-wrap">
      <div class="yt-channel-header">
        <div class="yt-channel-avatar">DD</div>
        <div>
          <div class="yt-channel-name">${yt.name}</div>
          <div class="yt-channel-handle">${yt.handle}</div>
        </div>
      </div>
      <div class="yt-channel-stats">
        <div class="yt-channel-stat"><div class="yt-channel-stat-val">${yt.subs}</div><div class="yt-channel-stat-label">Subscribers</div><div class="yt-channel-stat-sub">+${yt.last30.subs} this month</div></div>
        <div class="yt-channel-stat"><div class="yt-channel-stat-val">${yt.totalViews}</div><div class="yt-channel-stat-label">Total Views</div><div class="yt-channel-stat-sub">${(yt.last30.views/1000).toFixed(1)}K this month</div></div>
        <div class="yt-channel-stat"><div class="yt-channel-stat-val">${yt.avgViewDuration}</div><div class="yt-channel-stat-label">Avg Duration</div><div class="yt-channel-stat-sub">Watch time</div></div>
        <div class="yt-channel-stat"><div class="yt-channel-stat-val" style="color:${parseFloat(yt.ctr)>=5?'var(--green)':'var(--amber)'}">${yt.ctr}</div><div class="yt-channel-stat-label">CTR</div><div class="yt-channel-stat-sub">Impressions click-through</div></div>
        <div class="yt-channel-stat"><div class="yt-channel-stat-val">${yt.avgViews}</div><div class="yt-channel-stat-label">Avg Views</div><div class="yt-channel-stat-sub">Per video</div></div>
      </div>
      <div class="yt-conversion">
        <strong>${(ytFunnel.impressions/1000).toFixed(0)}K</strong> impressions \u2192
        <strong>${(ytFunnel.clicks/1000).toFixed(1)}K</strong> views (${ytClickRate}%) \u2192
        <strong>${ytFunnel.typeformViews}</strong> TypeForm views \u2192
        <strong>${ytFunnel.submissions}</strong> submissions \u2192
        <strong>${ytFunnel.qualified}</strong> qualified (${ytQualRate}%) \u2192
        <strong>${ytFunnel.callsBooked}</strong> calls booked
      </div>
    </div>

    ${yt.topVideos.length?`
    <div class="section-heading"><span class="section-dot" style="background:var(--green)"></span>Top Performing Videos</div>
    <div class="metric-cards" style="margin-bottom:1.25rem">
      ${yt.topVideos.map(v=>`<div class="metric-card">
        <div style="font-size:.72rem;font-weight:600;line-height:1.3;margin-bottom:.3rem">${v.title}</div>
        <div style="display:flex;gap:.6rem;font-size:.56rem;color:var(--text-muted)">
          <span><strong style="color:var(--text);font-family:'JetBrains Mono',monospace">${v.views}</strong> views</span>
          <span>CTR <strong style="color:${parseFloat(v.ctr)>=7?'var(--green)':'var(--amber)'}; font-family:'JetBrains Mono',monospace">${v.ctr}</strong></span>
          <span>Avg <strong style="font-family:'JetBrains Mono',monospace">${v.avgDuration}</strong></span>
          <span>${v.published}</span>
        </div>
      </div>`).join('')}
    </div>`:''}

    <div class="section-heading"><span class="section-dot" style="background:var(--red)"></span>Trending in Your Niche — Last 7 Days <span style="font-size:.58rem;font-weight:500;color:var(--red);background:var(--red-light);padding:2px 8px;border-radius:10px;margin-left:.3rem">${outlierCount} outliers</span>
      <div class="yt-toolbar">
        ${savedCount?`<button class="yt-toolbar-btn${ytShowSaved?' active':''}" onclick="ytToggleSavedFilter()"><svg width="12" height="12" viewBox="0 0 24 24" fill="${ytShowSaved?'currentColor':'none'}" stroke="currentColor" stroke-width="2"><path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"/></svg>Saved (${savedCount})</button>`:''}
        <button class="yt-toolbar-btn yt-refresh-btn" onclick="ytRefreshTrending()"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M23 4v6h-6M1 20v-6h6"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>Refresh</button>
      </div>
    </div>
    <div class="yt-trending-grid" id="yt-trending"></div>

    <div class="section-heading"><span class="section-dot" style="background:var(--blue)"></span>Content Ideas & Keywords <span style="font-size:.58rem;font-weight:400;color:var(--text-muted);text-transform:none;letter-spacing:0">(ranked by opportunity score)</span></div>
    <div id="yt-ideas"></div>

    <div class="section-heading"><span class="section-dot" style="background:var(--accent)"></span>Your Content Pipeline</div>
    <div class="yt-metrics">
      <div class="metric-card"><div class="metric-value">${yd.metrics.ideas}</div><div class="metric-label">Ideas</div></div>
      <div class="metric-card"><div class="metric-value">${yd.metrics.inProduction}</div><div class="metric-label">In Production</div></div>
      <div class="metric-card"><div class="metric-value">${yd.metrics.posted}</div><div class="metric-label">Posted This Month</div></div>
      <div class="metric-card"><div class="metric-value">${yd.metrics.avgViews}</div><div class="metric-label">Avg Views</div></div>
    </div>
    <div class="yt-kanban" id="yt-kanban"></div>`;

  // Trending videos (filtered if showing saved only)
  const trendEl=document.getElementById('yt-trending');
  const displayVideos=ytShowSaved?trendingVideos.filter(v=>ytSavedVideos.has(v.videoId)):trendingVideos;
  trendEl.innerHTML=displayVideos.length?displayVideos.map((v,i)=>{
    const isSaved=ytSavedVideos.has(v.videoId);
    return`<a class="yt-trending-card" href="${v.url}" target="_blank" style="animation:slide-up .25s ease-out ${i*50}ms both">
      <div class="yt-trending-thumb">
        <img src="https://img.youtube.com/vi/${v.videoId}/mqdefault.jpg" alt="${v.title}" loading="lazy">
        <span class="yt-trending-duration">${v.duration}</span>
        ${v.outlier?`<span class="yt-trending-outlier">${v.outlierLabel}</span>`:''}
        <button class="yt-save-btn${isSaved?' saved':''}" onclick="ytToggleSave('${v.videoId}',event)" title="${isSaved?'Remove from saved':'Save for later'}"><svg viewBox="0 0 24 24"><path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"/></svg></button>
      </div>
      <div class="yt-trending-body">
        <div class="yt-trending-title">${v.title}</div>
        <div class="yt-trending-channel"><span class="yt-trending-channel-dot"></span>${v.channel} &middot; ${v.subs} subs</div>
        <div class="yt-trending-stats">
          <span>${v.views} views</span>
          <span>${v.likes} likes</span>
          <span>${v.published}</span>
        </div>
        ${v.hook?`<div style="font-size:.56rem;color:var(--text-muted);line-height:1.4;margin-top:.3rem;border-top:1px solid var(--border-light);padding-top:.3rem">${v.hook}</div>`:''}
      </div>
    </a>`}).join(''):'<div style="padding:2rem;text-align:center;color:var(--text-muted);font-size:.7rem">No saved videos yet. Click the bookmark icon on any video to save it.</div>';

  // Content ideas — table layout
  const ideasEl=document.getElementById('yt-ideas');
  const sortedIdeas=contentIdeas.sort((a,b)=>b.score-a.score).slice(0,8);
  ideasEl.innerHTML=`<table class="yt-ideas-table">
    <thead><tr><th>Score</th><th>Keyword</th><th>Idea</th><th>Volume</th><th>Comp.</th></tr></thead>
    <tbody>${sortedIdeas.map(idea=>`<tr>
      <td><span class="idea-score" style="background:${idea.scoreBg};color:${idea.scoreColor}">${idea.score}</span></td>
      <td class="idea-kw">${idea.keyword}</td>
      <td class="idea-desc" title="${idea.desc}">${idea.desc}</td>
      <td class="idea-vol">${idea.volume}</td>
      <td><span class="idea-comp ${idea.competition.toLowerCase()}">${idea.competition}</span></td>
    </tr>`).join('')}</tbody>
  </table>`;

  // Content pipeline kanban
  const kanban=document.getElementById('yt-kanban');
  kanban.innerHTML=yd.columns.map(col=>`
    <div class="yt-column">
      <div class="yt-col-header">
        <div class="yt-col-title"><span class="kanban-col-dot" style="background:${col.color}"></span>${col.title}</div>
        <span style="font-size:.68rem;color:var(--text-muted)">${col.cards.length}</span>
      </div>
      ${col.cards.map((c,i)=>`
        <div class="yt-card" data-yt-col="${col.id}" data-yt-idx="${i}" style="animation-delay:${i*60}ms">
          <div class="yt-card-tag" style="background:${c.tagBg};color:${c.tagColor}">${c.tag}</div>
          <div class="yt-card-title">${c.title}</div>
          <div class="yt-card-meta"><span>${c.author}</span><span>${c.date}</span></div>
        </div>`).join('')}
    </div>`).join('');
  kanban.querySelectorAll('.yt-card').forEach(card=>{
    card.addEventListener('click',()=>{
      const col=yd.columns.find(c=>c.id===card.dataset.ytCol);
      const c=col.cards[parseInt(card.dataset.ytIdx)];
      openModal(c.title,`
        <div class="modal-row"><span class="modal-label">Type</span><span class="modal-value"><span class="yt-card-tag" style="background:${c.tagBg};color:${c.tagColor};font-size:.65rem;padding:2px 8px">${c.tag}</span></span></div>
        <div class="modal-row"><span class="modal-label">Author</span><span class="modal-value">${c.author}</span></div>
        <div class="modal-row"><span class="modal-label">Date</span><span class="modal-value">${c.date}</span></div>
        <div class="modal-row"><span class="modal-label">Brief</span><span class="modal-value">${c.desc}</span></div>
        <div class="modal-row"><span class="modal-label">Document</span><span class="modal-file">${c.docPath}</span></div>
        ${c.views?`<div class="modal-row"><span class="modal-label">Views</span><span class="modal-value">${c.views} views, ${c.likes} likes</span></div>`:''}`);
    });
  });
}

// ═══════════════════════════════════
// TAB 5 — TEAM OPERATIONS
// ═══════════════════════════════════

function renderTeam(){
  const el=document.getElementById('team-content');
  const tm=teamMembers;
  const totalCost=tm.reduce((s,m)=>{const n=parseFloat(m.rate.replace(/[^0-9.]/g,''));return s+(isNaN(n)?0:n)},0);
  const avgActivity=Math.round(tm.reduce((s,m)=>s+m.activity,0)/tm.length);
  const totalTasks=tm.reduce((s,m)=>s+m.tasks,0);
  const avgCapacity=Math.round(tm.reduce((s,m)=>s+m.capacity,0)/tm.length);
  const avgHours=(tm.reduce((s,m)=>s+m.avgHours,0)/tm.length).toFixed(1);

  // Summary cards
  const summaryHTML=`
    <div class="team-summary">
      <div class="team-summary-card">
        <div class="summary-label">Team Cost</div>
        <div class="summary-value" style="color:var(--accent);font-family:'JetBrains Mono',monospace">$${totalCost.toLocaleString()}/mo</div>
      </div>
      <div class="team-summary-card">
        <div class="summary-label">Avg Activity</div>
        <div class="summary-value" style="color:${avgActivity>=85?'var(--green)':avgActivity>=70?'var(--amber)':'var(--red)'};font-family:'JetBrains Mono',monospace">${avgActivity}%</div>
      </div>
      <div class="team-summary-card">
        <div class="summary-label">Active Tasks</div>
        <div class="summary-value" style="color:var(--blue);font-family:'JetBrains Mono',monospace">${totalTasks}</div>
      </div>
      <div class="team-summary-card">
        <div class="summary-label">Avg Capacity</div>
        <div class="summary-value" style="color:${avgCapacity>=80?'var(--green)':avgCapacity>=60?'var(--amber)':'var(--red)'};font-family:'JetBrains Mono',monospace">${avgCapacity}%</div>
      </div>
      <div class="team-summary-card">
        <div class="summary-label">Avg Daily Hours</div>
        <div class="summary-value" style="color:var(--purple);font-family:'JetBrains Mono',monospace">${avgHours}h</div>
      </div>
    </div>`;

  // Team member cards
  const cardsHTML=tm.map(m=>{
    const actColor=m.activity>=85?'var(--green)':m.activity>=70?'var(--amber)':'var(--red)';
    const capColor=m.capacity>=80?'var(--green)':m.capacity>=60?'var(--amber)':'var(--red)';
    const capWidth=Math.min(m.capacity,100);
    return `
    <div class="team-card">
      <div class="team-card-top">
        <div class="team-card-avatar" style="background:${m.color}">${m.initials}</div>
        <div>
          <div style="font-weight:700;font-size:.8rem">${m.name}</div>
          <div style="font-size:.6rem;color:var(--text-secondary)">${m.role}</div>
        </div>
        <div style="margin-left:auto;text-align:right">
          <div style="font-family:'JetBrains Mono',monospace;font-size:.72rem;font-weight:600;color:var(--text)">${m.rate}</div>
          <div style="font-size:.5rem;color:var(--text-muted)">${m.channel}</div>
        </div>
      </div>

      <div class="team-card-stats">
        <div class="team-stat-item">
          <span class="team-stat-label">Activity</span>
          <span class="team-stat-value" style="color:${actColor}">${m.activity}%</span>
        </div>
        <div class="team-stat-item">
          <span class="team-stat-label">Daily Avg</span>
          <span class="team-stat-value">${m.avgHours}h</span>
        </div>
        <div class="team-stat-item">
          <span class="team-stat-label">Tasks</span>
          <span class="team-stat-value" style="color:var(--blue)">${m.tasks}</span>
        </div>
      </div>

      <div class="team-card-capacity">
        <div style="display:flex;justify-content:space-between;margin-bottom:4px">
          <span style="font-size:.55rem;color:var(--text-muted)">Capacity</span>
          <span style="font-size:.55rem;font-weight:600;color:${capColor}">${m.capacity}%</span>
        </div>
        <div style="height:6px;background:var(--bg-hover);border-radius:3px;overflow:hidden">
          <div style="height:100%;width:${capWidth}%;background:${capColor};border-radius:3px;transition:width .6s ease"></div>
        </div>
      </div>

      <div style="display:flex;flex-wrap:wrap;gap:4px;margin-top:.5rem">
        ${m.clients.map(c=>`<span style="font-size:.48rem;padding:2px 6px;background:var(--bg-sidebar);border:1px solid var(--border-light);border-radius:10px;color:var(--text-secondary)">${c}</span>`).join('')}
      </div>
    </div>`;
  }).join('');

  el.innerHTML=`
    <div style="padding:1.5rem">
      <div style="display:flex;align-items:center;gap:.5rem;margin-bottom:1rem">
        <span style="font-size:1.2rem">👥</span>
        <h2 style="font-size:1rem;font-weight:700;letter-spacing:-.02em">Team Operations</h2>
        <span style="font-size:.55rem;color:var(--text-muted);margin-left:auto">Hubstaff + ClickUp · ${tm.length} members</span>
      </div>
      ${summaryHTML}
      <div class="team-grid">
        ${cardsHTML}
      </div>
    </div>`;
}

// ═══════════════════════════════════
// TAB SWITCHING + CLOCK + INIT
// ═══════════════════════════════════

function switchTab(tabId){
  document.querySelectorAll('.tab-btn').forEach(t=>t.classList.remove('active'));
  document.querySelectorAll('.tab-content').forEach(c=>c.classList.remove('active'));
  document.querySelector(`.tab-btn[data-tab="${tabId}"]`).classList.add('active');
  document.getElementById('tab-'+tabId).classList.add('active');
}

function updateClock(){
  const now=new Date(new Date().toLocaleString('en-US',{timeZone:'Asia/Bangkok'}));
  document.getElementById('clock').textContent=[now.getHours(),now.getMinutes(),now.getSeconds()].map(n=>String(n).padStart(2,'0')).join(':');
  const days=['SUN','MON','TUE','WED','THU','FRI','SAT'];
  const months=['JAN','FEB','MAR','APR','MAY','JUN','JUL','AUG','SEP','OCT','NOV','DEC'];
  document.getElementById('clock-date').textContent=`${days[now.getDay()]}, ${months[now.getMonth()]} ${now.getDate()}`;
}

// ═══════════════════════════════════
// LIVE DATA LOADING
// ═══════════════════════════════════

const STAGE_COLORS={
  'joey podcast':'var(--gray)','jordan podcast':'var(--gray)','youtube lead':'var(--blue)',
  'warm lead':'var(--amber)','strategy call':'var(--accent)','growth plan':'var(--purple)',
  'deal closed':'var(--green)','do not pursue':'var(--red)'
};
const STAGE_ORDER=['joey podcast','jordan podcast','youtube lead','warm lead','strategy call','growth plan','deal closed','do not pursue'];

function initials(name){return(name||'').split(/\s+/).map(w=>w[0]).join('').toUpperCase().slice(0,2)}
function timeAgo(ts){
  if(!ts)return'—';
  const d=new Date(ts),now=new Date(),diff=Math.floor((now-d)/60000);
  if(diff<1)return'Just now';
  if(diff<60)return diff+'m ago';
  if(diff<1440)return Math.floor(diff/60)+'h ago';
  return Math.floor(diff/1440)+'d ago';
}
function titleCase(s){return(s||'').replace(/\b\w/g,c=>c.toUpperCase())}
function sourceFromTags(tags){
  if(!tags||!tags.length)return'Pipeline';
  const t=tags.map(x=>(typeof x==='string'?x:x.name||'').toLowerCase());
  if(t.includes('youtube-lead'))return'YouTube';
  if(t.includes('joey-podcast'))return'Joey Podcast';
  if(t.includes('jordan-podcast'))return'Jordan Podcast';
  if(t.includes('high-priority'))return'Priority';
  return titleCase(t[0]||'Pipeline');
}

async function loadLiveData(){
  try{
    const res=await fetch('./mission-control-data.json?t='+Date.now());
    if(!res.ok)throw new Error(res.status);
    const data=await res.json();

    // — Show sync badge —
    const badge=document.getElementById('sync-badge');
    const syncTime=document.getElementById('sync-time');
    if(badge&&data._generated){
      badge.style.display='inline';
      syncTime.textContent=timeAgo(data._generated);
    }

    // — DD Pipeline stages —
    if(data.dd_pipeline&&data.dd_pipeline.stages){
      const st=data.dd_pipeline.stages;
      ddPipeline.stages=STAGE_ORDER.filter(s=>st[s]>0||['warm lead','strategy call','growth plan','deal closed'].includes(s))
        .map(s=>({name:titleCase(s),count:st[s]||0,color:STAGE_COLORS[s]||'var(--gray)'}));
    }

    // — DD Pipeline leads from ClickUp tasks —
    if(data.dd_pipeline&&data.dd_pipeline.leads&&data.dd_pipeline.leads.length){
      ddPipeline.leads=data.dd_pipeline.leads.slice(0,12).map(l=>{
        const status=(l.status&&l.status.status)||l.status_name||'';
        const created=l.date_created?new Date(parseInt(l.date_created)):new Date();
        const days=Math.floor((Date.now()-created.getTime())/86400000);
        return{
          name:l.name||'Unknown',
          initials:initials(l.name),
          company:(l.description||'').split('\n')[0]?.replace(/^(Company|company):?\s*/i,'').slice(0,40)||'—',
          source:sourceFromTags(l.tags),
          stage:titleCase(status),
          stageColor:STAGE_COLORS[status]||'var(--gray)',
          value:'$15K',
          days:days
        };
      });
    }

    // — DD Pipeline metrics (computed from live data) —
    if(data.dd_pipeline){
      const total=data.dd_pipeline.total||ddPipeline.leads.length;
      const closed=(data.dd_pipeline.stages&&data.dd_pipeline.stages['deal closed'])||0;
      ddPipeline.metrics={
        pipelineValue:'$'+(total*15)+'K',
        avgDeal:'$15K',
        cycle:'21 days',
        conversion:total>0?Math.round((closed/total)*100)+'%':'—',
        ytLeadsThisMonth:data.youtube_leads?data.youtube_leads.total:ddPipeline.metrics.ytLeadsThisMonth,
        replyRate:data.instantly&&data.instantly.overview?((data.instantly.overview.replies_pct||0).toFixed(1)+'%'):ddPipeline.metrics.replyRate
      };
    }

    // — DD Pipeline sources (from live data) —
    if(data.dd_pipeline&&data.dd_pipeline.leads){
      const tags={};
      data.dd_pipeline.leads.forEach(l=>{
        const src=sourceFromTags(l.tags);
        tags[src]=(tags[src]||0)+1;
      });
      const icons={'YouTube':'▶️','Joey Podcast':'🎙️','Jordan Podcast':'🎙️','Priority':'🔥','Pipeline':'📧','Other':'📋'};
      ddPipeline.sources=Object.entries(tags).sort((a,b)=>b[1]-a[1]).slice(0,5)
        .map(([name,count])=>({name,count,icon:icons[name]||'📋',trend:'From ClickUp'}));
    }

    // — Client data updates —
    if(data.clients){
      const nameMap={'Jamie':'jamie','Phellos':'phellos','ODF':'odf','Ocon':'ocon','Ripple':'ripple'};
      for(const[name,d]of Object.entries(data.clients)){
        const id=nameMap[name];
        if(!id)continue;
        const c=clientData.find(x=>x.id===id);
        if(!c)continue;
        if(d.total_leads!=null)c.podcasts.total=d.total_leads;
        if(d.active_leads!=null)c.podcasts.recorded=d.active_leads;
      }
    }

    // — Instantly health update —
    if(data.instantly){
      const sys=systems.find(s=>s.name==='Instantly');
      if(sys){
        sys.detail=`${data.instantly.accounts_healthy||0}/${data.instantly.accounts_total||0} accounts healthy`;
        sys.status=data.instantly.accounts_healthy>0?'ok':'warn';
      }
    }

    // — North Star KPI actuals from live data —
    if(data.north_star){
      const n=data.north_star;
      if(n.kpis){
        const kpiMap={'emails_sent':0,'linkedin':1,'youtube_videos':2,'podcast_invites':3,'sales_calls':4,'new_clients':5};
        for(const[key,val]of Object.entries(n.kpis)){if(kpiMap[key]!=null&&northStar.kpis[kpiMap[key]])northStar.kpis[kpiMap[key]].actual=val;}
      }
      if(n.funnel)northStar.funnel=n.funnel;
      if(n.weekLabel)northStar.weekLabel=n.weekLabel;
      if(n.weekDay)northStar.weekDay=n.weekDay;
      if(n.currentMRR)northStar.currentMRR=n.currentMRR;
      if(n.sources)northStar.sources=n.sources;
    }

    // — Calendar: add calls today to system health —
    if(data.calendar&&data.calendar.calls_today>0){
      const existing=systems.find(s=>s.name==='Calls Today');
      if(!existing){
        systems.push({name:'Calls Today',status:'ok',detail:`${data.calendar.calls_today} call${data.calendar.calls_today>1?'s':''} scheduled`});
      }
    }

    // — Activity feed from live data —
    if(data.activity&&data.activity.length){
      const liveActivity=data.activity.map(a=>{
        let agentId='cooper',action='logged:';
        if(a.type==='lead_moved'){agentId='dash';action='auto-moved';}
        if(a.type==='call_completed'){agentId='scribe';action='processed';}
        return{
          agent:agentId,
          action:action,
          task:a.text||'',
          time:timeAgo(a.timestamp),
          hasResult:!!a.detail,
          detail:a.detail||''
        };
      });
      // Prepend live activity, keep some hardcoded as fallback
      activityLog.splice(0,activityLog.length,...liveActivity,...activityLog.slice(0,3));
    }

    // — Fathom: add recent calls to activity —
    if(data.fathom&&data.fathom.recent_calls){
      data.fathom.recent_calls.slice(0,3).forEach(call=>{
        activityLog.push({
          agent:'scribe',action:'recorded',
          task:call.title||'Call',time:timeAgo(call.date),
          hasResult:!!call.share_url,
          detail:(call.summary||'No summary')+'\n'+(call.share_url?'📎 '+call.share_url:'')
        });
      });
    }

    // — Re-render all tabs with live data —
    renderHome();
    renderBuildProgress();
    renderHealth();
    renderActivity();
    renderDDPipeline();
    renderClientPipeline();

    console.log('[Mission Control] Live data loaded —',data._generated);
  }catch(e){
    console.log('[Mission Control] No live data available, using defaults.',e.message);
  }
}

// ═══════════════════════════════════
// SHOWCASE MODE — fake data for filming
// ═══════════════════════════════════
let showcaseMode=false;

const demoClients=[
  {id:'d1',shortName:'NovaTech',initials:'NT',services:'Podcast + Outbound',color:'#e05d2a',guests:[...Array(42)],contract:{days:180,start:'2025-12-01'},calls:{target:40,booked:18},pipeline:{target:300000,currency:'$'},clickup:{spaceId:'0',podcastListId:'0'}},
  {id:'d2',shortName:'Apex Growth',initials:'AG',services:'Podcast Lead Gen',color:'#3b7dd8',guests:[...Array(35)],contract:{days:180,start:'2025-11-15'},calls:{target:40,booked:22},pipeline:{target:300000,currency:'$'},clickup:{spaceId:'0',podcastListId:'0'}},
  {id:'d3',shortName:'Meridian Labs',initials:'ML',services:'Podcast + Dream 200',color:'#7c5cbf',guests:[...Array(51)],contract:{days:90,start:'2025-12-10'},calls:{target:20,booked:14},pipeline:{target:150000,currency:'$'},clickup:{spaceId:'0',podcastListId:'0'}},
  {id:'d4',shortName:'Vantage AI',initials:'VA',services:'Full Stack Outbound',color:'#2d9f4e',guests:[...Array(28)],contract:{days:180,start:'2025-10-20'},calls:{target:40,booked:31},pipeline:{target:300000,currency:'\u00A3'},clickup:{spaceId:'0',podcastListId:'0'}},
  {id:'d5',shortName:'Ironclad SaaS',initials:'IS',services:'Podcast Lead Gen',color:'#c78b1a',guests:[...Array(38)],contract:{days:90,start:'2025-11-01'},calls:{target:20,booked:16},pipeline:{target:150000,currency:'$'},clickup:{spaceId:'0',podcastListId:'0'}},
  {id:'d6',shortName:'BrightPath',initials:'BP',services:'Partner Engine',color:'#d14343',guests:[...Array(44)],contract:{days:180,start:'2026-01-05'},calls:{target:40,booked:8},pipeline:{target:300000,currency:'$'},clickup:{spaceId:'0',podcastListId:'0'}},
  {id:'d7',shortName:'CloudNine',initials:'CN',services:'Podcast + Outbound',color:'#5f55ee',guests:[...Array(30)],contract:{days:180,start:'2025-12-15'},calls:{target:40,booked:26},pipeline:{target:300000,currency:'$'},clickup:{spaceId:'0',podcastListId:'0'}},
  {id:'d8',shortName:'PeakView',initials:'PV',services:'Podcast Lead Gen',color:'#0097a7',guests:[...Array(22)],contract:{days:90,start:'2026-01-10'},calls:{target:20,booked:5},pipeline:{target:150000,currency:'\u20AC'},clickup:{spaceId:'0',podcastListId:'0'}},
  {id:'d9',shortName:'Atlas Digital',initials:'AD',services:'Full Stack Outbound',color:'#8d6e63',guests:[...Array(47)],contract:{days:180,start:'2025-10-01'},calls:{target:40,booked:35},pipeline:{target:300000,currency:'$'},clickup:{spaceId:'0',podcastListId:'0'}},
  {id:'d10',shortName:'Summit Group',initials:'SG',services:'Podcast + Dream 200',color:'#546e7a',guests:[...Array(33)],contract:{days:180,start:'2025-11-20'},calls:{target:40,booked:19},pipeline:{target:300000,currency:'\u00A3'},clickup:{spaceId:'0',podcastListId:'0'}},
  {id:'d11',shortName:'Zenith Ops',initials:'ZO',services:'Partner Engine',color:'#ab47bc',guests:[...Array(26)],contract:{days:90,start:'2026-01-15'},calls:{target:20,booked:7},pipeline:{target:150000,currency:'$'},clickup:{spaceId:'0',podcastListId:'0'}},
  {id:'d12',shortName:'Forge Works',initials:'FW',services:'Podcast Lead Gen',color:'#ef6c00',guests:[...Array(39)],contract:{days:180,start:'2025-09-15'},calls:{target:40,booked:38},pipeline:{target:300000,currency:'$'},clickup:{spaceId:'0',podcastListId:'0'}},
  {id:'d13',shortName:'Catalyst HQ',initials:'CH',services:'Full Stack Outbound',color:'#00897b',guests:[...Array(31)],contract:{days:180,start:'2025-12-20'},calls:{target:40,booked:12},pipeline:{target:300000,currency:'$'},clickup:{spaceId:'0',podcastListId:'0'}},
  {id:'d14',shortName:'Horizon B2B',initials:'HB',services:'Podcast + Outbound',color:'#5c6bc0',guests:[...Array(45)],contract:{days:90,start:'2025-11-05'},calls:{target:20,booked:19},pipeline:{target:150000,currency:'$'},clickup:{spaceId:'0',podcastListId:'0'}},
  {id:'d15',shortName:'Vector Scale',initials:'VS',services:'Podcast Lead Gen',color:'#43a047',guests:[...Array(36)],contract:{days:180,start:'2026-01-01'},calls:{target:40,booked:4},pipeline:{target:300000,currency:'$'},clickup:{spaceId:'0',podcastListId:'0'}},
];
// Add missing fields for Clients tab
const demoContacts=['Sarah Chen','Marcus Webb','Elena Zhao','David Park','Olivia Grant','Ryan Torres','Natasha Kim','James Bradford','Priya Sharma','Aiden Clarke','Carlos Mendez','Lena Frost','Thomas Reeves','Anna Okafor','Viktor Dunn'];
const demoBiz=['AI-powered sales platform','Enterprise analytics SaaS','Developer tooling','Cloud infrastructure','RevOps automation','Customer success platform','Data pipeline orchestration','Predictive analytics','API marketplace','MarTech platform','Supply chain AI','Cybersecurity SaaS','HR tech platform','EdTech for enterprise','Growth marketing platform'];
const demoStageNames=['post podcast','upcoming podcasts','to reschedule','revisit later','discovery','upcoming pre-calls'];
demoClients.forEach((c,i)=>{
  c.name=c.shortName+' \u2014 '+demoBiz[i];
  c.contact=demoContacts[i]+' \u2014 '+c.shortName.toLowerCase().replace(/\s/g,'')+'@company.com';
  c.business=demoBiz[i];
  c.alerts=i===5?['Contract expires in 12 days — schedule renewal']:[];
  c.slack={channel:'#client-'+c.shortName.toLowerCase().replace(/\s/g,'-'),channelId:'C00DEMO'+i,team:'#team-'+c.shortName.toLowerCase().replace(/\s/g,'-'),teamId:'C00TEAM'+i};
  const guestCount=c.guests.length;
  const ps={};demoStageNames.forEach((s,si)=>{ps[s]=si<3?Math.floor(guestCount*(0.3-si*0.08)):Math.floor(guestCount*0.1)});
  c.podcastStages=ps;
  c.guests=Array.from({length:guestCount},(_,gi)=>{
    const fn=['Alex','Morgan','Taylor','Jordan','Casey','Riley','Avery','Quinn','Drew','Blake','Sam','Pat','Chris','Jamie','Robin'][gi%15];
    const ln=['Smith','Chen','Park','Davis','Wilson','Anderson','Lee','Brown','Clark','Lewis','Walker','Young','King','Hill','Scott'][gi%15];
    const co=['Acme','Vertex','Nexus','Pinnacle','Orbit','Zenith','Prism','Vector','Helix','Atlas','Onyx','Quartz','Flux','Nova','Forge'][gi%15];
    return{name:fn+' '+ln+' — '+co,status:demoStageNames[gi%demoStageNames.length],url:'#'};
  });
});
const demoCampaigns={};
demoClients.forEach(c=>{
  const cb=c.calls.booked||0;const tgt=c.calls.target||20;
  demoCampaigns[c.id]={outreachType:c.services.includes('Outbound')?'podcast+outbound':'podcast',instantly:null,heyreach:null,callsBooked:cb,pipelineGenerated:Math.floor(c.pipeline.target*(cb/tgt)),recentCalls:[]};
});
const demoLeads=[
  {name:'Sarah Mitchell',initials:'SM',company:'ScaleForce AI',source:'YouTube',stage:'Strategy Call',stageColor:'#04a9f4',value:'$15K',days:0,url:'#'},
  {name:'Marcus Chen',initials:'MC',company:'DataBridge Inc',source:'YouTube',stage:'Strategy Call',stageColor:'#04a9f4',value:'$15K',days:0,url:'#'},
  {name:'Elena Voronova',initials:'EV',company:'NeuralPath',source:'Jordan Podcast',stage:'Growth Plan',stageColor:'#a875ff',value:'$15K',days:0,url:'#'},
  {name:'James Bradford',initials:'JB',company:'Apex Logistics',source:'Other',stage:'Growth Plan',stageColor:'#a875ff',value:'$12K',days:0,url:'#'},
  {name:'Priya Sharma',initials:'PS',company:'GrowthLab AI',source:'YouTube',stage:'Growth Plan',stageColor:'#a875ff',value:'$15K',days:0,url:'#',tags:['high-priority']},
  {name:'Ryan O\'Sullivan',initials:'RO',company:'CloudNative.io',source:'Joey Podcast',stage:'Warm Lead',stageColor:'#f9d900',value:'$15K',days:0,url:'#',tags:['high-priority']},
  {name:'Aiden Park',initials:'AP',company:'Finova Systems',source:'YouTube',stage:'Warm Lead',stageColor:'#f9d900',value:'$12K',days:0,url:'#'},
  {name:'Natasha Reeves',initials:'NR',company:'SyncWave',source:'Jordan Podcast',stage:'YouTube Lead',stageColor:'#ff7800',value:'$15K',days:0,url:'#'},
  {name:'Carlos Mendez',initials:'CM',company:'Precision Labs',source:'Other',stage:'Warm Lead',stageColor:'#f9d900',value:'$15K',days:0,url:'#'},
  {name:'David Kim',initials:'DK',company:'TrueMetrics',source:'YouTube',stage:'YouTube Lead',stageColor:'#ff7800',value:'\u2014',days:0,url:'#',tags:['high-priority']},
];
const demoPipeline={
  stages:[{name:'Joey Podcast',count:42,color:'#87909e'},{name:'Jordan Podcast',count:28,color:'#5f55ee'},{name:'YouTube Lead',count:15,color:'#ff7800'},{name:'Warm Lead',count:51,color:'#f9d900'},{name:'Strategy Call',count:6,color:'#04a9f4'},{name:'Growth Plan',count:8,color:'#a875ff'}],
  leads:demoLeads,
  sources:[
    {name:'Joey Podcast',count:42,icon:'\uD83C\uDFA4',trend:'12 high-priority'},
    {name:'YouTube TypeForm',count:15,icon:'\u25B6\uFE0F',trend:'5 high-priority'},
    {name:'Jordan Podcast',count:28,icon:'\uD83C\uDFA4',trend:'8 high-priority'},
    {name:'Other / Warm',count:51,icon:'\uD83D\uDD25',trend:'Fastest-growing source'},
  ],
  metrics:{avgDeal:'$12-15K',cycle:'\u2014',conversion:'\u2014',pipelineValue:'$2.25M',ytLeadsThisMonth:15,replyRate:'\u2014'},
  clickupUrl:'#'
};
const demoActivity=[
  {agent:'cooper',action:'completed',task:'NovaTech onboarding review',time:'12 min ago',hasResult:true,detail:'Escalated NovaTech onboarding — 3 action items assigned, follow-up scheduled for Thursday.'},
  {agent:'radar',action:'completed',task:'AI SDR market trend — 340% YoY',time:'28 min ago',hasResult:true,detail:'Surfaced trending insight: AI SDR adoption up 340% YoY. 2 video ideas, 3 positioning angles generated.'},
  {agent:'keenan',action:'completed',task:'Atlas Digital discovery — 94/120',time:'1h ago',hasResult:true,detail:'Sales call scored 94/120 (Strong). Top gap: pricing objection handling. Full audit in Google Docs.'},
  {agent:'forge',action:'completed',task:'Scout health check passed',time:'2h ago',hasResult:true,detail:'Fleet audit complete. All 13 agents scored A or B. Scout SOUL file updated with new enrichment rules.'},
  {agent:'scout',action:'completed',task:'Marcus Chen — DataBridge Inc',time:'3h ago',hasResult:true,detail:'Lead enriched: Marcus Chen, CTO at DataBridge Inc. $4.2M ARR, Series A, 38 employees. High fit score.'},
  {agent:'dash',action:'completed',task:'YouTube submission — Finova Systems',time:'4h ago',hasResult:true,detail:'YouTube lead processed in 47 seconds. Qualified — auto-booked discovery call for Friday.'},
  {agent:'sentinel',action:'completed',task:'Client health scan — all green',time:'5h ago',hasResult:true,detail:'All 15 clients scored green. 2 contracts approaching renewal (BrightPath, PeakView).'},
  {agent:'echo',action:'completed',task:'LinkedIn carousel — AI Agents 101',time:'5h ago',hasResult:false,detail:'Generated 8-slide LinkedIn carousel from Radar intel. Queued for Jordan review.'},
  {agent:'pulse',action:'completed',task:'Morning briefing delivered',time:'6h ago',hasResult:true,detail:'Compiled 8 agent reports into single morning brief. 3 priority items flagged.'},
  {agent:'maverick',action:'completed',task:'Instantly campaign optimization',time:'7h ago',hasResult:true,detail:'A/B test results: Subject line B +23% open rate. Auto-applied to 4 client campaigns.'},
  {agent:'scribe',action:'completed',task:'Meridian Labs discovery call',time:'8h ago',hasResult:true,detail:'Call processed: 3 action items, 2 follow-ups. Summary posted to #client-meridian-labs.'},
  {agent:'harbor',action:'completed',task:'Vector Scale onboarding package',time:'9h ago',hasResult:true,detail:'Onboarding complete: ClickUp workspace, ICP research, podcast questions, Dream 200 list (47 prospects).'},
  {agent:'sherlock',action:'completed',task:'Competitive intel — Apex Growth',time:'10h ago',hasResult:true,detail:'Deep research: Apex Growth competitor analysis. 3 differentiation angles, pricing benchmarks compiled.'},
];
const demoKanban=[
  {id:'inbox',title:'Inbox',color:'#9b9990',cards:[
    {id:'dk1',agent:'maverick',title:'Campaign A/B test — BrightPath subject lines',desc:'Testing 3 subject line variants across BrightPath Instantly campaigns.',time:'Pending',details:'A/B test across 3 variants. Current winner: "Quick question about [company] growth" at 34% open rate.'},
  ]},
  {id:'assigned',title:'Assigned',color:'#3b7dd8',cards:[
    {id:'dk2',agent:'harbor',title:'Horizon B2B onboarding package',desc:'Build full onboarding: ClickUp workspace, ICP, podcast questions, Dream 200.',time:'Next up',details:'New client signed yesterday. Harbor building full onboarding package.'},
    {id:'dk3',agent:'sherlock',title:'Deep dive — Finova Systems lead',desc:'Full company intel, decision-maker mapping, competitive landscape.',time:'Next up',details:'High-priority YouTube lead. Sherlock running full research before discovery call.'},
  ]},
  {id:'in-progress',title:'In Progress',color:'#e05d2a',cards:[
    {id:'dk4',agent:'cooper',title:'Daily orchestration — active',desc:'Running all 13 agents on schedule. Zero failures today.',time:'Daily 5:00 AM',tags:[{label:'LIVE',bg:'#ecf8ef',color:'#2d9f4e'}],details:'Cooper orchestrating full fleet. 47 tasks completed today across all agents.'},
    {id:'dk5',agent:'keenan',title:'Apex Growth discovery audit',desc:'Scoring call against 5 frameworks. Current: 94/120.',time:'On-demand',tags:[{label:'LIVE',bg:'#ecf8ef',color:'#2d9f4e'}],details:'Full 5-framework audit in progress. Preliminary score: 94/120 (Strong).'},
    {id:'dk6',agent:'radar',title:'Morning intel — 3 trends surfaced',desc:'AI SDR adoption, podcast-first GTM, and B2B short-form video.',time:'Ran 6:00 AM',tags:[{label:'LIVE',bg:'#ecf8ef',color:'#2d9f4e'}],details:'3 trending topics, 5 video ideas, 4 positioning angles filed.'},
    {id:'dk7',agent:'sentinel',title:'Client health monitoring — all green',desc:'Tracking 15 clients across 6 health dimensions.',time:'7:30 AM daily',tags:[{label:'LIVE',bg:'#ecf8ef',color:'#2d9f4e'}],details:'All clients green. BrightPath and PeakView flagged for contract renewal in 12 and 18 days.'},
    {id:'dk8',agent:'dash',title:'Speed-to-lead monitoring',desc:'Average response time: 47 seconds. 12 leads processed today.',time:'Every 30 min',tags:[{label:'LIVE',bg:'#ecf8ef',color:'#2d9f4e'}],details:'12 leads processed. 3 qualified, 2 needs clarification, 7 not a fit.'},
    {id:'dk9',agent:'scout',title:'Lead enrichment pipeline',desc:'18 new leads enriched today. 4 flagged high-priority.',time:'6:00 AM daily',tags:[{label:'LIVE',bg:'#ecf8ef',color:'#2d9f4e'}],details:'Connected to Clay, Apollo, Instantly. Auto-enriching all new pipeline entries.'},
  ]},
  {id:'review',title:'Review',color:'#7c5cbf',cards:[
    {id:'dk10',agent:'echo',title:'LinkedIn carousel — AI Agents 101',desc:'8-slide carousel ready for Jordan review.',time:'Today',details:'Generated from Radar intel. Topic: How AI agents replace SDR teams.'},
    {id:'dk11',agent:'forge',title:'Fleet audit report — February',desc:'All 13 agents audited. 11 A-grade, 2 B-grade.',time:'Today',details:'Monthly audit complete. Recommendations: upgrade Dash monitoring scope, add Sentinel Slack notifications.'},
  ]},
  {id:'done',title:'Done',color:'#2d9f4e',cards:[
    {id:'dk12',agent:'cooper',title:'Fleet fully deployed — 13/13 live',desc:'All agents operational with cron schedules.',time:'Completed',tags:[{label:'LIVE',bg:'#ecf8ef',color:'#2d9f4e'}],details:'Full fleet deployment complete. Zero downtime, all health checks passing.'},
    {id:'dk13',agent:'scribe',title:'Meridian Labs call processed',desc:'3 action items, 2 follow-ups posted to Slack.',time:'Completed',details:'Call summary, action items, and full transcript brief generated.'},
    {id:'dk14',agent:'harbor',title:'Vector Scale onboarding complete',desc:'ClickUp workspace, ICP, Dream 200 list — all delivered.',time:'Completed',details:'47 prospects in Dream 200 list. Podcast questions customized for fintech vertical.'},
    {id:'dk15',agent:'maverick',title:'Instantly campaign optimization — 4 clients',desc:'Subject line B wins: +23% open rate. Auto-applied.',time:'Completed',details:'A/B test resolved. Winning variant applied to NovaTech, Apex Growth, Ironclad SaaS, Atlas Digital.'},
  ]},
];
const demoSystems=[
  {name:'SDR Inbox',status:'ok',detail:'Checking replies every 5 min — 47 processed today'},
  {name:'YouTube n8n',status:'ok',detail:'36-node workflow active — 12 leads today'},
  {name:'Mac Mini',status:'ok',detail:'All 13 agent crons running — zero failures'},
  {name:'ClickUp API',status:'ok',detail:'Connected — 340 API calls today'},
  {name:'Instantly',status:'ok',detail:'15 client accounts — 12,400 emails sent today'},
  {name:'HeyReach',status:'ok',detail:'LinkedIn active — 890 messages sent today'},
  {name:'Clay',status:'ok',detail:'Enrichment pipeline — 18 leads enriched'},
  {name:'Google Workspace',status:'ok',detail:'Drive, Docs, Calendar connected'},
];
const demoNorthStar={
  currentMRR:52000,goalMRR:100000,avgClientMRR:4000,currentClients:15,closeRate:0.20,monthsToGoal:3,
  weekLabel:'Feb 3\u20139',weekDay:3,workDays:5,
  funnel:{sent:1180,replies:58,interested:12,calls:4,closed:1},
  sources:{youtube:7,coldEmail:4,podcast:3,referral:1},
  kpis:[
    {label:'Emails Sent',num:1250,actual:1180,unit:'/week',result:'2% reply \u00B7 ~10 meetings/mo',color:'var(--blue)'},
    {label:'LinkedIn',num:300,actual:275,unit:'/week',result:'15% accept \u00B7 ~6 meetings/mo',color:'var(--purple)'},
    {label:'YouTube Videos',num:7,actual:5,unit:'/week',result:'~3 leads/video \u00B7 compounds',color:'var(--red)'},
    {label:'Podcast Invites',num:30,actual:22,unit:'/week',result:'25% book \u00B7 ~2 meetings/mo',color:'var(--amber)'},
    {label:'Sales Calls',num:5,actual:4,unit:'/week',result:'20% close \u00B7 ~4 clients/mo',color:'var(--green)'},
    {label:'New Clients',num:1,actual:1,unit:'/week',result:'+$4K MRR each \u00B7 $100K in ~3mo',color:'var(--accent)'},
  ]
};

function toggleNsDayMode(on){
  const sc=getShowcaseData();const ns=sc&&sc.northStar?sc.northStar:northStar;
  const wd=ns.weekDay||1;const total=ns.workDays||5;
  document.querySelectorAll('.ns-kpi').forEach((card,i)=>{
    const k=ns.kpis[i];if(!k||k.actual==null)return;
    const numEl=card.querySelector('.ns-kpi-num');const ofEl=card.querySelector('.ns-kpi-of');
    if(on){
      const daily=Math.ceil(k.num/total);const expected=daily*wd;
      const todayActual=Math.round(k.actual/Math.max(wd,1));
      numEl.textContent=todayActual;
      if(ofEl)ofEl.textContent='/ '+daily+' /day';
      const pct=Math.min(Math.round(k.actual/expected*100),100);
      const pc=pct>=80?'var(--green)':pct>=50?'var(--amber)':'var(--red)';
      numEl.style.color=pc;
      const bar=card.querySelector('.ns-kpi-bar-fill');
      if(bar){bar.style.width=pct+'%';bar.style.background=pc;}
    }else{
      numEl.textContent=k.actual;
      if(ofEl)ofEl.textContent='/ '+k.num+' '+k.unit;
      const pct=Math.min(Math.round(k.actual/k.num*100),100);
      const pc=pct>=80?'var(--green)':pct>=50?'var(--amber)':'var(--red)';
      numEl.style.color=pc;
      const bar=card.querySelector('.ns-kpi-bar-fill');
      if(bar){bar.style.width=pct+'%';bar.style.background=pc;}
    }
  });
}
function toggleShowcase(){
  showcaseMode=!showcaseMode;
  document.getElementById('sc-wrap').classList.toggle('active',showcaseMode);
  // Swap client grid columns for 15 clients
  const cg=document.querySelector('.hd-clients');
  if(cg)cg.style.gridTemplateColumns=showcaseMode?'repeat(5,1fr)':'';
  // Re-render ALL tabs
  renderHome();
  renderAgentList();
  renderBuildProgress();
  renderKanban();
  renderHealth();
  renderAgentChips();
  renderActivity();
  renderDDPipeline();
  renderClientPipeline();
  renderYouTube();
  renderTeam();
}

function getShowcaseData(){
  if(!showcaseMode) return null;
  return {
    clients:demoClients,
    campaigns:demoCampaigns,
    pipeline:demoPipeline,
    activity:demoActivity,
    agents:agents.map(a=>({...a,buildStatus:'live'})),
    systems:demoSystems,
    kanban:demoKanban,
    northStar:demoNorthStar,
  };
}

function init(){
  // Tab 0
  renderHome();
  // Tab 1
  renderAgentList();
  renderBuildProgress();
  renderKanban();
  renderHealth();
  renderAgentChips();
  renderActivity();
  // Tab 2
  renderDDPipeline();
  // Tab 3
  renderClientPipeline();
  // Tab 4
  renderYouTube();
  // Tab 5
  renderTeam();
  // Clock
  updateClock();
  setInterval(updateClock,1000);
  // Tab switching
  document.querySelectorAll('.tab-btn').forEach(btn=>{
    btn.addEventListener('click',()=>switchTab(btn.dataset.tab));
  });
  // Feed tabs
  document.querySelectorAll('.feed-tab').forEach(tab=>{
    tab.addEventListener('click',()=>{
      document.querySelectorAll('.feed-tab').forEach(t=>t.classList.remove('active'));
      tab.classList.add('active');
      activeTab=tab.dataset.filter;
      renderActivity();
    });
  });
  // Load live data, then refresh every 5 min
  loadLiveData();
  setInterval(loadLiveData,300000);
}

// Auth-gated init — only render after password check
function bootApp(){
  document.getElementById('auth-gate').style.display='none';
  const wrap=document.getElementById('app-wrap');
  wrap.style.display='';wrap.style.contents='';
  init();
}
async function hashPw(pw){
  const buf=await crypto.subtle.digest('SHA-256',new TextEncoder().encode(pw));
  return Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,'0')).join('');
}
const AUTH_HASH='e5b13b22d9dbfbc217279a6411435bf5239fcd435357abc23d9b1861381a19fe';
const AUTH_KEY='mc_auth_token';
const AUTH_TTL=7*24*60*60*1000;
async function checkAuth(e){
  e.preventDefault();
  const pw=document.getElementById('auth-pw').value;
  const h=await hashPw(pw);
  if(h===AUTH_HASH){
    if(document.getElementById('auth-remember').checked){
      localStorage.setItem(AUTH_KEY,JSON.stringify({h:h,t:Date.now()}));
    }
    bootApp();
  }else{
    document.getElementById('auth-pw').classList.add('error');
    document.getElementById('auth-err').textContent='Incorrect password';
    setTimeout(()=>document.getElementById('auth-pw').classList.remove('error'),400);
  }
  return false;
}
document.addEventListener('DOMContentLoaded',()=>{
  try{
    const stored=JSON.parse(localStorage.getItem(AUTH_KEY)||'null');
    if(stored&&stored.h===AUTH_HASH&&(Date.now()-stored.t)<AUTH_TTL){bootApp();return;}
  }catch(e){}
  // Show gate, do not init
});
</script>
</div><!-- /app-wrap -->
</body>
</html>
